<!DOCTYPE html>
<html lang="en">
<head>
<title>Login</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<style type="text/css">

.icon-crl .fa {
	padding: 14px;
	font-size: 25px;
	width: 50px;
	height: 50px;
	text-align: center;
	text-decoration: none;
	background-color: #80bbdd;
	margin: 5px 2px;
	border-radius: 50%;
	color: #fff;
}

.btn-reg a {
	color: #fff
}

.login-container {
	margin-top: 5%;
	margin-bottom: 5%;
}

.login-form-1 {
	padding: 5%;
	background: #0076ba;
	box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 9px 26px 0
		rgba(0, 0, 0, 0.19);
	height: 600px;
}

.login-form-1 h3 {
	text-align: center;
	color: #333;
}

.login-form-2 {
	padding: 10% 5% 5%;
	box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 9px 26px 0
		rgba(0, 0, 0, 0.19);
	height: 600px;
}

.login-form-2 h3 {
	text-align: center;
	color: #fff;
}

.login-container form {
	padding: 10%;
}

.btnSubmit {
	width: 50%;
	border-radius: 1rem;
	padding: 1.5%;
	border: none;
	cursor: pointer;
}

.login-form-1 .btnSubmit {
	font-weight: 600;
	color: #fff;
	background-color: #0062cc;
}

.login-form-2 .btnSubmit {
	font-weight: 600;
	color: #0062cc;
	background-color: #fff;
}

.login-form-2 .ForgetPwd {
	color: #fff;
	font-weight: 600;
	text-decoration: none;
}

.login-form-1 .ForgetPwd {
	color: #ccc;
	font-weight: 600;
	text-decoration: none;
}

.right-text {
	font-size: 14px;
	color: #0076ba;
	vertical-align: middle;
	font-weight: 600;
	text-align: center;
	position: relative;
	top: 25%;
}

.logo img {
	margin-bottom: 20px;
	height: 90px;
}

.signin-txt {
	font-size: 36px;
	font-weight: 200;
	margin-bottom: 2rem;
	text-align: center;
	color: #fff;
	margin-top: 40px;
}

.form-control1 {
	display: block;
	width: 100%;
	height: calc(1.5em + .75rem + 2px);
	padding: .375rem .75rem;
	font-size: 1rem;
	font-weight: 400;
	line-height: 1.5;
	color: #495057;
	background-color: #fff;
	background-clip: padding-box;
	border-bottom: 1px solid #ced4da;
	border-left: none;
	border-right: none;
	border-top: none;
	border-radius: .25rem;
	transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
}

.form-control1:focus {
	outline: none;
	border-bottom: 1px solid #ced4da;
}

.input_icon i {
	position: absolute;
	bottom: 2px;
	left: 5px;
	width: 24px;
	height: 24px;
	color: #979797;
}

.btn-login {
	color: #fff;
	background-color: #ed1b24;
	border-color: #d90710;
	border-radius: 20px;
}

.btn-login:hover {
	color: #fff;
	background-color: #d80e17;
	border-color: #d90710;
	border-radius: 20px;
}

.btn-reg {
	color: #0076b9;
	background-color: #ffffff;
	border-color: #0076ba;
	border-radius: 20px;
}

.btn-reg:hover {
	color: #fff;
	background-color: rgba(0, 0, 0, 0.8);
	border-color: #0074f0;
	border-radius: 20px;
}
.btn-reg:disabled {
    opacity: .08;
    cursor: not-allowed;
}
.or {
	font-size: 18px;
	color: #fff;
	text-align: center;
}

.formValidation1 {
	font-size: 14px;
	font-weight: 100;
	color: #FFF;
	background-color: transparent;
	position: relative;
	top: -1px;
	padding: 3px 0px;
}

.signup-subtxt {
	font-size: 20px;
	margin-bottom: 20px;
	color: #FFF;
	text-align: center;
	padding: 0px 20px;
}
.loading-image {
	position: absolute;
	top: 50%;
	left: 50%;
	z-index: 10;
}

/*.loader {
	display: none;
	width: 100%;
	height: 100%;
	position: fixed;
	top: 0;
	left: 0;
	text-align: center;
	z-index: 999;
	overflow: auto;
}*/

.loader {
  border: 5px solid #123b7f;
    border-radius: 50%;
    border-top: 5px solid #3498db;
    width: 50px;
    height: 50px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
    position: absolute;
    right: 0;
    left: 0;
    text-align: center;
    z-index: 999;
    margin: 0 auto;
}



/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

#msg{
position:relative;
padding:0 15px;
top:-15px;
color: #fff;
text-align: center;
}
</style>
<script>
	$(document).ready(function() {
		$(".loader").hide();
		$("#otp").hide();
		$("#msg").hide();
		$("#password").hide();
		$("#confPassword").hide();
		$("#cancelBtn").hide();
		$("#otpSubmitBtn").hide();
		$("#pwdSubmitBtn").hide();
	});

	/* function for OTP */
	function getOTP() {
		var empid = $('#empid').val();
		var validAll = true;
		if (empid=="" || empid==null) {
	    	 $("#error4").html("Employee Id is Required");
	    	 validAll = false;
		}else{
			$("#error4").hide();
			validAll = true;
		}
		if (validAll) {
			$('.loader').show();
			$("#otpBtn").attr("disabled", true);
			var data = {};
			data.key = $("#empid").val();
			data.name = 'Employee number';
			$.ajax({
				type : "POST",
				url : "get-otp",
				dataType : "json",
				contentType : "application/json",
				data : JSON.stringify(data),
				success : function(response) {
					if (response.message == "Success") {
						$(".loader").hide();
						$("#hiduserid").val(response.body.key);
						$("#hidotp").val(response.body.code);
						$('#empid').attr('disabled', true);
						$("#otp").show();
						$("#password").hide();
						$("#otpBtn").hide();
						$("#confPassword").hide();
						$("#cancelBtn").show();
						$("#otpSubmitBtn").show();
						$("#msg").show();
					}else{
						$(".loader").hide();
						$("#otpBtn").show();
						$("#otpBtn").attr("disabled", false);
						$("#msg").hide();
					}
				},
				error : function(response) {
					console.log(response);
				}
			})

		}
	 else {

		}

	}
	/* function for OTP Submit */
	function otpSubmit() {
		otpVal();

		if (otpValid) {

			$("#msg").hide();
			$('#empid').hide();
			$("#orDiv").hide();
			$("#otp").hide();
			$("#password").show();
			$("#confPassword").show();
			$("#otpBtn").hide();
			$("#cancelBtn").show();
			$("#otpSubmitBtn").hide();
			$("#pwdSubmitBtn").show();
		}
	}
	/* function for Password Submit */
	function pwdSubmit() {
		var validation = true;
		var data = {};
		data.key = $("#hiduserid").val();
		data.code = $("#password").val();
		passVal();
		cpassVal();
		if (passValid && cpassValid) {
			$.ajax({
				type : "POST",
				url : "save-new-password",
				dataType : "json",
				contentType : "application/json",
				data : JSON.stringify(data),
				success : function(response) {
					if (response.message == "Success") {
						cancel();
					}
				},
				error : function(response) {
					console.log(response);
				}
			})
		}
	}
	/* function for cancel */
	function cancel() {
		window.location.href = '/login';
		$("#hiduserid").val('');
		$("#hidotp").val('');
	}
	/* function for otp validation */
	var otpValid;
	function otpVal() {
		var otp = $('#otp').val();
		var hidotp = $('#hidotp').val();

		if (otp != '') {
			if (otp.match(hidotp)) {
				$("#error1").hide();
				otpValid = true;
				return true;
			} else {
				$("#error1").html("please enter valid OTP");
				otpValid = false;
				return false;
			}
		} else {
			$("#error1").html(" OTP is Required");
			otpValid = false;
			return false;
		}

	}
	/* function for password */
	var passValid;
	function passVal() {
		var password = $('#password').val();

		if (password != '') {
			$("#error2").hide();
			passValid = true;
			return true;
		} else {
			$("#error2").html(" Password is Required");
			passValid = false;
			return false;
		}

	}
	/* function for confirm password */
	var cpassValid;
	function cpassVal() {
		var password = $('#password').val();
		var confPassword = $('#confPassword').val();

		if (confPassword != '') {
			if (confPassword.match(password)) {
				$("#error3").hide();
				cpassValid = true;
				return true;
			} else {
				$("#error3")
						.html(
								"Your password and confirmation password do not match.");
				cpassValid = false;
				return false;
			}
		} else {
			$("#error3").html(" Confirm Password is Required");
			cpassValid = false;
			return false;
		}

	}
</script>
</head>
<body>

	<div class="container pt-3">
		<div class="row justify-content-sm-center">
			<div class="col-sm-9 col-md-9">
				<div class="row">
					<div class="col-md-6 login-form-1">
						<div class="signin-txt">Sign In</div>
						<input type="hidden" id="hiduserid"> <input type="hidden"
							id="hidotp">
						<div class="signup-subtxt">Please enter your Employee number
							to search your account.</div>
						<div class="input-group">
							<input type="text" class="form-control1" id="empid"
								 maxLength="10" name="empid"
								placeholder="Employee No">
								<span id="error4" class="formValidation"></span>
						</div>
					<div class="loader"></div>
						<div class="input-group mt-4">
							<input type="text" class="form-control1" id="otp" name="otp"
								onkeyup="checkNum('otp')" maxLength="6" placeholder="Enter OTP">
							<span id="error1" class="formValidation"></span>
						</div>
						<div class="input-group mb-3">
							<input type="text" class="form-control1" id="password"
								name="pass" placeholder="Enter New Password"> <span
								id="error2" class="formValidation"></span>
						</div>
						<div class="input-group mb-3">
							<input type="text" class="form-control1" id="confPassword"
								name="confPass" placeholder="Enter Confirm Password"> <span
								id="error3" class="formValidation"></span>
						</div>
						<div class="row">
							<div class="col-md-12" align="center">
								<button type="button" class="btn btn-reg  mb-3" id="otpBtn"
									onclick="getOTP()">Get OTP</button>
							</div>
							<div id="msg">Please check your registered email. You must have received an email with the OTP</div>

						</div>

						<div class="row">
							<div class="col-md-6" style="padding-right: 1px;" id="cancelBtn">
								<button class="btn btn-login btn-block mb-3" type="button"
									onclick="cancel()">Cancel</button>
							</div>
							<div class="col-md-6" style="padding-left: 1px;"
								id="otpSubmitBtn">
								<button type="button" class="btn btn-reg btn-block mb-3"
									onclick="otpSubmit()">Submit</button>
							</div>
							<div class="col-md-6" style="padding-left: 1px;"
								id="pwdSubmitBtn">
								<button type="button" class="btn btn-reg btn-block mb-3"
									onclick="pwdSubmit()">Submit</button>
							</div>
						</div>

					</div>
					<div class="col-md-6 login-form-2">

						<div class="logo" align="center">
							<img src="assets/images/login_img/logo.png" class="logo">
						</div>

						<div class="text-center">
							Accelerate your business with NERP.
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
</body>
</html>
