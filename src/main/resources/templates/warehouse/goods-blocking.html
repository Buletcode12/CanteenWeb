<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/master}">
<head>
<style>
.wd-10{
width:11%;margin:3px}
.wd-15{
width:17%;margin:3px}
.dropbtn {
	color: white;
	font-size: 16px;
	border: none;
}

.dropdown {
	position: relative;
	display: inline-block;
}

.dropdown-content {
	display: none;
	position: absolute;
	background-color: #f1f1f1;
	min-width: 98px;
	z-index: 9999999 !important;
	top: 33px;
	left: -2px;
	border: solid 1px #7b7878;
	color: #333;
}

.dropdown-content a {
	font-size: 13px !important;
	color: black;
	padding: 0px 8px;
	text-decoration: none;
	display: block;
	cursor: pointer;
}

.dropdown-content a:hover {
	background-color: #ddd;
}

.dropdown:hover .dropdown-content {
	display: block;
}

.dropdown:hover .dropbtn {
	background-color: #D4F5F7;
}

.roomdetails h3 {
	font-size: 15px;
	font-family: 'Montserrat', sans-serif;
	color: #fff;
	font-weight: 100;
	margin-bottom: 0;
	margin-top: 10px;
	background-color: #4882d4;
	padding: 10px;
}
.modal1 {
    position: fixed;
    top: 167px;
    left: 337px;
    z-index: 1055;
    display: none;
    width: 100%;
    height: 100%;
    overflow-x: hidden;
    overflow-y: auto;
    outline: 0;
}
.totalHour{
  border: 1px solid #ddd;
  border-radius: 2px;
  background-color: #C5C5C5;
  padding: 10px; 
  font-size: 12px; 
  color: #333; 
  transition: border-color 0.3s ease-in-out;
    width: 107px;
}
</style>
<script>
$(document).ready(function() {
	$('#deleteBinQty').attr("disabled", true);
		var gridDiv = document.querySelector('#myGrid');
		new agGrid.Grid(gridDiv, gridOptions); 

		var rowData = [];
		gridOptions.api.setRowData(rowData);
		
		 agGrid.simpleHttpRequest({
			url : "goods-blocking-through-ajax"
		}).then(function(data) {
			var jsonData = JSON.parse(data.body);
			console.log(jsonData)
			var allData=jsonData.BlockData;
			console.log(allData)
			var len = allData.length;
			$('#totalBlocking').find('span').html(len);
			gridOptions.api.setRowData(allData);
		});
		 
		 
		 var gridDiv = document.querySelector('#myGridBlockQty');
			new agGrid.Grid(gridDiv, gridOptionsBlocckQty);  
			gridOptionsBlocckQty.api.setRowData();
			
			 $('#deleteData').attr("disabled", true);
			 $('#dispatchRequest').attr("disabled", true);
			 
		var dateFormat = localStorage.getItem("dateFormat");
		$("#manufactureDateCalendar").datetimepicker({
			format : dateFormat,
			closeOnDateSelect : true,
			timepicker : false,
			//minDate : 0,
		}).on("change", function() {
			$('#manufactureDate').val($(this).val());
		})

		$('#manufactureDate').blur(function() {
			$("#manufactureDateCalendar").val($(this).val());
		})
		
			$("#bestBeforeCalendar").datetimepicker({
			format : dateFormat,
			closeOnDateSelect : true,
			timepicker : false,
			//minDate : 0,
		}).on("change", function() {
			$('#bestBeforeDate').val($(this).val());
		})

		$('#bestBeforeDate').blur(function() {
			$("#bestBeforeCalendar").val($(this).val());
		})
		
	$("#toDateCalendarTime").datetimepicker({
		format : 'H:i',
		closeOnDateSelect : false,
		timepicker : true,
		datepicker : false,
		step: 15
	}).on("change", function() {
		$('#manufactureTime').val($(this).val());
	})

	$('#manufactureTime').blur(function() {
		$("#toDateCalendarTime").val($(this).val());
	})
	$("#addData").hide();


		var ld = localStorage.getItem('ReqBlockData');
							var data = JSON.parse(ld);
							console.log(data)
							
							if (data) {
								add();
								
								$('#searchRowDiv').hide();
								$("#add").hide();
								$("#myGrid").hide();
								$("#save").show();
								$("#Cancel").show();
								$("#addData").show();
								$("#totalItem").hide();
								$("#dwnld").hide();
	                            $("#requestId").val(data.id);
	                           
								$("#categoryId").val(data.category);
								getItemList(data.item);
								$("#quantity").val(data.qty);
								$("#unit").val(data.unit);
								getFilterWarehouseData();
								 localStorage.setItem('ReqBlockData', null);
							} else {
							}
		
		
    });

function activeRoom(id) {
	var cl=$("#" + id).attr('class');
	if(cl=="roombtn cp roombtnassigned"){
		 $("#" + id).removeClass("roombtnassigned");
		$("#" + id).addClass("roombtnactive");
	}else if(cl=="roombtn cp roombtnactive"){
	   $("#" + id).removeClass("roombtnactive");
	   $("#" + id).addClass("roombtnassigned");
	 
	}else{
		
	}
}

function blockRoom(id) {
	var cl=$("#" + id).attr('class');
	if(cl=="roombtn cp roombtnpartialblocked"){
		 $("#" + id).removeClass("roombtnpartialblocked");
		$("#" + id).addClass("roombtnactive");
	}else if(cl=="roombtn cp roombtnactive"){
		   $("#" + id).removeClass("roombtnactive");
		   $("#" + id).addClass("roombtnpartialblocked");
     }else{
		
	}
}

 
 

var colmnDefs = [
	{
		headerCheckboxSelection : false,
		headerCheckboxSelectionFilteredOnly : true,
		checkboxSelection : true,
		width : 10,
		sortable : false,
		filter : false,
		resizable : true
	},
	{ 
		headerName : "Block Id",
		field : "blockId",
		width : 130,
	
	}, {
		
		headerName : 'Warehouse',
		field : "warehouseName",
			width : 150,
	}, {
		
		headerName : 'Category',
		field : "categoryName",
		width : 200,
		  
	}, {  
		headerName : 'Item Name',
		field : "ItemName",
		width : 200,
	}, {  
		  
		headerName : 'Quantity',
		field : "quantity",
		width : 100,
		type : 'rightAligned',
	}, {
		  
		headerName : 'Unit',
		field : "unitName",
		width : 100,
	
	}, {
		headerName : 'Bin',
		field : "binIdBlocking",
		width : 150, 
	}, {
		headerName : 'Assign Status',
		field : "assignStatus",
		width:140,
		cellStyle : {
			textAlign : 'center'
		},
		cellRenderer : function(params) {
			if (params.data.assignStatus =="Assigned") { 
				return '<div style="color:#0642f5">'+params.data.assignStatus+'</div>';
			}else {
				return '<div style="color:#a9a9a9">'+params.data.assignStatus+'</div>';
			}
		}
	},{
		headerName : 'Dispatch Status',
		field : "dispatchStatus",
		width:150,
		cellStyle : {
			textAlign : 'center'
		},
		cellRenderer : function(params) {
			if (params.data.dispatchStatus =="Dispatched") { 
				return '<div style="color:#0642f5">'+params.data.dispatchStatus+'</div>';
			}else if(params.data.dispatchStatus =="In Progress") {
				return '<div style="color:#ffa500">'+params.data.dispatchStatus+'</div>';
			}else{
				return '<div style="color:#a9a9a9">'+params.data.dispatchStatus+'</div>';
			}
		}
	
	} ];

var gridOptions = {
		columnDefs : colmnDefs,
		rowSelection : 'single',
		onSelectionChanged : onRowSelection,
		groupSelectsChildren : true,
		suppressRowClickSelection : true,
		suppressAggFuncInHeader : true,
		defaultColDef : {
			sortable : true,
			filter : true,
			resizable : true,
			width : 130,
			height : 10
		},

	};
window.index=-1;	
var columnDefsBlockQty = [
	{
		headerCheckboxSelection : false,
		headerCheckboxSelectionFilteredOnly : true,
		checkboxSelection : true,
		width : 10,
		sortable : false,
		filter : false,
		resizable : true
	},
	{
		headerName : "Bin Id",
		field : "binId",
		width : 150,
		hide:true
	
	}, {
		headerName : "Bin Name",
		field : "binName",
		width : 100,
	
	}, {
		headerName : "Zone Name",
		field : "zoneId",
		width : 100,
		hide:true
	}, {
		headerName : "Allocation Id",
		field : "allocationId",
		width : 100,
		//hide:true
	
	}, {
		headerName : 'Unit',
		field : "unitName",
			width : 80,
	}, {
		headerName : 'Stock Quantity',
		field : "stockQuntity",
		width : 130,
	  
	
	}, {  
		headerName : 'Block Quantity',
		field : "blockQuntity",
		width : 130,
		cellRenderer : function(params) {
			index=index+1;
				return '<input type="number" class="totalHour" value="0" min="0" placeholder="Block Quqntity" id="'+"binqty"+window.index+'">';
		},
		 
	}, {
		headerName : 'SlNo. From',
		field : "slNoFrom",
		width : 120,
		
		cellRenderer : function(params) {
			return '<input type="number" class="totalHour" value="0" min="0" placeholder="SlNo. From" id="'+"slfrom"+window.index+'">';
	},
		  
	}, {  
		headerName : 'SlNo. To',
		field : "slNoTo",
		width : 120,
		
		cellRenderer : function(params) {
			return '<input type="number" class="totalHour" value="0" min="0" placeholder="SlNo. To" id="'+"slto"+window.index+'">';
	},
	}, {  
		headerName : 'Remark',
		field : "binBlockRemark",
		width : 200,
		cellRenderer : function(params) {
			return '<input type="text" class="totalHour" placeholder="Drop Remarks" id="'+"remark"+window.index+'">';
	},
	
	
	} ];

var gridOptionsBlocckQty = {
columnDefs : columnDefsBlockQty,
rowSelection : 'single',
onSelectionChanged : onRowSelectionBin,
groupSelectsChildren : true,
suppressRowClickSelection : true,
suppressRowClickSelection : true,
suppressAggFuncInHeader : true,
defaultColDef : {
	sortable : true,
	filter : true,
	resizable : true,
	width : 251,
	height : 10
},
}; 
	
	
	var blockid="";
	function onRowSelection(){
		var selectedNodes = gridOptions.api.getSelectedNodes();
		 var selectedData = selectedNodes.map(node => node.data);
		 blockid= selectedData.map(node => node.blockId);
		 var rowCount = 0;
		 selectedNodes.forEach(function(selectedNodes, index) {
				rowCount = rowCount + 1;
			});
		 
		 if (rowCount > 0) {
				$('#add').attr("disabled", true);
				$('#deleteData').attr("disabled", false);
				$('#dispatchRequest').attr("disabled", false);
			 	
				 if (selectedData.map(node => node.assignStatus)!="Assigned"){
					 $('#dispatchRequest').attr("disabled", false);
					 $('#deleteData').attr("disabled", false);
					 
				 }else{
					 $('#dispatchRequest').attr("disabled", true);
					 $('#deleteData').attr("disabled", true);
				 } 
					
			} else {
				$('#add').attr("disabled", false);
				$('#deleteData').attr("disabled", true);
				$('#dispatchRequest').attr("disabled", true);
				
			}
		}
	
function onRowSelectionBin() {
		
		var selectedRows = gridOptionsBlocckQty.api.getSelectedRows();
		var rowCount = 0;
		selectedRows.forEach(function(selectedRow, index) {
			rowCount = rowCount + 1;
		});

		if (rowCount > 0) {
			$('#deleteBinQty').attr("disabled", false);
			$('#submit').attr("disabled", true);
			

		} else {
			$('#deleteBinQty').attr("disabled", true);
			$('#submit').attr("disabled", false);
			
		}

	}
	
	
	function onCellKeyPress(fieldId) {
		 var pending=parseFloat($("#pendingQut").val());
			var tempVal = $("#" + fieldId).val().replace(/[^0-9 ]/g, '');
			if( tempVal <= pending)		
			{
				$("#" + fieldId).val(tempVal);
				$("#packQut").val(tempVal);
			}
			else{
				
				$("#messageParagraph").text(
				"Please add less than or same Packing Quantity as Pending Quantity");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
				$("#" + fieldId).val(null);
				$("#packQut").val(null);
			}
		
		}
	
	//Data Dispatch Request
	function dispatchRequest() {
		$('#dispatchRequestModel').modal('show');
	}
	function cancelDispatchRequest() {
     $('#dispatchRequestModel').modal('hide');
	}
	
	
	function dispatchRequestOnclick() {
		if (blockid) {
		var assignStatus = 1;
		$('#dispatchRequestModel').modal('show');
		$('.loader').show();
	$.ajax({
		type : "GET",
		url : "goods-blocking-assignForDispatch?assignStatus=" + assignStatus + "&blockId=" + blockid,
		async : false,
		success : function(response) {
			if (response.code == "success") {
				$('.loader').hide();
				$('#dispatchRequestModel').modal('hide');
				$('#deleteData').attr("disabled", true);
				$('#dispatchRequest').attr("disabled", true);
				$('#add').attr("disabled", false);
				Cancel();
				$("#messageParagraph").text("Assigned Successfully");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
			}else{
				$('.loader').hide();
				$('#dispatchRequestModel').modal('show');
			}
			
		},
		error : function(data) {
		}
	});
	}
}
	
	//Delete Block data
	function deleteData() {
		if (blockid) {
			$.ajax({
				type : "GET",
				url : "goods-blocking-delete?blockId=" + blockid,
				async : false,
				success : function(response) {
					if (response.code == "success") {
						$('#deleteData').attr("disabled", true);
						Cancel();
						$("#messageParagraph").text("Data deleted Successfully");
						$("#msgOkModal").removeClass("btn3");
						$("#msgOkModal").addClass("btn1");
						$("#msgModal").modal('show');
					} else {

					}
				},
				error : function(data) {
					console.log(data)
				}
			})
		}

	}
	
	

function add() {
	var warehouseId = $('#warehouseId').val()
	openDetails(warehouseId);
	 getZoneList(warehouseId);
	$("#searchRowDiv").hide();

    $('#hideTbl').hide();
	$("#add").hide();
	$("#myGrid").hide();
	$("#save").show();
	$("#Cancel").show();
	$("#addData").show();
	$("#totalBlocking").hide();
	$("#dwnld").hide();
	$("#deleteData").hide();
	$("#dispatchRequest").hide();
	$("#rackId").val("");
	$("#categoryId").val("");
	$("#itemName").val("");
	$("#unit").val("");
	$("#quantity").val("");
	$("#requestId").val("");
	$("#aidd").val("");
	
	


}
 
function Cancel(){
	 
	 agGrid.simpleHttpRequest({
			url : "goods-blocking-through-ajax"
		}).then(function(data) {
			var jsonData = JSON.parse(data.body);
			var allData=jsonData.BlockData;
			var len = allData.length;
			$('#totalBlocking').find('span').html(len);
			gridOptions.api.setRowData(allData);
		});
		$('.formValidation').remove();
	
		$("#add").show();
		$("#myGrid").show();
		$("#save").hide();
		$("#Cancel").hide();
		$("#addData").hide();
		$('#hideTbl').show();
		$("#totalBlocking").show();
		$("#dwnld").show();
		
		$("#reqTable").show();
		$(".btn-hs").show();
		 $("#searchRowDiv").show();
		 $("#deleteData").show();
		$("#dispatchRequest").show();
}
</script>


<script>
$(document).ready(
		function() {
			var toggler = document.getElementsByClassName("caret");
			var i;

			for (i = 0; i < toggler.length; i++) {
				toggler[i].addEventListener("click", function() {
					this.parentElement.querySelector(".nested").classList
							.toggle("active");
					this.classList.toggle("caret-down");
				});
			}

		});

function openDetails() {
	 $('.loader').show();
		$("body").addClass("overlay");
	var warehouseId = $('#warehouseId').val()
     getZoneList(warehouseId);
	 $.ajax({
			type : "GET",
			url : "goods-blocking-get-data?warehouseId=" + warehouseId,
			dataType : 'json',
			contentType : 'application/json',
			data : warehouseId,
			success : function(response) {
				console.log(response)
				if (response.code == "success") {
					$('.loader').hide();
					$("body").removeClass("overlay");
					$(".roomListDiv").empty();
					var jsonData = JSON.parse(response.body);
					for (var i = 0; i < jsonData.ZoneData.length; i++) {
						$(".slidearrow").show();
						var div = "";
						if (jsonData.ZoneData[i].BinData.length > 0) {
							for (var j = 0; j <jsonData.ZoneData[i].BinData.length; j++) {
								
								var whId =jsonData.ZoneData[i].warehouse_id;
								var zoneId =jsonData.ZoneData[i].zone_id;
								var zoneCode =jsonData.ZoneData[i].zone_code;
								var zoneName =jsonData.ZoneData[i].zone_name;
								
								var rackId =jsonData.ZoneData[i].rack_id;
								var rackCode =jsonData.ZoneData[i].rack_code;
								var rackName =jsonData.ZoneData[i].rack_name;
								
								var rmId =jsonData.ZoneData[i].BinData[j].bin_id;
								var rmCode = jsonData.ZoneData[i].BinData[j].bin_code;
								var rmName = jsonData.ZoneData[i].BinData[j].bin_name;
								var blockingStatus = jsonData.ZoneData[i].BinData[j].bin_blocking_status;
								var allocateid = jsonData.ZoneData[i].BinData[j].allocationId;
								var bin_categoryName = jsonData.ZoneData[i].BinData[j].bin_categoryName;
								var bin_itemname = jsonData.ZoneData[i].BinData[j].bin_itemname;
								var batch_no = jsonData.ZoneData[i].BinData[j].batch_no;
								var mfg_date = jsonData.ZoneData[i].BinData[j].mfg_date;
								var bestbefore_date = jsonData.ZoneData[i].BinData[j].bestbefore_date;
								var serial_no = jsonData.ZoneData[i].BinData[j].serial_no;
								var unitBinStock = jsonData.ZoneData[i].BinData[j].unitBinStock;
							
							//	$('#aidd').val(allocateid);
								
								var binquantity = jsonData.ZoneData[i].BinData[j].bin_qty;
								
								var sec_room = i + '_' + j;
								var textLen = jsonData.ZoneData[i].BinData.length;
								if (blockingStatus=="0") {
									
									if (textLen > 7) {
										div = div
												+ '<div class="dropdown dropbtn">'
												+ '<span title="Bin" data-value="'+rmId+'" data-aid="'+allocateid+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
												+ i
												+ '_'
												+ j
												+ '" class="roombtn cp roombtnassigned"  data-rmName="'
												+ rmName
												+ '" onclick=activeRoom("'
												+ sec_room
												+ '");>'
												+ rmName
												+'</span>'
												+'<span class="dropdown-content">'
											    +'<a onclick=viewstock("'
												+ rmId
												+ '","'
												+ window.btoa(bin_categoryName)
												+ '","'
												+ window.btoa(bin_itemname)
												+ '","'
												+ window.btoa(batch_no)
												+ '","'
												+ window.btoa(mfg_date)
												+ '","'
												+ window.btoa(bestbefore_date)
												+ '","'
												+ window.btoa(serial_no)
												+ '","'
												+ binquantity
												+ '","'
												+ window.btoa(unitBinStock)
												+ '")>View Stock</a>'
												+'</span>'
												+ '</div>';
									} else {
										div = div
												+ '<div class="dropdown dropbtn">'
												+ '<span title="Bin" data-value="'+rmId+'" data-aid="'+allocateid+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
												+ i
												+ '_'
												+ j
												+ '" class="roombtn cp roombtnassigned" data-rmName="'
												+ rmName
												+ '" onclick=activeRoom("'
												+ sec_room
												+ '");>'
												+ rmName
												+'</span>'
												+'<span class="dropdown-content">'
											    +'<a onclick=viewstock("'
												+ rmId
												+ '","'
												+ window.btoa(bin_categoryName)
												+ '","'
												+window.btoa(bin_itemname)
												+ '","'
												+ window.btoa(batch_no)
												+ '","'
												+ window.btoa(mfg_date)
												+ '","'
												+ window.btoa(bestbefore_date)
												+ '","'
												+ window.btoa(serial_no)
												+ '","'
												+ binquantity
												+ '","'
												+ window.btoa(unitBinStock)
												+ '")>View Stock</a>'
												+'</span>'
												+ '</div>';
									}

								} else {
									if (blockingStatus=='2'){
										if (textLen > 7) {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnpartialblocked" data-rmName="'
													+ rmName
													+ '" onclick=blockRoom("'
													+ sec_room
													+ '");>'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewstock("'
													+ rmId
													+ '","'
													+ window.btoa(bin_categoryName)
													+ '","'
													+window.btoa(bin_itemname)
													+ '","'
													+ window.btoa(batch_no)
													+ '","'
													+ window.btoa(mfg_date)
													+ '","'
													+ window.btoa(bestbefore_date)
													+ '","'
													+ window.btoa(serial_no)
													+ '","'
													+ binquantity
													+ '","'
													+ window.btoa(unitBinStock)
													+ '")>View Stock</a>'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										} else {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'"  data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnpartialblocked" data-rmName="'
													+ rmName
													+ '" onclick=blockRoom("'
													+ sec_room
													+ '");>'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewstock("'
													+ rmId
													+ '","'
													+ window.btoa(bin_categoryName)
													+ '","'
													+window.btoa(bin_itemname)
													+ '","'
													+ window.btoa(batch_no)
													+ '","'
													+ window.btoa(mfg_date)
													+ '","'
													+ window.btoa(bestbefore_date)
													+ '","'
													+ window.btoa(serial_no)
													+ '","'
													+ binquantity
													+ '","'
													+ window.btoa(unitBinStock)
													+ '")>View Stock</a>'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										}
									}else{
										if (textLen > 7) {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnblocked" data-rmName="'
													+ rmName
													+ '" >'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										} else {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnblocked" data-rmName="'
													+ sec_room
													+ '" >'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										}
									}
								}

							}
						}
						var tbl = '<h3 class="roomLoc roomSectionDiv_'+zoneName+' roomFloorDiv_'+zoneName+'">'
						+zoneName
						+ ' ('
						+ textLen
						+ ')</h3>'
						+ '<div class="row btmgap roomLoc roomSectionDiv_'+zoneName+' roomFloorDiv_'+zoneName+'"><div class="col-md-12 roomsection rmsec_'+zoneId+'">'
						+ div + '</div></div>';

						$(".roomListDiv").append(tbl);
					}
 

					//console.log(tbl)

					$('.loader').hide();
					$("body").removeClass("overlay");

				}
			},
			error : function(data) {
				console.log(data);
				
			}
		})
}

function getZoneList(warehouseId) {
	if (warehouseId) {
		var option = $("<option></option>");
		$(option).val(null);
		$(option).html("Select");
		$.ajax({
			type : "GET",
			url : "goods-blocking-getzoneList?id=" + warehouseId,
			success : function(response) {
				if (response.code == "success") {
					$("#zoneId").empty();
					var option = $("<option></option>");
					$(option).val(null);
					$(option).html("Select");
					$("#zoneId").append(option);
					for (var i = 0; i < response.body.length; i++) {
						var option = $("<option></option>");
						$(option).val(response.body[i].key);
						$(option).html(response.body[i].name);
						$("#zoneId").append(option);
					}
				}
			},
			error : function(e) {
			}
		});
	} else {
		$("#zoneId").empty();
		var option = $("<option></option>");
		$(option).val(null);
		$(option).html("warehouseId");
		$("#zoneId").append(option);
		$("#zoneId").empty();
		var option = $("<option></option>");
		$(option).val(null);
		$(option).html("Select");
	}
}

function getRackList() {
	var  zoneIdListId= $('#zoneId').val();
	if (zoneIdListId) {
		var option = $("<option></option>");
		$(option).val(null);
		$(option).html("Select");
		$.ajax({
			type : "GET",
			url : "goods-blocking-getrackList?id=" + zoneIdListId,
			success : function(response) {
				if (response.code == "success") {
					$("#rackId").empty();
					var option = $("<option></option>");
					$(option).val(null);
					$(option).html("Select");
					$("#rackId").append(option);
					for (var i = 0; i < response.body.length; i++) {
						var option = $("<option></option>");
						$(option).val(response.body[i].key);
						$(option).html(response.body[i].name);
						$("#rackId").append(option);
					}
				}
			},
			error : function(e) {
			}
		});
	} else {
		$("#rackId").empty();
		var option = $("<option></option>");
		$(option).val(null);
		$(option).html("Select");
		$("#rackId").append(option);
	}
}
function getItemList(rtid) {
    var categoryId = $("#categoryId").val();
    if (categoryId) {
        $("#itemName").empty();
        var option = $("<option></option>");
        $(option).val(null);
        $(option).html("Select");
        $("#itemName").append(option);
        $.ajax({
            type: 'GET',
            url: 'goods-blocking-getitemList?id=' + categoryId,
            contentType: false,
            success: function(response) {
                if (response.code == "success") {
                    $("#itemName").empty();
                    var option = $("<option></option>");
                    $(option).val(null);
                    $(option).html("Select");
                    $("#itemName").append(option);
                    for (var i = 0; i < response.body.length; i++) {
                        var option = $("<option></option>");
                        $(option).val(response.body[i].key);
                        $(option).html(response.body[i].name);
                        $("#itemName").append(option);
                    }
                if(rtid!="" && rtid!=""){
                    	 $("#itemName").val(rtid);
                    } 
                }
            },
            error: function(e) {
                alert("error");
            }
        });
    } else {
        $("#itemName").empty();
        var option = $("<option></option>");
        $(option).val(null);
        $(option).html("Select");
        $("#itemName").append(option);
    }
}




function getFilterWarehouseData(){
	 
	var warehouseId = $('#warehouseId').val()
	var zoneId = $('#zoneId').val()
	var categoryId = $('#categoryId').val()
	var itemName = $('#itemName').val()
	var rackId = $('#rackId').val()
	var validation = true;
	var obj = {};
		if (obj.warehouseId == null || obj.warehouseId == "") {
			validation = validationUpdated("Please Select Warehouse",
					"warehouseId");
		}
	if (validation){
	 $.ajax({
			type : "GET",
			url : "goods-blocking-get-filterData?warehouseId=" + warehouseId + "&zoneId=" + zoneId + "&rackId=" + rackId+ "&categoryId=" + categoryId + "&itemName=" + itemName ,
			dataType : 'json',
			contentType : 'application/json',
			success : function(response) {
				if (response.code == "success") {
					$(".roomListDiv").empty();
					var jsonData = JSON.parse(response.body);
					console.log('hiioaaa',jsonData);
					console.log('hiioaaabbb',jsonData.ZoneData.length); 
					for (var i = 0; i < jsonData.ZoneData.length; i++) {
						$(".slidearrow").show();
						var div = "";
						if (jsonData.ZoneData[i].BinData.length > 0) {
							for (var j = 0; j <jsonData.ZoneData[i].BinData.length; j++) {
								
								var whId =jsonData.ZoneData[i].warehouse_id;
								var zoneId =jsonData.ZoneData[i].zone_id;
								var zoneCode =jsonData.ZoneData[i].zone_code;
								var zoneName =jsonData.ZoneData[i].zone_name;
								
								var rackId =jsonData.ZoneData[i].rack_id;
								var rackCode =jsonData.ZoneData[i].rack_code;
								var rackName =jsonData.ZoneData[i].rack_name;
								
								var rmId =jsonData.ZoneData[i].BinData[j].bin_id;
								var rmCode = jsonData.ZoneData[i].BinData[j].bin_code;
								var rmName = jsonData.ZoneData[i].BinData[j].bin_name;
								var sec_room = i + '_' + j;
								var blockingStatus = jsonData.ZoneData[i].BinData[j].bin_blocking_status;
								
								var allocateid = jsonData.ZoneData[i].BinData[j].allocationId;
								
								var binquantity = jsonData.ZoneData[i].BinData[j].bin_qty;
								var bin_categoryName = jsonData.ZoneData[i].BinData[j].bin_categoryName;
								var bin_itemname = jsonData.ZoneData[i].BinData[j].bin_itemname;
								var batch_no = jsonData.ZoneData[i].BinData[j].batch_no;
								var mfg_date = jsonData.ZoneData[i].BinData[j].mfg_date;
								var bestbefore_date = jsonData.ZoneData[i].BinData[j].bestbefore_date;
								var serial_no = jsonData.ZoneData[i].BinData[j].serial_no;
								var unitBinStock = jsonData.ZoneData[i].BinData[j].unitBinStock;
								var textLen = jsonData.ZoneData[i].BinData.length;
								if (blockingStatus=="0") {
									if (textLen > 7) {
										div = div
												+ '<div class="dropdown dropbtn">'
												+ '<span title="Bin" data-value="'+rmId+'" data-aid="'+allocateid+'"  data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
												+ i
												+ '_'
												+ j
												+ '" class="roombtn cp roombtnassigned"  data-rmName="'
												+ rmName
												+ '" onclick=activeRoom("'
												+ sec_room
												+ '");>'
												+ rmName
												+'</span>'
												+'<span class="dropdown-content">'
											    +'<a onclick=viewstock("'
												+ rmId
												+ '","'
												+ window.btoa(bin_categoryName)
												+ '","'
												+ window.btoa(bin_itemname)
												+ '","'
												+ window.btoa(batch_no)
												+ '","'
												+ window.btoa(mfg_date)
												+ '","'
												+ window.btoa(bestbefore_date)
												+ '","'
												+ window.btoa(serial_no)
												+ '","'
												+ binquantity
												+ '","'
												+ window.btoa(unitBinStock)
												+ '")>View Stock</a>'
												+'</span>'
												+ '</div>';
									} else {
										div = div
												+ '<div class="dropdown dropbtn">'
												+ '<span title="Bin" data-value="'+rmId+'" data-aid="'+allocateid+'"  data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
												+ i
												+ '_'
												+ j
												+ '" class="roombtn cp roombtnassigned" data-rmName="'
												+ rmName
												+ '" onclick=activeRoom("'
												+ sec_room
												+ '");>'
												+ rmName
												+'</span>'
												+'<span class="dropdown-content">'
											    +'<a onclick=viewstock("'
												+ rmId
												+ '","'
												+ window.btoa(bin_categoryName)
												+ '","'
												+ window.btoa(bin_itemname)
												+ '","'
												+ window.btoa(batch_no)
												+ '","'
												+ window.btoa(mfg_date)
												+ '","'
												+ window.btoa(bestbefore_date)
												+ '","'
												+ window.btoa(serial_no)
												+ '","'
												+ binquantity
												+ '","'
												+ window.btoa(unitBinStock)
												+ '")>View Stock</a>'
												+'</span>'
												+ '</div>';
									}

								} else {
									if (blockingStatus=='2'){
										if (textLen > 7) {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnpartialblocked" data-rmName="'
													+ rmName
													+ '" onclick=blockRoom("'
													+ sec_room
													+ '");>'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewstock("'
													+ rmId
													+ '","'
													+ window.btoa(bin_categoryName)
													+ '","'
													+window.btoa(bin_itemname)
													+ '","'
													+ window.btoa(batch_no)
													+ '","'
													+ window.btoa(mfg_date)
													+ '","'
													+ window.btoa(bestbefore_date)
													+ '","'
													+ window.btoa(serial_no)
													+ '","'
													+ binquantity
													+ '","'
													+ window.btoa(unitBinStock)
													+ '")>View Stock</a>'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										} else {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnpartialblocked" data-rmName="'
													+ rmName
													+ '" onclick=blockRoom("'
													+ sec_room
													+ '");>'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewstock("'
													+ rmId
													+ '","'
													+ window.btoa(bin_categoryName)
													+ '","'
													+window.btoa(bin_itemname)
													+ '","'
													+ window.btoa(batch_no)
													+ '","'
													+ window.btoa(mfg_date)
													+ '","'
													+ window.btoa(bestbefore_date)
													+ '","'
													+ window.btoa(serial_no)
													+ '","'
													+ binquantity
													+ '","'
													+ window.btoa(unitBinStock)
													+ '")>View Stock</a>'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										}
									}else{
										if (textLen > 7) {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'"  data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnblocked" data-rmName="'
													+ rmName
													+ '" >'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										} else {
											div = div
													+ '<div class="dropdown dropbtn">'
													+ '<span title="Bin" data-value="'+rmId+'" data-binqty="'+binquantity+'" data-zoneid="'+zoneId+'" id="'
													+ i
													+ '_'
													+ j
													+ '" class="roombtn cp roombtnblocked" data-rmName="'
													+ sec_room
													+ '" >'
													+ rmName
													+'</span>'
													+'<span class="dropdown-content">'
												    +'<a onclick=viewBlock("'
													+ rmId
													+ '")>View Block</a>'
													+'</span>'
													+ '</div>';
										}
									}

								}

							}
						}
						var tbl = '<h3 class="roomLoc roomSectionDiv_'+zoneName+' roomFloorDiv_'+zoneName+'">'
						+zoneName
						+ ' ('
						+ textLen
						+ ')</h3>'
						+ '<div class="row btmgap roomLoc roomSectionDiv_'+zoneName+' roomFloorDiv_'+zoneName+'"><div class="col-md-12 roomsection rmsec_'+zoneId+'">'
						+ div + '</div></div>';
						$(".roomListDiv").append(tbl);
					}
					$('.loader').hide();
					$("body").removeClass("overlay");
				}
			},
			error : function(data) {
				console.log(data);
			}
		})
  }

}
function validFormData() {
	var allValid = true;
	if (!validationUpdated("Warehouse Required", "warehouseId"))
		allValid = false;
	if (!validationUpdated("Category Required", "categoryId"))
		allValid = false;
	if (!validationUpdated("Quantity Required", "quantity"))
		allValid = false;
	if (!validationUpdated("Unit Required", "unit"))
		allValid = false;
	if (!validationUpdated("Item Name Required", "itemName"))
		allValid = false;
	return allValid;
}
var bdata = "";
var aiddatas = "";

function blocking(){
	window.index=-1;
	//var aidd=$('#aidd').val();
	if (validFormData()) {
	bdata = "";
	aiddatas = "";
	
    $('.roombtnactive').each(function(){
    	bdata = bdata + '"' + $(this).data("value") + '",';
    	aiddatas = aiddatas + '"' + $(this).data("aid") + '",';
    });
    bdata = bdata.substring(0, bdata.length - 1);
    aiddatas = aiddatas.substring(0, aiddatas.length - 1);
     if(bdata){
    	 $('#blockGoods').modal('show');
    	 
    	 var item = [];  
		 var bindatass = "";
		 item.categoryId = $("#categoryId option:selected").text();
		   item.itemName = $("#itemName option:selected").text();
		   item.unit = $("#unit option:selected").text();
		  var quantity = $('#quantity').val()
			$("#binCategoryMod").val(item.categoryId);
			 $("#binItemMod").val(item.itemName );
			 $("#quantityMod").val(quantity);
			 $("#unitBinMod").val(item.unit); 
		    $('.roombtnactive').each(function(){
		    	var obj = {};
		    	obj.binId=$(this).data("value");
		    	obj.allocationId=$(this).data("aid");
		    	//obj.allocationId=aidd;
		    	obj.unitName = $("#unit option:selected").text();
		    	obj.zoneId = $(this).data("zoneid");
		    	obj.binName = $(this).data("rmname");
		    	obj.stockQuntity = $(this).data("binqty");
		    	obj.blockQuntity="0"
		    	obj.slNoFrom="0"
		    	obj.slNoTo="0"
		    	bindatass = bindatass + '' + $(this).data("value") + ',';
		    	item.push(obj)
		    });
		    bindatass = bindatass.substring(0, bindatass.length - 1); 
		    gridOptionsBlocckQty.api.setRowData(item);
		    var len = item.length;
		    $('#totalGoodsList').find('span').html(len);
    	 
    }else{
		$("#messageParagraph").text("Please Select Atleast one Bin !");
		$("#msgOkModal").removeClass("btn3");
		$("#msgOkModal").addClass("btn1");
		$("#msgModal").modal('show');
		$("#msgModal").modal('hide');
    } 
  }
}  	
 
function submit(){
	if (validFormData()) {
	var datas = [];
	let sum = 0;
	let i=-1;
	gridOptionsBlocckQty.api.forEachNode(function(rowNode, indrx) {
    	var obj = {};
    	i=i+1;
    
    	var warehouseId = $('#warehouseId').val()
    	var rackId = $('#rackId').val()
    	var categoryId = $('#categoryId').val()
    	var itemName = $('#itemName').val()
    	var unit = $('#unit').val()
    	var requestId = $('#requestId').val()
    	obj.warehouseId = $("#warehouseId").val();
    	obj.rackId = $("#rackId").val();
    	obj.categoryId = $("#categoryId").val();
    	obj.itemName = $("#itemName").val();
    	obj.unit = $("#unit").val();
    	obj.remarks = $("#remarks").val();
    	obj.blockId = $("#blockId").val();
    	obj.requestId = $("#requestId").val();
    	obj.quantity = $("#quantity").val();
    	obj.allocationId = rowNode.data.allocationId;
    	obj.binId = rowNode.data.binId;
    	obj.zoneId = rowNode.data.zoneId;
    	obj.stockQuntity = rowNode.data.stockQuntity;
    	obj.blockQuntity=$('#binqty'+i).val();
    	obj.slNoFrom=$('#slfrom'+i).val();
    	obj.slNoTo=$('#slto'+i).val();
    	obj.binBlockRemark=$('#remark'+i).val();
    	sum +=parseInt(obj.blockQuntity);
 	   console.log(sum); 
 	  if (obj.blockQuntity != "0") {
    	if (obj.blockQuntity <= rowNode.data.stockQuntity ) {
    		datas.push(obj);
		} else {
			datas.push("");
			$("#messageParagraph").text(
			"Please add less than or same Block Quantity as Stock Quantity");
			$("#msgOkModal").removeClass("btn3");
			$("#msgOkModal").addClass("btn1");
			$("#msgModal").modal('show');
		}
    	
    	console.log(obj)
    	//datas.push(obj);
 	 }else{
		   datas.push("");
		   $("#messageParagraph").text(
			"Please Remove Zero Quantity Bin");
			$("#msgOkModal").removeClass("btn3");
			$("#msgOkModal").addClass("btn1");
			$("#msgModal").modal('show');  
	   }
    });
	 console.log(sum); 
	  	if ($("#quantity").val()==sum) {
	  	
	  		submitBlockDetails(datas);
		} else {
			datas.push("");
			$("#messageParagraph").text(
			"Please add  same Block Quantity as Quantity");
			$("#msgOkModal").removeClass("btn3");
			$("#msgOkModal").addClass("btn1");
			$("#msgModal").modal('show');
		} 
    console.log(datas)
  /*   if(datas){
    	submitBlockDetails(datas);
    } */
	}
	
}

 function submitBlockDetails(datas) {
	 
	console.log(datas)
	$.ajax({
				type : "POST",
				url : "goods-blocking-submit-blockdetails",
				contentType : "application/json",
				data : JSON.stringify(datas),
				success : function(response) {
					if (response.code == "success") {
						$("#messageParagraph").text(
						"Data Saved Successfully");
						$("#msgOkModal").removeClass("btn3");
						$("#msgOkModal").addClass("btn1");
						$("#msgModal").modal('show');
						$('.loader').hide();
						$("body").removeClass("overlay");
						closeIcon();
						Cancel();
					} else {
						$('.loader').hide();
						$("body").removeClass("overlay");
					}
				},
				error : function(data) {
					console.log(data);
					$('.loader').hide();
					$("body").removeClass("overlay");
				}
			})
}

function closeIcon() {
	$('#blockGoods').modal('hide');
	$("#remarks").val('');
	openDetails();
}
function getAllocateData(){
	
}
/* Excel download  */
function downloadDetails() { 
	  var dataset = [];
	  gridOptions.api.forEachNodeAfterFilterAndSort(function(rowNode, index) {
	        dataset.push(rowNode.data);
	    });
	  gridOptions.api.exportDataAsCsv(dataset);
	}
//Delete binquqntity
function deleteBinQty() {
	var totalRows = gridOptionsBlocckQty.api.getDisplayedRowCount();
		var selectedRows = gridOptionsBlocckQty.api.getSelectedRows();
		
		gridOptionsBlocckQty.api.applyTransaction({
			remove : selectedRows
			
		});
/* 	 var len = selectedRows.length;
		    $('#totalGoodsList').find('span').html(len); */
		 var len = totalRows - selectedRows.length;
         $('#totalGoodsList').find('span').html(len);
	}
	
function viewstock(rmId,bin_categoryName,bin_itemname,batch_no,mfg_date,bestbefore_date,serial_no,binquantity,unitBinStock){
	$('#myModal').modal('show');
	$("#binCategory").val(window.atob(bin_categoryName));
	$("#binQuantity").val(binquantity);
	$("#batchNoBin").val(window.atob( batch_no));
	$("#binitem").val(window.atob( bin_itemname));
	$("#manufactureDateBin").val(window.atob( mfg_date));
	$("#bestbeforeDateBin").val(window.atob(bestbefore_date));
	$("#serialNo").val(window.atob(serial_no));
	$("#unitBinStock").val(window.atob(unitBinStock));

}

function closeViewStockModal(){
	$('#myModal').modal('hide');
}

function viewBlock(rmId){
	$('#myModalViewBlock').modal('show');
	$.ajax({
		type : "GET",
		url : "goods-blocking-viewblock?rmId="+ rmId,
		success : function(response) {
		
			if (response.code == "success") {
				var jsonData = JSON.parse(response.body);
				var allData=jsonData.BlockBinData[0];
				
				var len = allData.length;
			    $("#binBlockCategory").val(allData.categoryId);
				$("#binBlockitem").val(allData.itemName);
				$("#unitBinBlock").val(allData.unitName);
				$("#binBlockQuantity").val(allData.blockQuantity);
				$("#serialNoBlock").val(allData.serial_no);
				$("#batchNoBinBlock").val(allData.batcNohBlock);
				$("#manufactureDate").val(allData.manufactureDate);
				$("#bestbeforeDate").val(allData.bestbeforeDate);
				
				
				
			}
		},
		error : function(e) {
		}
	});

}
function closeViewBlockModal(){
	$('#myModalViewBlock').modal('hide');
}
function onQuickFilterChanged() {
	$(".ti-search srchicon").hide();
	gridOptions.api
			.setQuickFilter(document.getElementById('quickFilter').value);
}
function cancelBar() {
	var id = document.getElementById("closeKey");
	id.style.display = "block";

	if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
		id.style.display = "none";
	}
}
</script>

</head>
<body>
	<div layout:fragment="content" class="maincontent">
		<div class="container-fluid">
			<div class="row">
				<div class="maincontentsec">
					<div class="content_padding">
					<div class="d-flex justify-content-between" id="reqTable"
							style="display: none;">

							<div class="btn-hs">
								<div class="font-design" id="totalBlocking">
									Goods Blocking(<span></span>)
								</div>
							</div>


							<div id="searchRowDiv">
								<div class="input-style">
									<input type="text" placeholder="Search.." name="search"
										class="searchboxinput" onkeyup="cancelBar()"
										oninput="onQuickFilterChanged()" id="quickFilter"
										autocomplete="off">
									<div class="searchicon">
										<a href="javascript:void(0)"><span
											style="display: none; border-right: 1px solid #ccc; padding-right: 5px;"
											id="closeKey"
											onclick="gridOptions.api.setQuickFilter(null);$('#quickFilter').val('');document.getElementById('closeKey').style.display='none';"
											class="close_i"><i class="ti-close srchicon"></i></span></a><a
											href="javascript:void(0)"><i class="ti-search srchicon"></i></a>
									</div>
								</div>
							</div>

							<div class="col-md-5 buttonsec btn-hs">


								<button class="btn4" id=dwnld onclick="downloadDetails()">Download</button>
								<button onclick="add()" class="btn1" id="add">New</button>
								<button onclick="deleteData()" class="delete-btn" id="deleteData">Delete</button>
								<button onclick="dispatchRequest()" class="approve-btn" id="dispatchRequest">Dispatch Request</button>
								

							</div>
						</div>
					
					
					
					
					<div id="myGrid" style="height: 500px; width: 100%;"
							class="ag-theme-alpine"></div>

						<div class="collapse" id="addData">
							<div class="innerstickybg">
								<div class="row">
									<div class="col-md-6">
										<h3>Goods Blocking</h3>
									</div>
										<div class="col-md-6" align="right">
										<button class="download-btn" id="Cancel" onClick="Cancel()">Back</button>
									</div>
								</div>
								<div class="d-flex">
									<div class="wd-10">
										<div class="form-group">
											<label>Warehouse</label>
											<div class="select">
												<select class="form-control" id="warehouseId"
													onchange="openDetails();getZoneList()">
													<!-- <option value="">--Select--</option> -->
													<option th:each="c:${locationList}" th:value='${c.key}'
														th:text="${c.name}" th:name='${c.name}'
														th:selected="${c.key==locationList}"></option>
												</select>
											</div>
										</div>
									</div>
									<div class="wd-10">
										<div class="form-group">
											<label>Zone</label>
											<div class="select">
												<select name="zone" id="zoneId" onchange="getRackList()">
													<option value="">Select</option>
												</select> <span class="focus"></span>
											</div>
										</div>

									</div>
									
									<!-- <input type="text"id="aidd" > -->
									<div class="wd-10">

										<div class="form-group">
											<label>Rack</label>
											<div class="select">
												<select name="rack" id="rackId">
													<option value="">Select</option>
												</select> <span class="focus"></span>
											</div>
										</div>

									</div>
									<div class="wd-15">

										<div class="form-group">
											<label>Category</label>
											<div class="select">
												<select id="categoryId" onblur="removeValid(event)"
													onchange="getItemList('');getFilterWarehouseData();">

													<option value="">Select</option>
													<option th:each="c,iter:${categorylist}"
														th:value="${c.key}" th:text="${c.name}"></option>
												</select>
											</div>
										</div>

									</div>

									<div class="wd-15">
										<div class="form-group">
											<label>Item/SKU</label>
											<div class="select">
												<select id="itemName" onblur="removeValid(event)" onchange="getFilterWarehouseData();">
													<option value="">Select</option>
												</select>
											</div>
										</div>
									</div>
									<div class="wd-10">
										<div class="form-group">
														<label>Unit</label>
														<div class="select">
															<select class="" id="unit" onblur="removeValid(event);">
																<option value="">Select</option>
																<option th:each="c,iter:${unitList}" th:value="${c.key}"
																	th:text="${c.name}"></option>
															</select>
														</div>
													</div>
									</div>
									
									<div class="wd-10">
													<div class="form-group">
														<label>Quantity</label> <input type="text"
															class="form-control"
															id="quantity" >
													</div>
												</div>

									<div class="wd-10">
										<div class="form-group">
											<button style="background-color: orange;" class="new-btn"
												id="goButton" onClick="getFilterWarehouseData()">Filter</button>
										</div>
									</div>
								</div>
								<div class="row"></div>
  

							</div>
							<div class="row innersticky_contentgap">

								<div id="demo_11" class="mt-5">
									<!-- show -->
									<div class="row">

										<!-- code end for second tree -->


										<div class="col-md-6">
											<div class="roomdetails roomListDiv" id="main"
												style="width: 100%; height: 500px; overflow-y: scroll;"></div>
										</div>
										<div class="col-md-6" align="right">
											<button class="approve-btn" id="blocking"
												onclick="blocking();">Blocking</button>
												
										</div>
									</div>


								</div>

							</div>



						</div>
					</div>

				</div>
			</div>
		</div>
		
		<!-- Goods block Modal -->
		
				<div class="modal fade" id="blockGoods">
					<div class="modal-dialog modal-lg" style="max-width: 900px">
						<div class="modal-content  p-5 pt-2" style="width: 100%">

							<!-- Modal Header -->
							<div class="modal-header">
								<!-- <h4 class="modal-title" style="font-size: 16px">
									<b>Goods Blocking </b>
								</h4> -->
								<div class="col-md-12" align="right">
								<button type="button" class="close" data-bs-dismiss="modal"
									aria-label="Close" onclick="closeIcon()">
									<i class="ti-close"></i>
								</button>
							</div>
							</div>
							<div class="row">
						<div class="col-md-3">
							<div class="form-group">
								<label>Category </label> <input type="text" class="form-control"
									id="binCategoryMod" readonly>
							</div>


						</div>
						<div class="col-md-3">
							<div class="form-group">
								<label>Item Name</label> <input type="text" class="form-control"
									id="binItemMod" readonly>
							</div>
						</div>

						<div class="col-md-3">
							<div class="form-group">
								<label>Item Quantity</label> <input type="text" id="quantityMod"
									class="form-control" readonly>
							</div>
						</div>
						<div class="col-md-3">
							<div class="form-group">
								<label>Unit</label> <input type="text" id="unitBinMod"
									class="form-control" readonly>
							</div>
						</div>
					</div>
							<div class="d-flex justify-content-between" id="goodsTable"
							style="display: none;">
							<div class="btn-hs mt-2">
								<div class="font-design" id="totalGoodsList">
									Total Goods List(<span></span>)
								</div>
							</div>
							
									<div class="col-md-6 buttonsec btn-hs mt-2">
										<button id="submit" class="approve-btn" onclick="submit()">Submit</button>
										<button class="delete-btn" id="deleteBinQty"
												onclick="deleteBinQty();">Delete</button>
										
									</div>
									</div>
								
							<!-- Modal body -->
							<div class="modal-body p-0"
								style="height: 390px; overflow-y: scroll;">
								<div class="vertical-line">
	                           <div id="myGridBlockQty" style="height: 200px; width: 100%;"
							                            class="ag-theme-alpine"></div>
							                                    
							                            
									<div class="row">
								<div class="col-lg-12">
									<div class="form-group">
										<label>Remarks</label>
										<textarea id="remarks" class="form-control"
											onblur="removeValid(event)"> </textarea>
									</div>
									<input type="hidden" id="blockId">
									<input type="hidden" id="requestId">
								</div>
												
									</div>

								</div>
							</div>
						</div>
					</div>
				</div>
				
				<!-- 	DispatchRequest Modal Start -->

					<div id="dispatchRequestModel" class="modal fade show" aria-modal="true">
						<div class="modal-dialog modal-confirm">
							<div class="modal-content">
								<div class="modal-header flex-column"></div>
								<div class="modal-body">
									<p>Do you want to Send Dispatch Request.</p>
								</div>
								<div class="modal-footer justify-content-center"
									style="margin-top: -30px;">
									<button type="button" class="cancel-btn" data-dismiss="modal"
										onclick="cancelDispatchRequest();">No</button>
									<button type="button" class="approve-btn"
										onclick="dispatchRequestOnclick()">Yes</button>
								</div>
							</div>
						</div>
					</div>
					
								<!-- Modal Start-->
				<div class="modal1 fade" id="myModal">
					<div class="modal-dialog modal-lg" style="max-width: 526px">
						<div class="modal-content" style="width: 100%">

							<!-- Modal Header -->
							<div class="modal-header">
								<h4 class="modal-title" style="font-size: 16px">
									<b>View Stock </b>
								</h4>
								<button type="button" class="close" data-bs-dismiss="modal"
									aria-label="Close" onclick="closeViewStockModal()">
									<i class="ti-close"></i>
								</button>
							</div>
							<!-- Modal body -->
							<div class="modal-body"
								style="height: 270px; overflow-y: scroll;">
								
								<div class="vertical-line">

										<div class="row">
												
												<div class="col-md-6">
													<div class="form-group">
														<label>Category Name</label> <input type="text"
															class="form-control"
															id="binCategory" readonly>
													</div>
													
									
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Item Name</label> <input type="text"
															class="form-control"
															id="binitem" readonly>
													</div>
												</div>
												</div>
												<div class="row">
													<div class="col-md-6">
													<div class="form-group">
														<label>Unit</label> <input type="text"
															id="unitBinStock" class="form-control" readonly> 
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Stock Quantity</label> <input type="text"
															class="form-control"
															id="binQuantity" readonly>
													</div>
												</div>
												</div>
												<div class="row">
												<div class="col-md-6">
													<div class="form-group">
														<label>Batch No.</label> <input type="text"
															class="form-control"
															id="batchNoBin" readonly>
													</div>
												</div>
												
												<div class="col-md-6">
													<div class="form-group">
														<label>Manufacture Date</label> <input type="text"
															id="manufactureDateBin" class="form-control" readonly> 
													</div>
												</div>
												</div>
												<div class="row">
												<div class="col-md-6">
													<div class="form-group">
														<label>Best Before Date</label> <input type="text"
															id="bestbeforeDateBin" class="form-control" readonly> 
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Sl No.</label> <input type="text"
															id="serialNo" class="form-control" readonly> 
													</div>
												</div>
												</div>
											
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Modal End-->
					
				<!-- Modal Start-->
					<div class="modal1 fade" id="myModalViewBlock">
					<div class="modal-dialog modal-lg" style="max-width: 526px">
						<div class="modal-content" style="width: 100%">

							<!-- Modal Header -->
							<div class="modal-header">
								<h4 class="modal-title" style="font-size: 16px">
									<b>View Block </b>
								</h4>
								<button type="button" class="close" data-bs-dismiss="modal"
									aria-label="Close" onclick="closeViewBlockModal()">
									<i class="ti-close"></i>
								</button>
							</div>
							<!-- Modal body -->
							<div class="modal-body"
								style="height: 270px; overflow-y: scroll;">
								
								<div class="vertical-line">

										
												<div class="row">
												<div class="col-md-6">
													<div class="form-group">
														<label>Category Name</label> <input type="text"
															class="form-control"
															id="binBlockCategory" readonly>
													</div>
													
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Item Name</label> <input type="text"
															class="form-control"
															id="binBlockitem" readonly>
													</div>
												</div>
												</div>
												<div class="row">
												<div class="col-md-6">
													<div class="form-group">
														<label>Unit</label> <input type="text"
															id="unitBinBlock" class="form-control" readonly> 
													</div>
												</div>
												
												<div class="col-md-6">
													<div class="form-group">
														<label>Block Quantity</label> <input type="text"
															class="form-control"
															id="binBlockQuantity" readonly>
													</div>
												</div>
												</div>
												<div class="row">
												<div class="col-md-6">
													<div class="form-group">
														<label>Batch No.</label> <input type="text"
															class="form-control"
															id="batchNoBinBlock" readonly>
													</div>
												</div>
												<div class="col-md-6">
										<div class="form-group">
											<label>Manufacture Date</label> <input type="text"
												id="manufactureDate" class="form-control" readonly>
										</div>
									</div>
									</div>
									<div class="row">
									<div class="col-md-6">
										<div class="form-group">
											<label>Best Before Date</label> <input type="text"
												id="bestbeforeDate" class="form-control" readonly>
										</div>
									</div>
											
												<div class="col-md-6">
													<div class="form-group">
														<label>Sl No.</label> <input type="text"
															id="serialNoBlock" class="form-control" readonly> 
													</div>
												</div>
												</div>
											
								</div>
							</div>
						</div>
					</div>
				</div>
	
				<!-- Modal End-->
					
		
	</div>
</body>
</html>