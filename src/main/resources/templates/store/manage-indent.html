<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/master}">
<head>
<style type="text/css">
.highcharts-exporting-group {
	display: none;
}

.autocomplete {
	position: relative;
	display: inline-block;
	width: 100%;
}

.sugg-cls ul {
	height: 150px;
	overflow-x: scroll;
	position: relative;
}

ul#autocomplete-list1 {
	position: relative;
	z-index: 999;
}

ul#autocomplete-list1 li {
	position: relative;
	color: #fff;
	padding-left: 6px;
	background-color: #1f57a8;
	border-bottom: solid 1px #6189c2;
	padding-top: 5px;
	padding-bottom: 5px;
}

a.addCust {
	color: #fff;
}

.slidebox {
	padding: 14px;
	margin-top: 0px;
	margin: 0px 10px;
}

/* .form-group label {
	font-size: 12px;
	position: relative;
	top: 4px;
} */
.holdCls {
	background-color: rgb(0, 143, 0);
}

.bg_white {
	background: #ffffff !important;
}
</style>
<script type="text/javascript">
	function openNav() {
		document.getElementById("mySidenav").style.cssText = "width: 350px; position: absolute; right:-10px; overflow: hidden; height:auto; top:203px;";

		document.getElementById("main_content").style.width = "70%";
		document.getElementById("gstCalS").style.width = "70%";
		$("#save1").hide();
	}

	function closeNav() {
		document.getElementById("mySidenav").style.width = "0";
		document.getElementById("main_content").style.width = "100%";
		document.getElementById("gstCalS").style.width = "100%";
		
		$("#sku").val('');
		$("#itemId").val('');
		$("#itemName").val('');
		$("#quantity").val('');
		$("#model").val('');
		$("#hsnCode").val('');
		$("#unit").val('');
		$("#stock").val('');
		$("#stockForDays").val('');
		$("#editProduct").val(null);
		if($("#astatus").val()=='Approved'){
			$("#save1").hide();
		}
		else{
			$("#save1").show();
		}
	}

	var count1 = 0;
	function allCheck1() {
		count1++;

		if (count1 == 1) {
			$('.checkCls1').prop("checked", true);
		} else {
			count1 = 0;
			$('.checkCls1').prop("checked", false);
		}
	}

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#searchBar').val() == null || $('#searchBar').val() == "") {
			id.style.display = "none";
		}
	}
</script>

<script type="text/javascript">
	$(document).ready(function() {
		//changeOpt();
		$("#documentDetails").show();
		$('#docTbl').on('click', '.rmv1', function() {
		openDeleteConfirm();
	    var value = $(this).parent("div").attr("id");
	$("#dltValue").val(value);});
		$("#statusDiv").hide();
		$('#reqDltBtn').attr('disabled', true);
		$('#reqCopyBtn').attr('disabled', true);
		$('#reqAppvBtn').attr('disabled', true);
		$('#reply').attr('disabled', true);
		$('.collapse').on('show.bs.collapse', function() {
			$(this).siblings('.panel-heading').addClass('active');
		});
		$('.collapse').on('hide.bs.collapse', function() {
			$(this).siblings('.panel-heading').removeClass('active');
		});
		 agGrid.simpleHttpRequest({
				url : 'store-indent-through-ajax'
			}).then(function(data) {
				var len = data.length;
				$('#totalReq').find('span').html(len);
				gridOptions.api.setRowData(data);
			});
		$("#newBtn").click(function() {
			$("#myGrid").hide();
			$("#reqTable").hide();
			$(".btn-hs").hide();
			$("#demo").show();
		})
		
		var dateFormat = localStorage.getItem("dateFormat");
							$("#receiveDateCalendar1").datetimepicker({
								format : 'd-m-Y',
								closeOnDateSelect : true,
								timepicker : false,
								datepicker : true,
								scrollMonth : false,
								
							}).on("change", function() {
								$('#receiveDate').val($(this).val());
							})
							$('#receiveDate').blur(function() {
								$("#receiveDateCalendar1").val($(this).val());
							})
		/* 
		 $("#copyBtn").click(function() {
		 $("#myGrid").hide();
		 $("#reqTable").hide();
		 $(".btn-hs").hide();
		 $("#demo").show();
		 }) */

		$("#quarter").click(function() {
			$("#myTbl").hide();
			$(".btn-hs").hide();
			$("#demo").show();
		})

		$("#receiveDate").datetimepicker({
			format : 'd-m-Y',
			closeOnDateSelect : true,
			timepicker : false,
		})

		/* $("#browseBtn").click(function() {
			$("#myModal").modal('show');
			getCategoryList();
		}) */
		$("#browseBtn").click(function() {
							$("#itemName").val(null);
							$("#hsnCode").val(null);
							$("#unit").val(null);
							$("#itemNameTemp").val(null);
							$("#hsnCodeTemp").val(null);
							$("#unitTemp").val(null);
							$("#suggesstion-box_").hide();
							$("#myModal").modal('show');

						})
						
								$("#browseBtn")
								.click(
										function() {
											$(".benefitChk").prop("checked",
													false);
											$("#productModName").val("");
											$("#brand").val("");
											$("#skuMod").val("");
											$("#modelMod").val("");
											$("#manufactureItemMod").val("");
											$("#variationTypeMod").val("");
											$("#variationValueMod").val("");
											$("#unitMod").val("");
											$("#productCategoryCBDiv").empty();
											$("#select_product").empty();
											$('.loader').show();
											$("body").addClass("overlay");
											$("#productDiv").modal("show");
											$
													.ajax({
														type : "POST",
														url : "purchase-requisition-item-get-product-list",
														dataType : "json",
														contentType : "application/json",
														data : "a",
														success : function(
																response) {
															if (response.message == "success") {
																for (var i = 0; i < response.body.length; i++) {
																	var row = "";
																	if (response.body[i].categoryId == response.body[i].parentId) {
																		if (response.body[i].nodeCount > 0) {

																			row = '<tr data-node-id="'+response.body[i].categoryId+'" class="abc" id="'+response.body[i].categoryId+'">'
																					+ '<td class="firstnode" id=lbl_'+response.body[i].categoryId+'>'
																					+ response.body[i].categoryName
																					+ '</td></tr>';
																		} 
																		else 
																		{
																			
																			row = '<tr data-node-id="'+response.body[i].categoryId+'" class="abc" id="'+response.body[i].categoryId+'">'
																					+ '<td class="firstnode" id=lbl_'+response.body[i].categoryId+'><input class="benefitChk pc1-box" type="checkbox" id="ccCheck_'
																					+ response.body[i].categoryId
																					+ '" value="'
																					+ response.body[i].categoryId
																					+ '" name="'
																					+ response.body[i].categoryName
																					+ '" onchange=selectCheckBox("'
																					+ response.body[i].categoryId
																					+ '","'
																					+ response.body[i].catLevel
																					+ '")>'
																					+ response.body[i].categoryName
																					+ '</td></tr>';
																					
																			
																		}
																		
																		

																	} else {
																		if (response.body[i].nodeCount > 0) {
																			row = '<tr data-node-id="'+response.body[i].categoryId+'" data-node-pid="'+response.body[i].parentId+'" class="abc" id="'+response.body[i].categoryId+'">'
																					+ '<td class="firstnode" id=lbl_'+response.body[i].categoryId+'>'
																					+ response.body[i].categoryName
																					+ '</td></tr>';
																		} else {

																			row = '<tr data-node-id="'+response.body[i].categoryId+'" data-node-pid="'+response.body[i].parentId+'" class="abc" id="'+response.body[i].categoryId+'">'
																					+ '<td class="firstnode" id=lbl_'+response.body[i].categoryId+'><input class="benefitChk pc1-box" type="checkbox" id="ccCheck_'
																					+ response.body[i].categoryId
																					+ '" value="'
																					+ response.body[i].categoryId
																					+ '" name="'
																					+ response.body[i].categoryName
																					+ '" onchange=selectCheckBox("'
																					+ response.body[i].categoryId
																					+ '","'
																					+ response.body[i].catLevel
																					+ '")>'
																					+ response.body[i].categoryName
																					+ '</td></tr>';
																		}
																	}
																	$(
																			"#productCategoryCBDiv")
																			.append(
																					row);

																}

																$('.loader')
																		.hide();
																$("body")
																		.removeClass(
																				"overlay");

																$('#basic')
																		.simpleTreeTable(
																				{
																					expander : $('#expander'),
																					collapser : $('#collapser'),
																					store : 'session',
																					storeKey : 'simple-tree-table-basic'
																				});
															}
														},
														error : function(data) {
															//console.log(data)
															$('.loader').hide();
															$("body")
																	.removeClass(
																			"overlay");
															$("#productDiv")
																	.modal(
																			"show");
														}
													});
										})
					var ld = localStorage.getItem('ReqRFQData1');
						var data = JSON.parse(ld);
						console.log(data)
						if (data) {
							//switchPage();
							$("#myGrid").hide();
		                       $("#searchRowDiv").hide();
		                        $("#reqTable").hide();
		                         $("#totalReq").hide();
		                       $(".btn-hs").hide();
		                        $("#demo").show();
							$("#reqHeadId").html();
							$("#reqId").val(data[0].reqId);
							$("#project").val(data[0].project);
							productOptions.api.setRowData(data);
							
							localStorage.setItem('ReqRFQData1', null);
						} else {
							$("#indentId").val('New');
						}		
			

	});

	$("input[class='myCheckbox']").click(function() {
		if ($("#formID input:checkbox:checked").length > 0) {
			$(".checkSubmit").addClass('active');
		} else {
			$(".checkSubmit").removeClass('active');
		}
	});

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
			id.style.display = "none";
		}
	}
</script>

<script>
	var columnDefs = [
			{
			//	headerCheckboxSelection : true,
				headerCheckboxSelectionFilteredOnly : true,
				checkboxSelection : true,
				sortable : false,
				filter : false,
				resizable : true,
				width : 20
			},
			{
				headerName : "Indent Id",
				field : "indentId",
				cellRenderer : function(params) {
					return '<a onclick=editIndent("' + params.data.indentId
					+','+params.data.aprroveStatus + '") href="javascript:void(0)">'
							+ params.data.indentId + '</a>';
				}

			}, {
				headerName : "Department",
				field : "deptName",
				hide : "true"
			},
			{
				headerName : "Department Id",
				field : "deptId",
				hide : "true"
			}, 
			{
				headerName : "Purpose",
				field : "desc",
				width : 205,
			},  {
				headerName : "Receive By Date",
				field : "receiveDate",
				cellStyle : {
					textAlign : 'center'
				}

			}, {
				headerName : "Status",
				field : "aprroveStatus",
				cellStyle : {
					textAlign : 'center'
				},
				cellRenderer : function(params) {
					if (params.data.aprroveStatus =="Pending") { 
						return '<div style="color:#a9a9a9">Pending</div>';
					} else {
						return '<div style="color:#0642f5">Approved</div>';
					} 	
				}
			}, {
				headerName : "Created By",
				field : "createdBy",
					cellStyle : {
						textAlign : 'center'
					}
			},
			{
				headerName : "Project",
				field : "project",
				width : 190,
				//hide : "true"
			},
			{
				headerName : "Current Reply ",
				field : "current",
				width : 190,
				hide : "true"
			},
			{
				headerName : "Previous Reply",
				field : "previous",
				width : 190,
				hide : "true"
			},
			{
				headerName : "Created Date",
				field : "updatedOn",
				width : 175,
				cellStyle : {
					textAlign : 'center'
				}

			} ];

	// for product table

	var productDefs = [
			{
				headerCheckboxSelection : true,
				headerCheckboxSelectionFilteredOnly : true,
				checkboxSelection : true,
				sortable : false,
				filter : false,
				resizable : true,
				width : 20
			},
			{
				headerName : "SlNo",
				field : "slNo",
				width : 70,
				cellRenderer : function(params) {
					if (params.data.slNo) {
						return '<a onclick=editProduct("' + params.data.slNo
								+ '") href="javascript:void(0)"><i class="bi bi-arrow-return-right">'
								+ params.data.slNo + '</a>';
					} else {
						return '<a onclick=editProduct("' + params.data.slNo
								+ '") href="javascript:void(0)"><i class="bi bi-arrow-return-right">'
								+ params.data.slNo + '</a>';
					}
				}
			},
			{
				headerName : "SKU",
				field : "sku",
				cellStyle : {
					textAlign : 'center'
				}
			}, {
				headerName : "HSN CODE",
				field : "hsnCode",
				cellStyle : {
					textAlign : 'center'
				}
			},
			{
				headerName : "Name",
				field : "itemName",
				width : 275,

			}, {
				headerName : "itemId",
				field : "itemId",
				hide : "true"
			},{
				headerName : "Model/Size",
				field : "model",
				cellStyle : {
					textAlign : 'center'
				}

			}, {
				headerName : "locationId",
				field : "locationId",
				hide : "true"

			}, {
				headerName : "Department",
				field : "deptName",
				hide : "true"

			}, {
				headerName : "deptId",
				field : "deptId",
				hide : "true"
			}, {
				headerName : "Quantity",
				field : "quantity",
				cellStyle : {
					textAlign : 'center'
				}

			}, {

				headerName : 'Unit',
				field : "unitName",
				width : 175,
				cellStyle : {
					textAlign : 'center'
				}
			}, {
				headerName : 'Unit',
				field : "unit",
				hide : true,

			}, {
				headerName : 'Stock',
				field : "stock",
				width : 175,
				cellStyle : {
					textAlign : 'center'
				}
			}, {
				
				headerName : 'Stock For Days',
				field : "stockForDays",
				width : 175,
				cellStyle : {
					textAlign : 'center'
				}
			
				
			}, ];


	// let the grid know which columns and what data to use activity table
	var productOptions = {
		columnDefs : productDefs,
		rowSelection : 'multiple',
		groupSelectsChildren : true,
		suppressRowClickSelection : true,
		suppressAggFuncInHeader : true,
		defaultColDef : {
			sortable : true,
			filter : true,
			resizable : true,
			width : 153
		},
		onSelectionChanged : onSelectionChangedItem,
		getRowNodeId : function(data) {
			return data.slNo;
		}

	};

	// let the grid know which columns and what data to use
	var gridOptions = {
		columnDefs : columnDefs,
		rowSelection : 'single',
		groupSelectsChildren : true,
		suppressRowClickSelection : true,
		suppressAggFuncInHeader : true,
		defaultColDef : {
			sortable : true,
			filter : true,
			resizable : true,
			width : 153
		},
		onSelectionChanged : onSelectionChanged,

	};

	// setup the grid after the page has finished loading
	document.addEventListener('DOMContentLoaded', function() {
		var gridDiv = document.querySelector('#myGrid');
		new agGrid.Grid(gridDiv, gridOptions);

		var gridDiv = document.querySelector('#product');
		new agGrid.Grid(gridDiv, productOptions);


	});

	

	function resetState() {
		gridOptions.columnApi.resetColumnState();

	}

	function onQuickFilterChanged() {
		gridOptions.api
				.setQuickFilter(document.getElementById('quickFilter').value);
	}
	function cancel(){
		 $("#searchRowDiv").show();
		$("#reqTable").show();
		$(".btn-hs").show();
		$("#myGrid").show();
		$("#demo").hide();
		agGrid.simpleHttpRequest({
			url : 'store-indent-through-ajax'
		}).then(function(data) {
			var len = data.length;
			$('#totalReq').find('span').html(len);

			gridOptions.api.setRowData(data);
		});
		$("#desc").val('');
		$("#reqType").val('');
		$("#reqPrior").val('');
		$("#receiveDate").val('');
		$("#isHold").val('');
		$("#source").html('');
		//$("#rfqId").val(rfqId);
		$("#indentHeadId").html('');
		$("#createdDate").append('');
		$("#sku").val('');
		$("#skuEditId").val('');
		$("#itemId").val('');
		$("#itemName").val('');
		$("#locationId").val('');
		$("#quantity").val('');
		$("#unit").val('');
		 
		$("#search").val('');
	}
	function onSelectionChanged() {
		var selectedRows = gridOptions.api.getSelectedRows();
		var rowCount = 0;
		selectedRows.forEach(function(selectedRow, index) {
			rowCount = rowCount + 1;
		});
		var selectedNodes = gridOptions.api.getSelectedNodes();
		 var selectedData = selectedNodes.map(node => node.data);
		 var approveStatus= selectedData.map(node => node.aprroveStatus);
		if (rowCount > 0) {
			if(approveStatus=="Pending"){
				$('#reqDltBtn').attr('disabled', false);
				$('#reqAppvBtn').attr('disabled', false);
				$('#newBtn').attr('disabled', true);
				$('#reply').attr('disabled', true);
			}else{
				$('#reqDltBtn').attr('disabled', true);
				$('#reqAppvBtn').attr('disabled', true);
				$('#newBtn').attr('disabled', true);
				$('#reply').attr('disabled', false);
			}
		} else {
			$('#reqDltBtn').attr('disabled', true);
			$('#reqAppvBtn').attr('disabled', true);
			$('#newBtn').attr('disabled', false);
			$('#reply').attr('disabled', true);
		}

	}
	
	function onSelectionChangedItem() {
		var selectedRows = productOptions.api.getSelectedRows();
		var rowCount = 0;
		selectedRows.forEach(function(selectedRow, index) {
			rowCount = rowCount + 1;
		});
		var selectedNodes = productOptions.api.getSelectedNodes();
		 var selectedData = selectedNodes.map(node => node.data);
		// var approveStatus= selectedData.map(node => node.approveStatus);
		if (rowCount > 0) {
			$('#rfq').attr('disabled', false);
			$('#addProduct').attr('disabled', true);
			$('#dltProduct').attr('disabled', false);
		} else {
			$('#rfq').attr('disabled', true);
			$('#addProduct').attr('disabled', false);
			$('#dltProduct').attr('disabled', true);
		}

	}
	function switchPage() {
		// getDeptList();
		$("#gstCalS").show();
		$("#accordionExample2").show();
		$("#astatus").val(" ");
		var selectedRows = gridOptions.api.getSelectedRows();
		var selectedRowsString = '';
		selectedRows.forEach(function(selectedRow, index) {
			if (index > 0) {
				selectedRowsString += ',';
			}
			selectedRowsString += selectedRow.itemId;
		});
		$("#save1").show();
		$("#addProduct").show();
		$("#dltProduct").show();
		$('#dltProduct').attr('disabled', true);
		// for product table
		agGrid.simpleHttpRequest({
			url : 'view-requisition-item-trough-ajax?id=' + selectedRowsString
		}).then(function(data) {
			productOptions.api.setRowData(data);
		});
		
		$("#deptId").val('');
	    $("#searchRowDiv").hide();
	    $("#reqPrior").val('');
	    $("#reqType").val('');
	    $("#rfq").hide();
	    productOptions.api.setRowData('');
	    $('#dltProduct').attr('disabled', true);
	    $("#doctbodyData").empty();
		var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
				+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
				+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_"></div></td>'
				+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
				+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
				+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" ></div><input type="hidden" id="editId_0></td>'
				+ '</tr>';
		$("#doctbodyData").append(tbl);
	}
	// for edit indivisual product
	function editProduct(slNo) {

		var indentId = $("#indentHeadId").html();
		var rowNode = productOptions.api.getRowNode(slNo);
      
		$("#sku").val(rowNode.data.sku);
		//$("#skuEditId").val(prodId);
		$("#itemId").val(rowNode.data.itemId);
		$("#hsnCode").val(rowNode.data.hsnCode);
		$("#itemName").val(rowNode.data.itemName);
		$("#model").val(rowNode.data.model);
		$("#editProduct").val(slNo);
		$("#stock").val(rowNode.data.stock);
		$("#stockForDays").val(rowNode.data.stockForDays);
		$("#quantity").val(rowNode.data.quantity);
		$("#unit").val(rowNode.data.unit);
		$("#unitPrice").val(rowNode.data.unitPrice);
		$("#skuTemp").val(rowNode.data.sku);
		$("#lineTotal").val(rowNode.data.lineTotal);
		$("#itemIdTemp").val(rowNode.data.itemId);
		//$("#unitName").val(rowNode.data.unitName);
		openNav();

	}

	function editIndent(id) {
		var data = id.split(",");
		var indentId= data[0];
		var approveStatus = data[1];
		$("#myGrid").hide();
		$("#searchRowDiv").hide();
		$("#reqTable").hide();
		$(".btn-hs").hide();
		$("#demo").show();
		$("#rfq").attr('disabled', true);
		$("#astatus").val(approveStatus);
		if(approveStatus=='Pending'){
			$("#save1").show();
			$("#addProduct").show();
			$("#dltProduct").show();
			$("#dltProduct").attr('disabled', true);
		}
		else{
			$("#dltProduct").hide();
			$("#addProduct").hide();
			$("#save1").hide();
		}
		$('.loader').show();
		$("body").addClass("overlay");
		agGrid.simpleHttpRequest({
			url : 'store-indent-edit-new?id=' + indentId
		}).then(function(data) {

			$("#desc").val(data[0].desc);
			$("#deptId").val(data[0].deptId);
			$("#deptName").val(data[0].deptName);
			$("#receiveDate").val(data[0].receiveDate);
			$("#indentId").val(data[0].indentId);
			$("#indentHeadId").html(data[0].indentId);
			productOptions.api.setRowData(data);
			$("#doctbodyData").empty();

			if (data[0].documentList != null
					&& data[0].documentList != "") {

				for (var i = 0; i < data[0].documentList.length; i++) {


					var tbl = '<tr>'
							+ '<td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
							+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option>  </select> </div></td>'
							+ '<td><div class="form-group"> <input type="text" value="'+data[0].documentList[i].documnentName+'" class="form-control docNoclss" id="docnoid_'+i+'"> </div></td>'
							+ '<td><div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_'+i+'" id="uploadFor_'+i+'"> <i class="ti-pencil" id="clickImg_'+i+'"></i> </label>'
							+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_'
							+ i
							+ '"name="userImage" onchange="saveMultiFile(event)" /> </div>'
							+ '</div> <input type="hidden" id="uploadHidden_'+i+'" value="'+data[0].documentList[i].fileName+'" class="uploadHidCls">'
							+ '<div id="uploadedBillDiv_'+i+'" align="center" class="uploadedBillCls"><div class="uploadicon position-l">'
							+ data[0].documentList[i].action
							+ '</div></div>'
							+ '<div id="imageName_'+i+'" class="imageName">'
							+ data[0].documentList[i].fileName
							+ '</div>'
							+ '<input type="hidden" id="editId_'+i+'" value="'+ data[0].documentList[i].vendorRfqId+'">'
							+ '<div id="dltImage_'+i+'" class="custom-file-delete"><i class="ti-close position-l rmv1" onclick="openDeleteConfirm()"></i></div> </td>'
							+ '</tr>';

					$("#doctbodyData").append(tbl);
				}
			} else {
				var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
						+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
						+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_"></div></td>'
						+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
						+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
						+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" ></div><input type="hidden" id="editId_0></td>'
						+ '</tr>';
				$("#doctbodyData").append(tbl);
			}

			putOnHold();
			headerStatus();
			$('.loader').hide();
			$("body").removeClass("overlay");
		});

		
	}

	
	function rfq() {
		var selectedRows = productOptions.api.getSelectedRows();
		var selectedRowsString = '';
		var sku = "";
		for (var i = 0; i < selectedRows.length; i++) {
			sku = sku + '"' + selectedRows[i].sku + '",';
		}
		sku = sku.substring(0, sku.length - 1);
		var id = $("#indentHeadId").html();
		if (sku) {
			sessionStorage.setItem('activity', 'ACT0222');
			
			agGrid.simpleHttpRequest({
				url : 'view-requisition-get-RFQdata?id=' + id + "&sku=" + sku
			}).then(function(data) {
				localStorage.setItem('ReqRFQData', JSON.stringify(data));
				productOptions.api.setRowData(data);
				window.location.href = "/purchase/view-purchase-quotation"
			});
		} else {
			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
		}
	}

	function deleteFun() {
		$('#delete').modal('show');
	}
	function deleteProduct() {
		$('#deleteProduct').modal('show');
	}
	function deleteProductIndConfirm() {
		$('#deleteProductInd').modal('show');
	}
	// deleting ind product
	/* function deleteProductInd() {
		var editProduct = $("#editProduct").val();
		if (editProduct) {
			productOptions.api.applyTransaction({
				remove : [ productOptions.api.getRowNode(editProduct).data ]
			});
			closeNav();
			$("#sku").html('');
			$("#skuEditId").html('');
			$("#brandId").val('');
			$("#brandName").html('');
			$("#itemId").html('');
			$("#itemName").html('');
			$("#locationId").val('');
			$("#quantity").val('');
			$("#uom").val('');
			$("#estimatedPrice").val('');
			$("#totalEstPrc").val('');
			$("#lastPurchaseUnitPrice").val('');
			$("#lastPurchaseTotalPrice").val('');
			$("#search").val('');
			$("#editProduct").val(null);
		}

	} */
	// delete requisition 
	function deleteOnclick() {

			var selectedRows = gridOptions.api.getSelectedRows();
		 var id=selectedRows[0].indentId;
		
		
			$.ajax({
				type : "POST",
				url : "store-indent-delete?id="+ id,
				success : function(response) {
				 if (response.message == "Success") {
					
					 $('#delete').modal('hide');

						$('#reqDltBtn').attr("disabled", true);
						$('#newBtn').attr("disabled", false);
						$('#reqAppvBtn').attr("disabled", true);
						agGrid.simpleHttpRequest({
							url : 'store-indent-through-ajax'
						}).then(function(data) {
							var len = data.length;
							$('#totalReq').find('span').html(len);
							gridOptions.api.setRowData(data);
							//console.log(JSON.stringify(data))
						});
						
					} else {

					}
				},
				error : function(data) {
					console.log(data)
				}
			})
		}
	// delete selected record from ag grid
	function deleteProductOnclick() {
		var selectedRows = productOptions.api.getSelectedRows();
		productOptions.api.applyTransaction({
			remove : selectedRows
		});
		cancelModalProductBtn();

	}

	function cancelModalBtn() {
		$("#deleteProduct").modal("hide");
	}
	//for closeing modal box for dlt  product
	function cancelModalProductBtn() {
		$("#deleteModalBtn").removeAttr("disabled");
		$('#deleteProduct').modal('hide');
	}
	//for closeing modal box for dlt ind product
	function cancelModalBtnDPI() {
		$('#deleteProductInd').modal('hide');
	}
	function approveIndent() {
		$('#approvePQtn').modal('show');
	}

    function cancelApproveModalBtn() {
		$('#approvePQtn').modal('hide');
	}	
	  function approveOnclick() {
			
			var selectedRows = gridOptions.api.getSelectedRows();
			var selectedRowsString = '';
			selectedRows.forEach(function(selectedRow, index) {
				if (index > 0) {
					selectedRowsString += ',';
				}
				selectedRowsString += selectedRow.indentId;
			});
			var indentId = selectedRowsString;
			
			var approveStatus = 1;
			$('#approvePQtn').modal('show');
			$('.loader').show();
		$.ajax({
			type : "GET",
			url : "store-indent-approve-th-ajax?approveStatus=" + approveStatus + "&indentId=" + indentId ,
			async : false,
			success : function(response) {
				if (response.message == "Success") {
					$('.loader').hide();
					$("#messageParagraph").text("Indent Approved Successfully");
					$("#msgOkModal").removeClass("btn3");
					$("#msgOkModal").addClass("btn1");
					$("#msgModal").modal('show');
					
					$('#newBtn').attr("disabled", false);
					$('#reqDltBtn').attr("disabled", true);
					$('#reqAppvBtn').attr("disabled", true);
					
					$('#approvePQtn').modal('hide');
					$("#total").show();
					$("#totalCandidate").show();
					$("#btndiv").show();

					//$("#reqTable").show();
					$('#dwnld').show();
					$("#addData").hide();
					$("#myGrid").show();
					$("#searchRowDiv").show();
					$("#reqTable").show();
					agGrid.simpleHttpRequest({
						url : "store-indent-through-ajax"
					}).then(function(data) {
						var len = data.length;
						$('#totalReq').find('span').html(len);
						gridOptions.api.setRowData(data);
					});
					
				}else{
					$('.loader').hide();
					$('#approvePQtn').modal('show');
				}
				
			},
			error : function(data) {
			}
		});
	}	
</script>
<script type="text/javascript">
	// for stock graph  report 
	function stockReport() {
		$('.loader').show();
		var selectedRows = productOptions.api.getSelectedRows();
		var selectedRowsString = '';
		selectedRows.forEach(function(selectedRow, index) {
			if (index > 0) {
				selectedRowsString += ',';
			}
			selectedRowsString += selectedRow.itemId;
		});

		if (selectedRowsString) {

			$('#lineGraph').modal('show');
			$
					.ajax({
						type : "GET",
						url : "/inventory/view-stock-daily-report?id="
								+ selectedRowsString,
						dataType : 'json',
						data : selectedRowsString,
						success : function(response) {
							$('.loader').hide();
							if (response.message == "success") {
								$("#graphTable").empty();
								lineGrapg(response.body.dataList,
										response.body.dates, 'Stock');
								var tableHeader = '<tr>';
								for (var i = 0; i < response.body.dates.length; i++) {

									tableHeader = tableHeader + '<td>'
											+ response.body.dates[i] + '</td>';
								}
								tableHeader = tableHeader + '</tr>';
								$("#graphTable").append(tableHeader);

								for (var i = 0; i < response.body.dataList.length; i++) {
									var tableBody = '<tr><td>'
											+ response.body.dataList[i].name
											+ '</td>';
									for (var j = 0; j < response.body.dataList[i].data.length; j++) {
										tableBody = tableBody
												+ '<td>'
												+ response.body.dataList[i].data[j]
												+ '</td>';
									}
									tableBody = tableBody + '</tr>';
									$("#graphTable").append(tableBody);
								}

							}
						},
						error : function(data) {
							console.log(data);
							$('.loader').hide();
						}
					})
		} else {
			swal("Please Select At least One Product.");
		}

	}
	// get excel report
	function getExcelReport() {
		var selectedRows = productOptions.api.getSelectedRows();
		var selectedRowsString = '';
		selectedRows.forEach(function(selectedRow, index) {
			if (index > 0) {
				selectedRowsString += ',';
			}
			selectedRowsString += selectedRow.itemId;
		});

		window.location.href = "/inventory/view-stock-daily-report-excel?id="
				+ selectedRowsString;
	}
</script>

<script>
function saveTableData() {
	  var item = {};
		var data = 1;
		var validation = true;
		var editProduct = $("#editProduct").val();
		if (item.itemName == null || item.itemName == "") {
			validation = validationUpdated("Item Name Required", 'itemName');
		}
		if (item.quantity == null || item.quantity == "") {
			validation = validationUpdated("Quantity Required", 'quantity');
		}

		if (validation) {
			item.slNo = data;	
			productOptions.api.forEachNode(function(rowNode, index) {
				if (!editProduct) {
					data = data + 1;
					item.slNo = data;
				}
				else{
					item.slNo = editProduct;
				}
				
			});
			item.itemId = $('#itemIdTemp').val();
			item.sku = $('#skuTemp').val();
			item.itemName = $('#itemName').val();
			item.hsnCode = $('#hsnCode').val();
			item.model = $("#model").val();
			item.quantity = $("#quantity").val();
			item.unit = $('#unit').val();
			item.unitName =$("#unit option:selected").text();
			item.stock = $("#stock").val();
			item.stockForDays = $("#stockForDays").val();
			var datas = [];
			if (editProduct) {
				var rowNode = productOptions.api.getRowNode(editProduct);
				rowNode.setData(item);
			} else {
				productOptions.api.forEachNode(function(rowNode, index) {
					datas.push(rowNode.data);
				});
				datas.push(item)
				productOptions.api.setRowData(datas);
			}
			closeNav();
			$("#sku").al('');
			$("#skuEditId").html('');
			$("#itemId").val('');
			$("#itemName").val('');
			$("#model").val('');
			$("#quantity").val('');
			$("#unit").val('');
			$("#search").val('');
			$("#editProduct").val(null);
		}

	}


	function validFormData() {
		var allValid = true;

		if (!validationUpdated("Department Required", 'deptId'))
			allValid = false;
		if (!validationUpdated("Expected Receive Date Required",
				'receiveDate'))
			allValid = false;
		return allValid;
	}

	function validProductData() {
		var item = null;
		productOptions.api.forEachNode(function(rowNode, index) {
			item = item + rowNode.data;
		});
		if (item) {
			return true;
		} else {
			$("#messageParagraph").text("Please Add Item Details");
			$("#msgOkModal").removeClass("btn3");
			$("#msgOkModal").addClass("btn1");
			$("#msgModal").modal('show');
			return false;
		}
	}
	function saveData() {
		// if (validFormData() && validProductData()) {
			var datas = [];
			var imageValid = true;
			var uploadList = [];
			$("#doctbodyData > tr").each(
					function() {
						var uFile = $(this).find(".document")[0].files[0];
						var fileName = $(this).find(".document").val();
						var data = [];
						var x = [];
						if (fileName != '' && fileName != 'undefined'
					 			&& fileName != null) {
							var lastIndex = fileName.lastIndexOf("\\");
							if (lastIndex >= 0) {
								fileName = fileName.substring(lastIndex + 1);
							}
							var reader = new FileReader();
							reader.readAsDataURL(uFile);

							reader.onload = function() {
								data = reader.result.split(",");
								x.push(data[1]);
							};
						} else {
							if ($("#indentId").val()) {
								fileName = $(this).find(".uploadHidCls").val();
							} else {
								x = [];
							}

						}
						uploadData = {};
						uploadData['indentId'] = $("#indentId").val();
						uploadData['documnentName'] = $(this)
								.find(".docNoclss").val();
						uploadData['documentFile'] = x;
						uploadData['fileName'] = fileName;
						uploadData['imageNameEdit'] = $(this).find(".uploadHidCls").val();
						/* if($(this).find(".docNoclss").val()!="" && $(this).find(".docNoclss").val()!='null' && fileName!="" && fileName!="null"){
							uploadList.push(uploadData);
							console.log(uploadData)
							
						} */
						uploadList.push(uploadData);
						console.log(uploadData)
							console.log('DOC', uploadData)
					});
			setTimeout(function() {

				productOptions.api.forEachNode(function(rowNode, indrx) {

					var item = rowNode.data;
					item.desc = $("#desc").val();
					item.deptId = $("#deptId").val();
					item.deptName = $("#deptId").find('option:selected').text();
					item.project = $("#project").val();
					item.projectName = $("#project").find('option:selected').text();
					item.receiveDate = $("#receiveDate").val();
					item.indentId = $("#indentHeadId").html();
					item.reqId = $("#reqId").val();
					item.documentList = uploadList;
					console.log('Object', item)
					datas.push(item);

				});
				saveAllIndent(datas);

			}, 1000)

		//}
	}
	function saveAllIndent(datas) {
		$('.loader').show();
		$("body").addClass("overlay");
						$.ajax({
							type : "POST",
							url : "store-indent-add",
							contentType : "application/json",
							data : JSON.stringify(datas),
							success : function(response) {
						if (response.message == "Success") {
							$('.loader').hide();
							$("body").removeClass("overlay");
							$("#messageParagraph").text("Data Saved Successfully");
							$("#msgOkModal").removeClass("btn3");
							$("#msgOkModal").addClass("btn1");
							$("#msgModal").modal('show');
							//$(".btn-hs").show();
							cancel();
						}

					},
					error : function(datas) {
						console.log(datas)
					}
				})

	}

	
	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
			id.style.display = "none";
		}
	}
	function getProductList() {
		var search = $("#search").val();
		if (search) {

			$
					.ajax({
						type : "POST",
						url : "view-requisition-get-product-list",
						dataType : 'json',
						contentType : 'application/json',
						data : search,
						success : function(response) {
							if (response.message == "success") {

								if (response.body.length != 0) {
									$("#search").css("background", "#FFF");
									var content = '<ul id="autocomplete-list1" style="margin-left:-40px; font-weight:100; font-size:14px; color:#ccc;">';
									for (var i = 0; i < response.body.length; i++) {
										content += '<li class="autocompletedata cp" onClick="selectAutocompleteValue1(\''
												+ response.body[i].itemId
												+ '\',\''
												+ response.body[i].itemName
												+ '\',\''
												+ response.body[i].sku
												+ '\',\''
												+ response.body[i].brandName
												+ '\',\''
												+ response.body[i].brand
												+ '\')">'
												+ response.body[i].itemName
												+ '('
												+ response.body[i].sku
												+ ')'
												+ '('
												+ response.body[i].brandName
												+ ')' + '</li>';
									}
									content += '</ul>';
									console.log("content " + content)
									$("#suggesstion-box1_").show();
									$("#suggesstion-box1_").html(content);

								} else {
									$("#search").css("background", "#FFF");
									var content = '<ul id="autocomplete-list1">';
									content += '<li onClick="selectAutocompleteValue()">'
											+ "No Data Found" + '</li>';
									content += '</ul>';
									$("#suggesstion-box1_").show();
									$("#suggesstion-box1_").html(content);
								}
							}
						},
						error : function(data) {
							console.log(data);
						}
					})
		}
	}

	function selectAutocompleteValue1(key, name, sku, brandName, brand) {

		if (key) {
			$("#itemName").html(name);
			$("#itemId").val(key);
			$("#brandName").html(brandName);
			$("#brandId").val(brand);
			$("#sku").html(sku);
			$("#search").val(name)
			$("#search").attr('data-procat', key);
			$("#suggesstion-box1_").hide();
			//checkForDuplicate(key,counter);

		} else {

			$("#itemName").html("");
			$("#itemId").val("");
			$("#brandId").html("");
			$("#brandId").val("");
			$("#sku").html("");
			$("#search").val("");
			$("#search").attr('data-procat', "");
			$("#suggesstion-box1_").hide();

		}
	}
	function selectAutocompleteValue() {
		$("#itemName").html("");
		$("#itemId").val("");
		$("#brandId").val("");
		$("#brandName").html("");
		$("#sku").html("");
		$("#search").val("");
		$("#search").attr('data-procat', "");
		$("#suggesstion-box1_").hide();

	}

	function onQuickFilterChanged() {
		$(".ti-search srchicon").hide();
		gridOptions.api
				.setQuickFilter(document.getElementById('quickFilter').value);
	}

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
			id.style.display = "none";
		}
	}
	function putOnHold() {
		var isHold = $("#isHold").val();
		if (isHold == '1') {
			$("#isHold").val('4');
			$("#putOnHold").removeClass('holdCls');
		} else if (isHold == '4') {
			$("#isHold").val('1');
			$("#putOnHold").addClass('holdCls');
		}
	}

	function viewRFQ() {
		localStorage.setItem('activity', 'ACT0021');
		agGrid.simpleHttpRequest({
			url : 'view-requisition-item-trough-ajax?id=' + $("#indentId").val()
		}).then(function(data) {
			localStorage.setItem('ReqData', JSON.stringify(data));
			productOptions.api.setRowData(data);
		});
		window.location.href = "/inventory/view-quatation";
	}
	function headerStatus() {
		$("#statusDiv").show();
		var createdDate = $("#createdDate").text();
		var activeDate = $("#activeDate").text();
		var completeDate = $("#completeDate").text();
		var onHoldDate = $("#onHoldDate").text();
		if (createdDate) {
			$('#createdDiv').addClass('green-box');
			$('#createdDiv').removeClass('grey-box');
		} else {
			$('#createdDiv').removeClass('green-box');
			$('#createdDiv').addClass('grey-box');
		}
		if (activeDate) {
			$('#activeDiv').addClass('green-box');
			$('#activeDiv').removeClass('grey-box');
		} else {
			$('#activeDiv').addClass('grey-box');
			$('#activeDiv').removeClass('green-box');
		}
		if (completeDate) {
			$('#completeDiv').addClass('green-box');
			$('#completeDiv').removeClass('grey-box');
			$('#dltProduct').attr('disabled', true);
			$('#addProduct').attr('disabled', true);
			$('#createRfq').attr('disabled', true);
		} else {
			$('#completeDiv').removeClass('green-box');
			$('#completeDiv').addClass('grey-box');
		}
		if (onHoldDate) {
			$('#onHoldDiv').addClass('green-box');
			$('#onHoldDiv').removeClass('grey-box');
		} else {
			$('#onHoldDiv').removeClass('green-box');
			$('#onHoldDiv').addClass('grey-box');
		}
	}
	function clearSearchData() {
		$("#search").val(null);
		$("#sku").html('');
		$("#brandName").html('');
		$("#brandId").val('');
		$("#itemId").html('');
		$("#itemName").html('');
	}

	function getCategoryList() {
		$("#productCategoryCBDiv").empty();
		$
				.ajax({
					type : "POST",
					url : "store-indent-product-category-get-total-list",
					dataType : "json",
					contentType : "application/json",
					success : function(response) {
						if (response.message == "Success") {

							if (response.body.length > 0) {

								var c = 0;
								$("#totalPCat").text(c);
								for (var i = 0; i < response.body.length; i++) {

									c = c + 1;

									if (response.body[i].nodeCount > 0) {
										var tbl = '<ul id="myUL_'+response.body[i].categoryId+'" data-field="1" class="level bg_white"><li id="li_'+response.body[i].categoryId+'"><span class="caret" value="0" id="spanA_'
												+ response.body[i].categoryId
												+ '" onclick=getRootLeafNodes("'
												+ response.body[i].categoryId
												+ '")></span> '
												+ '<span id="lbl_'+response.body[i].categoryId+'" class="leveltxt" level="'+response.body[i].catLevel+'">'
												+ response.body[i].categoryName
												+ '</span> '
												+ '<ul class="nested bg_white" id="ul_'+response.body[i].categoryId+'" data-field="0"></ul>'
												+ '</li></ul>';
									} else {
										var tbl = '<ul id="myUL_'+response.body[i].categoryId+'" data-field="1" class="level bg_white"><li id="li_'+response.body[i].categoryId+'"><span class="caret" value="0" id="spanA_'
												+ response.body[i].categoryId
												+ '" onclick=getRootLeafNodes("'
												+ response.body[i].categoryId
												+ '")></span> '
												+ '<div class="category"><input type="checkbox" id="cat_'
												+ response.body[i].categoryId
												+ '" class="pc1-box" value='
												+ response.body[i].categoryId
												+ ' onchange=selectCheckBox("'
												+ response.body[i].categoryId
												+ '","'
												+ response.body[i].catLevel
												+ '")></div><span id="lbl_'+response.body[i].categoryId+'" class="leveltxt" level="'+response.body[i].catLevel+'">'
												+ response.body[i].categoryName
												+ '</span> '
												+ '<ul class="nested bg_white" id="ul_'+response.body[i].categoryId+'" data-field="0"></ul>'
												+ '</li></ul>';
									}

									$("#productCategoryCBDiv").append(tbl);

									getRootLeafNodes(response.body[i].categoryId);
								}

								var prCategoryId = $("#prodCatId").val();

								$("#cat_" + prCategoryId).prop("checked", true);

							}
						} else {
							swal({
								title : response.code,
								text : response.message,
								type : "warning"
							})
						}
					},
					error : function(response) {
						console.log(response);
					}
				})
	}
	/* Item AutoSearch */

	function getItemQutotationList() {
	var search = $("#itemName").val();
	if (search) {
		$.ajax({
					type : "POST",
					url : "store-indent-item-get-list",
					dataType : 'json',
					contentType : 'application/json',
					data : search,
					success : function(response) {
						if (response.message == "success") {
							if (response.body.length != 0) {
								$("#itemId").val("");
								$("#gstRate").val("");
								$("#sku").val("");
								$("#brandName").val("");
								$("#brandId").val("");
								$("#hsnCode").val("");
								$("#unit").val("");
								$("#model").val("");
								$("#itemName").css("background", "#FFF");
								var content = '<ul id="autocomplete-list1" style="margin-left:-40px; font-weight:100; font-size:14px; color:#ccc;">';
								for (var i = 0; i < response.body.length; i++) {
						content += '<li class="autocompletedata cp" onClick="selectAutocompleteValueItem1(\''
											+ response.body[i].sku
											+ '\',\''
											+ response.body[i].productId
											+ '\',\''
											+ window.btoa(response.body[i].productName)
											+ '\',\''
											+ response.body[i].brandId
											+ '\',\''
											+ window.btoa(response.body[i].brandName)
											+ '\',\''
											+ window.btoa(response.body[i].hsnCode)
											+ '\',\''
											+ window.btoa(response.body[i].unit)
											+ '\',\''
											+ window.btoa(response.body[i].gstRate)
										    + '\',\''
											+ window.btoa(response.body[i].model)
											+ '\')">'
											+ response.body[i].productName
											/* + " - "
											+ response.body[i].productName */
											+ '</li>';
								}
								content += '</ul>';
								$("#suggesstion-box_").show();
								$("#suggesstion-box_").html(content);

							} else {
								$("#itemName").css("background", "#FFF");
								var content = '<ul id="autocomplete-list1">';
								content += '<font-weight:100; font-size:14px; color:#ccc;     background-color: #0909e4;"li onClick="selectAutocompleteValueItem()">'
										+ "No Data Found" + '</li>';
								content += '</ul>';
								$("#suggesstion-box_").show();
								$("#suggesstion-box_").html(content);
							}
						}
					},
					error : function(data) {
						console.log(data);
					}
				})
	}else{
		$("#itemId").val("");
		$("#itemName").val("");
		$("#gstRate").val("");
		$("#sku").val("");
		$("#brandName").val("");
		$("#brandId").val("");
		$("#hsnCode").val("");
		$("#unit").val("");
		$("#model").val("");
		$("#suggesstion-box_").hide();
	}
}
	function selectAutocompleteValueItem1(sku, productId, productName, brandId, brandName,
			 hsnCode, unit, gstRate,model) {
		if (sku) {
			//$("#sku").val(sku);
			$("#itemName").val(window.atob(productName));
			$("#itemIdTemp").val(productId);
			$("#brandName").val(window.atob(brandName));
			$("#brandId").val(brandId);
			$("#skuTemp").val(sku);
			$("#sku").val(sku);
			$("#hsnCode").val(window.atob(hsnCode));
			$("#unit").val(window.atob(unit));
			$("#gstRate").val(window.atob(gstRate));
			$("#model").val(window.atob(model));
			$("#itemName").attr('data-procat', itemId);
			$("#suggesstion-box_").hide();
			hideShowS();
		} else {
			
			$("#sku").val("");
			$("#itemId").val("");
			$("#itemName").val("");
			$("#gstRate").val("");
			$("#brandName").val("");
			$("#brandId").val("");
			$("#hsnCode").val("");
			$("#unit").val("");
			$("#model").val("");
			$("#itemName").attr('data-procat', "");
			$("#suggesstion-box_").hide();

		}
	}
	function selectAutocompleteValueItem() {

		$("#itemId").val("");
		$("#model").val("");
		$("#gstRate").val("");
		$("#sku").val("");
		$("#itemName").val("");
		$("#itemName").attr('data-procat', "");
		$("#suggesstion-box_").hide();

	}
	
	
	function selectCheckBoxx(id,lvl) {
		
		$(".benefitChk").prop("checked", false);
		$("#ccCheck_"+id).prop("checked", true);
		$("#tempCategoryId").val(id);
		$("#prLevelId").val(lvl);
		 
	}
	function reply(){
		$('#replyModal').modal('show');
	}
	function cancelBtn2(){
		$('#replyModal').modal('hide');
	}
	function addReply() {
		var selectedRows = gridOptions.api.getSelectedRows();
		 var id=selectedRows[0].indentId;
		var obj = {};
		obj.current = $("#current").val();
		obj.previous = $("#previous").val();
		obj.indentId = id;
		var validation = true;

		if (obj.current == null || obj.current == "") {
			validation = validationUpdated("Current Required", "current");
		}
		if (obj.previous == null || obj.previous == "") {
			validation = validationUpdated("Previous Required", "previous");
		}
		
		if (validation) {
			$(".formValidation").remove();
			console.log(obj)
			$.ajax({
				type : "POST",
				url : "store-indent-add-feedback",
				contentType : "application/json",
				data : JSON.stringify(obj),
				success : function(response) {
					if (response.message == "Success") {
						$("#messageParagraph").text("Saved Successfully");
						$("#msgOkModal").removeClass("btn3");
						$("#msgOkModal").addClass("btn1");
						$("#msgModal").modal('show');
						$('#replyModal').modal('hide');
					}
				},
				error : function(data) {
				}
			})
		}
	}
	function cancelModalBtn1(){
		$('#delete').modal('hide');
	}
	function getDeptList() {
		var id=0;
			var option = $("<option></option>");
			$(option).val(null);
			$(option).html("Select");
			$.ajax({
				type : "GET",
				url : "view-requisition-get-deptList?id=" + id,
				//url : "view-product-get-brandList",
				success : function(response) {
					if (response.message == "success") {
						$("#deptId").empty();
						var option = $("<option></option>");
						$(option).val(null);
						$(option).html("Select");
						$("#deptId").append(option);
						for (var i = 0; i < response.body.length; i++) {
							var option = $("<option></option>");
							$(option).val(response.body[i].key);
							$(option).html(response.body[i].name);
							$("#deptId").append(option);
						}
						if(rid!="" || rid!=null || rid!="null"){
							$("#deptId").val(rid);
						}
					}
				},
				error : function(e) {
				}
			});	
	}	
	function getRootLeafNodes(id) {

		$("#ul_" + id).empty();

		var value = $("#spanA_" + id).attr("value");
		if (value == "0") {

			$
					.ajax({
						type : "POST",
						url : "view-requisition-product-category-get-category-list-by-id",
						dataType : "json",
						contentType : "application/json",
						data : id,
						success : function(response) {
							if (response.message == "Success") {
								if (response.body.length > 0) {
									for (var i = 0; i < response.body.length; i++) {

										if (response.body[i].nodeCount > 0) {
											var tbl = '<li id="li_'+response.body[i].categoryId+'"><span class="caret" value="0" id="span_'
													+ response.body[i].categoryId
													+ '" onclick=getLeafNodes("'
													+ response.body[i].categoryId
													+ '")></span><span class="leveltxt" id="lbl_'+response.body[i].categoryId+'" level="'+response.body[i].catLevel+'"> '
													+ response.body[i].categoryName
													+ ' </span>'
													+ '<ul class="nested bg_white" id="ul_'+response.body[i].categoryId+'" data-field="0"></ul>'
													+ '</li>';
										} else {
											var tbl = '<li id="li_'+response.body[i].categoryId+'"><span class="caret" value="0" id="span_'
													+ response.body[i].categoryId
													+ '" onclick=getLeafNodes("'
													+ response.body[i].categoryId
													+ '")></span><div class="category"><input type="checkbox" id="cat_'
													+ response.body[i].categoryId
													+ '" class="pc1-box" value='
													+ response.body[i].categoryId
													+ '  onchange=selectCheckBox("'
													+ response.body[i].categoryId
													+ '","'
													+ response.body[i].catLevel
													+ '")></div><span class="leveltxt" id="lbl_'+response.body[i].categoryId+'" level="'+response.body[i].catLevel+'"> '
													+ response.body[i].categoryName
													+ ' </span>'
													+ '<ul class="nested bg_white" id="ul_'+response.body[i].categoryId+'" data-field="0"></ul>'
													+ '</li>';
										}

										$("#spanA_" + id).attr("value", "1");
										$("#spanA_" + id)
												.addClass("caret-down");
										$("#ul_" + id).addClass("active");

										$("#ul_" + id).append(tbl);

										getLeafNodes(response.body[i].categoryId);
									}

									var prCategoryId = $("#prodCatId").val();

									$("#cat_" + prCategoryId).prop("checked",
											true);

									//$("#ul_"+id).attr("data-field","1");
								}
							}

						},
						error : function(data) {
							$("#spanA_" + id).attr("value", "0");
							$("#spanA_" + id).removeClass("caret-down");
							$("#ul_" + id).removeClass("active");
							$("#ul_" + id).empty();
						}
					});
		} else {
			$("#spanA_" + id).attr("value", "0");
			$("#spanA_" + id).removeClass("caret-down");
			$("#ul_" + id).removeClass("active");
			$("#ul_" + id).empty();
		}
	}

	function getLeafNodes(id) {

		$("#ul_" + id).empty();

		var value = $("#span_" + id).attr("value");
		if (value == "0") {

			$
					.ajax({
						type : "POST",
						url : "view-requisition-product-category-get-category-list-by-id",
						dataType : "json",
						contentType : "application/json",
						data : id,
						success : function(response) {
							if (response.message == "Success") {
								if (response.body.length > 0) {
									for (var i = 0; i < response.body.length; i++) {

										if (response.body[i].nodeCount > 0) {
											var tbl = '<li id="li_'+response.body[i].categoryId+'"><span class="caret" value="0" id="span_'
													+ response.body[i].categoryId
													+ '" onclick=getLeafNodes("'
													+ response.body[i].categoryId
													+ '")></span><span class="leveltxt" id="lbl_'+response.body[i].categoryId+'" level="'+response.body[i].catLevel+'"> '
													+ response.body[i].categoryName
													+ ' </span>'
													+ '<ul class="nested bg_white" id="ul_'+response.body[i].categoryId+'" data-field="0"></ul>'
													+ '</li>';
										} else {
											var tbl = '<li id="li_'+response.body[i].categoryId+'"><span class="caret" value="0" id="span_'
													+ response.body[i].categoryId
													+ '" onclick=getLeafNodes("'
													+ response.body[i].categoryId
													+ '")></span><div class="category"><input type="checkbox" id="cat_'
													+ response.body[i].categoryId
													+ '" class="pc1-box" value='
													+ response.body[i].categoryId
													+ '  onchange=selectCheckBox("'
													+ response.body[i].categoryId
													+ '","'
													+ response.body[i].catLevel
													+ '")></div><span class="leveltxt" id="lbl_'+response.body[i].categoryId+'" level="'+response.body[i].catLevel+'"> '
													+ response.body[i].categoryName
													+ ' </span>'
													+ '<ul class="nested bg_white" id="ul_'+response.body[i].categoryId+'" data-field="0"></ul>'
													+ '</li>';
										}

										$("#span_" + id).attr("value", "1");
										$("#span_" + id).addClass("caret-down");
										$("#ul_" + id).addClass("active");
										//var df = $("#ul_"+id).attr("data-field");
										//if(df == 0) {
										$("#ul_" + id).append(tbl);
										//}
										getLeafNodes(response.body[i].categoryId);
									}

									var prCategoryId = $("#prodCatId").val();
									if (prCategoryId) {
										$("#cat_" + prCategoryId).prop(
												"checked", true);
										getProductByCategory();
									}
								}
							}

						},
						error : function(data) {
							$("#span_" + id).attr("value", "0");
							$("#span_" + id).removeClass("caret-down");
							$("#ul_" + id).removeClass("active");
							$("#ul_" + id).empty();
							$("#ul_" + id).empty();
						}
					});
		} else {
			$("#span_" + id).attr("value", "0");
			$("#span_" + id).removeClass("caret-down");
			$("#ul_" + id).removeClass("active");
			$("#ul_" + id).empty();
		}
	}
	function cancelModal(){
		$("#myModal").modal('hide');
	}
	function selectCheckBox(id, lvl) {
		getProductByCategory();

		if (lvl == 'L1') {
			var textDesc = $("#lbl_" + id).text();
			$("#catDesc").text(textDesc);
		} else {
			var res = lvl.substring(1, 1000000);

			var lastText = $("#lbl_" + id).text();
			var textDesc = "";
			for (i = res; i > 1; i--) {
				var pUL = $("#lbl_" + id).parents("ul").attr("id");
				pUL = pUL.substring(3, 10000000000000);
				var newText = $("#lbl_" + pUL).text();
				textDesc = newText + " > " + textDesc;
				id = pUL;
			}
			textDesc = textDesc + lastText;
			$("#catDesc").text(textDesc);
		}
	}
	function getProductByCategory() {

		$("#select_product").empty();
		var valor = "";
		$('input.pc1-box[type=checkbox]').each(function() {
			if (this.checked)
				valor = valor + $(this).val() + ",";
		});
		if (valor) {
			$("#select_product").empty();
			$
					.ajax({
						type : "POST",
						url : "store-indentr-item-product-by-cat",
						dataType : 'json',
						contentType : 'application/json',
						data : valor,
						success : function(response) {
							if (response.message == "success") {
								console.log(response.body)
								$("#select_product").empty();
								var content = '';
								for (var i = 0; i < response.body.length; i++) {

									content += '<div class="autocompletedata cp product-item" id="'
											+ response.body[i].productId
											+ "_"
											+ response.body[i].sku
											+ '" onClick=selectActive("'
											+ response.body[i].productId
											+ "_"
											+ response.body[i].sku
											+ '","'
											+ response.body[i].sku
											+ '","'
											+ response.body[i].productId
											+ '","'
											+ window
													.btoa(response.body[i].productName)
											+ '","'
											+ window
													.btoa(response.body[i].brandId)
											+ '","'
											+ window
													.btoa(response.body[i].brandName)
											+ '","'
											+ window
													.btoa(response.body[i].productCatId)
											+ '","'
											+ window
													.btoa(response.body[i].productCatName)
											+ '","'
											+ window
													.btoa(response.body[i].hsnCode)
											+ '","'
											+ window.btoa(response.body[i].unit)
											+ '","'
											+ window.btoa(response.body[i].gstRate)
											+ '","'
											+ window
													.btoa(response.body[i].model)
											+ '")>'
											/* + response.body[i].sku
											+ " - "
											+ response.body[i].brandName
											+ " - " */
											+ response.body[i].productName
											+ '</div>';
								}
								content += '</ul>';
								$("#select_product").show();
								$("#select_product").append(content);

								var itemId = $("#itemId").val();
								var skuId = $("#sku").html();

								if (itemId) {
									$("#" + itemId + "_" + skuId).addClass(
											'productActive');
								}

							}
						},
						error : function(data) {

						}
					})
		} else {
			$("#itemName").val(null);
			$("#hsnCode").val(null);
			$("#unit").val(null);
			$("#itemId").val(null);
			$("#select_product").empty();
		}
	}

	function selectActive(id, sku, productId, productName, brandId, brandName,
			prodCatId, prodCatName, hsnCode, unit,gstRate,model) {
		$('.autocompletedata ').removeClass('productActive');
		$("#" + id).addClass('productActive');
		$("#itemNameTemp").val(window.atob(productName));
		$("#itemIdTemp").val(productId);
		$("#brandNameTemp").val(window.atob(brandName));
		$("#brandIdTemp").val(window.atob(brandId));
		$("#skuTemp").val(sku);
		$("#modelTemp").val(window.atob(model));
		$("#gstRateTemp").val(window.atob(gstRate));	
		$("#prodCatIdTemp").val(window.atob(prodCatId));
		$("#prodCatNameTemp").val(window.atob(prodCatName));
		$("#searchTemp").val(window.atob(productName))
		$("#hsnCodeTemp").val(window.atob(hsnCode));
		$("#unitTemp").val(window.atob(unit));

	}
	function selectProductVal() {
		$("#itemName").val($("#itemNameTemp").val());
		$("#itemId").val($("#itemIdTemp").val());
		$("#brandName").val($("#brandNameTemp").val());
		$("#brandId").val($("#brandIdTemp").val());
		$("#category").val($("#prodCatIdTemp").val());
		$("#categoryName").val($("#prodCatNameTemp").val());
		$("#sku").val($("#skuTemp").val());
		$("#hsnCode").val($("#hsnCodeTemp").val());
		$("#unit").val($("#unitTemp").val());
		$("#model").val($("#modelTemp").val());
		$("#search").val($("#itemNameTemp").val())
		$("#select_product").html('');
		$('#myModal').modal('hide');
		$("#gstRate").val($("#gstRateTemp").val());
		
		
	}

	function validFormData() {
		var allValid = true;
		if (!validationUpdated("Purpose can't be Left Blank", 'desc'))
			allValid = false;

		if (!validationUpdated("Receive Date can't be Left Blank",
				'dept'))
			allValid = false;
		return allValid;
	}
	
	function validProductData() {
		var item = null;
		productOptions.api.forEachNode(function(rowNode, index) {
			item = item + rowNode.data;
		});
		if (item) {
			return true;
		} else {
			$("#messageParagraph").text("Please Add At Least One Product");
			$("#msgOkModal").removeClass("btn3");
			$("#msgOkModal").addClass("btn1");
			$("#msgModal").modal('show');
			return false;
		}
	}
	
	function saveMultiFile(event) {
		var AssignItemQty = event.currentTarget.value;
		var currentFldId = event.currentTarget.getAttribute('id');
		var l = currentFldId.split("_");
		var counter = l[1];
		var currentFldId = "#" + currentFldId;

		var uFile = $(currentFldId)[0].files[0];
		var fileName = event.currentTarget.value;
		var lastIndex = fileName.lastIndexOf("\\");
		if (lastIndex >= 0) {
			fileName = fileName.substring(lastIndex + 1);
		}
		var extension = fileName.split(".");

		var iURL = URL.createObjectURL(uFile);
		$("#uploadedBillDiv_" + counter).html("");
		if (extension[1] != null && extension[1] != "") {
			$("#uploadHidden_" + counter).val('');
		}
		if (extension[1] == "jpg" || extension[1] == "png"
				|| extension[1] == "jpeg") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-picture-o'></i></a></div>";
		} else if (extension[1] == "pdf") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-pdf-o'></i> </a></div>";
		} else if (extension[1] == "xls" || extension[1] == "xlsx") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-excel-o'></i></a></div>";
		} else if (extension[1] == "doc" || extension[1] == "dox"
				|| extension[1] == "docx") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-word-o'></i></a></div>";
		} else {
			var LightImg = "<div class='uploadicon position-l '> </div>";
		}
		var dltImg = "<i class='ti-close position-l rmv1'></i>";
		$("#uploadedBillDiv_" + counter).html(LightImg);
		$("#imageName_" + counter).html(fileName);
		$("#dltImage_" + counter).html(dltImg);

		$("#dltImage_" + counter).addClass("custom-file-delete");
		$("#clickImg_" + counter).removeClass("ti-plus");
		$("#clickImg_" + counter).addClass("ti-pencil");

	}
	function checkEmpty() {
		var infofileName = true;
		$(".formValidation").remove();
		$('.docNoclss').each(function() {
			if ($(this).val() == null || $(this).val() == "") {
				infofileName = false;
				validationModal("Document Name Required", $(this).attr('id'));
			}
		});

		var mulDocInfo = true;
		if (infofileName) {
			$('#doctbodyData > tr').each(function() {
				if ($(this).closest('tr').find('.imageName').text()) {
					mulDocInfo = true;
				} else {
					mulDocInfo = false;
					$("#messageParagraph").text("Please Choose a File ");
					$("#msgOkModal").removeClass("btn3");
					$("#msgOkModal").addClass("btn1");
					$("#msgModal").modal('show');
					return false;
				}

			});
		}
		if (infofileName && mulDocInfo) {
			addMore1()
		}
	}
	function addMore1() {

		var lengthOfTableRow = $("#doctbodyData").children('tr').length;
		var cloneHtml = $("#docTbl tbody tr:first").clone();

		$("#docTbl tbody").append($("#docTbl tbody tr:first").clone());
		$("#myTable tbody tr td:last").html("");
		//var addMore = '<button type="button" class="btn btn-primary tr_clone_add" name="add" onclick="addMore1();"><span class="ti-plus"></span></button>&nbsp;'

		$("#docTbl tbody tr:last").find(".documentclss").val("");
		$("#docTbl tbody tr:last").find(".docNoclss").val("");
		$("#docTbl tbody tr:last").find(".documentclssup").val("");
		$("#docTbl tbody tr:last").find(".uploadedBillCls").empty();
		$("#docTbl tbody tr:last").find(".uploadHidCls").empty();
		$("#docTbl tbody tr:last").find(".uploadHidCls").val('');
		$("#docTbl tbody tr:last").find(".imageName").empty();
		var j = 0;
		$("#docTbl > #doctbodyData > tr").each(function(i) {

			var selectInput = $(this).find('select');
			var textInput = $(this).find('input');
			var fileInput = $(this).find('file');
			var divInput = $(this).find('div');
			var label = $(this).find('label');
			var iInput = $(this).find('i');
			selectInput.eq(0).attr('id', "docid_" + i);

			textInput.eq(1).attr('id', "docnoid_" + i);
			textInput.eq(2).attr('id', "uploadDoc_" + i);
			label.eq(1).attr('for', "uploadDoc_" + i);
			textInput.eq(3).attr('id', "uploadHidden_" + i);
			divInput.eq(4).attr('id', "uploadedBillDiv_" + i);
			divInput.eq(5).attr('id', "imageName_" + i);
			//divInput.eq(6).attr('id', "dltImage_" + i);
			iInput.eq(0).attr('id', "clickImg_" + i);
			j++;
		})
		$("#clickImg_" + (j - 1)).removeClass("ti-pencil");
		$("#clickImg_" + (j - 1)).addClass("ti-plus");

	}

	function checkForDuplicateEntry(event) {
		var document = event.currentTarget.value;
		var currentFldId = event.currentTarget.getAttribute('id');
		var l = currentFldId.split("_");
		var counter = l[1];
		var count = 0;
		$(".docNoclss").each(function() {
			if (document == $(this).val()) {
				count++;
			}
		})
		if (count >= 2) {
			$("#messageParagraph").text("Document Name Already Entered");
			$("#msgOkModal").removeClass("btn3");
			$("#msgOkModal").addClass("btn1");
			$("#msgModal").modal('show');

			return false;
		} else {
			return true;
		}
	}
	function openDeleteConfirm() {
		$("#dltValue").val("");
		$('#deleteAttachment').modal('show');
	}
	//for closeing modal box for dlt ind product
	function closeDeleteConfirm() {
		$("#dltValue").val("");
		$('#deleteAttachment').modal('hide');
	}

	function deletAttachmentRow() {
		var lengthOfTableRow1 = 0;
		$("#docTbl > #doctbodyData > tr").each(function() {
			lengthOfTableRow1 = lengthOfTableRow1 + 1;
		})
		var id = $("#dltValue").val();
		$("#" + id).closest('tr').remove();
		closeDeleteConfirm();
		if (lengthOfTableRow1 == 1) {
			var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
					+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
					+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_"></div></td>'
					+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
					+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
					+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0"></div> </td>'
					+ '</tr>';
			$("#doctbodyData").append(tbl);
		}
	}	
	
	
</script>
</head>
<body>

	<div layout:fragment="content" class="maincontent">

		<div class="container-fluid">
			<div class="row">
				<div class="maincontentsec">
					<div class="content_padding">
						<div class="d-flex justify-content-between">
							<div class="btn-hs">
								<div class="font-design" id="totalReq">
									INDENT LIST (<span></span>)
								</div>
							</div>
							<div id="searchRowDiv">
								<div class="input-style">
									<input type="text" placeholder="Search.." name="search"
										class="searchboxinput" onkeyup="cancelBar()"
										oninput="onQuickFilterChanged()" id="quickFilter"
										autocomplete="off">
									<div class="searchicon">
										<a href="javascript:void(0)"><span
											style="display: none; border-right: 1px solid #ccc; padding-right: 5px;"
											id="closeKey"
											onclick="gridOptions.api.setQuickFilter(null);$('#quickFilter').val('');document.getElementById('closeKey').style.display='none';"
											class="close_i"><i class="ti-close srchicon"></i></span></a><a
											href="javascript:void(0)"><i class="ti-search srchicon"></i></a>
									</div>
								</div>
							</div>
							<div class="col-md-4 buttonsec btn-hs">

								<button class="btn4">DOWNLOAD</button>
								<button class="btn1" id="newBtn" onclick="switchPage()">NEW</button>
								<button class="btn3" id="reqDltBtn" onclick="deleteFun()">DELETE</button>
								<button id="reqAppvBtn" class="btn2" onclick="approveIndent()">APPROVE</button>
								<!-- <button class="btn2" id="reply" onclick="reply()">REPLY</button>  -->
							</div>
						</div>
						<!-- <div class="loader">
							<center>
								<img class="loading-image" src="../assets/images/loading.gif"
									alt="../assets/images/loading.gif">
							</center>
						</div> -->
						<div id="myGrid" style="width: 100%; height: 424px;"
							class="ag-theme-alpine"></div>

						<div class="collapse" id="demo">
							<div class="innerstickybg">
								<div class="row">

									<div class="col-md-6">
										Indent Id: <span id="indentHeadId"></span>
									</div>
									<div class="col-md-6" align="right">
										<button class="cancel-btn" onclick="cancel()">Cancel</button>
										<button class="btn1" id="save1" onclick="saveData()">Save</button>
									</div>
								</div>

							</div>
							<input type="hidden" id="reqId">
							<div class="row innersticky_contentgap">
								<div class="col-md-6">
									<div class="row">
										<input type="hidden" id="deptId">
										<!-- <div class="col-md-6">
											<div class="form-group">
												<label>Type</label>
												<div class="select">
													<select id="reqType">
														<option th:each="c:${requisitionTypeList}"
															th:value='${c.key}' th:text="${c.name}"
															th:selected="${c.key==employeeEmployment}"></option>
													</select>
												</div>
											</div>
										</div> -->
										<!-- <div class="col-lg-6">
											<div class="form-group">
												<label>Department</label>
												<div class="select">
													<select id="deptId">
														<option th:each="c:${DepartmentList}" th:value='${c.key}'
															th:text="${c.name}"></option>
													</select>
												</div>
											</div>
										</div> -->

										<!-- 
										<div class="col-md-6">
											<div class="form-group">
												<label>Priority</label>
												<div class="select">
													<select id="reqPrior">
														<option th:each="c:${requisitionPrioList}"
															th:value='${c.key}' th:text="${c.name}"
															th:selected="${c.key==employeeEmployment}"></option>
													</select>
												</div>
											</div>
										</div> -->
										<div class="col-lg-6">
											<div class="form-group">
												<label>Project</label>
												<div class="select">
													<select id="project">
													<option value="">Select</option>
														<option th:each="c:${ProjectList}" th:value='${c.key}'
															th:text="${c.name}"></option>
													</select>
												</div>
											</div>
										</div>
										<input type="hidden" id="astatus">
										<div class="col-md-6">
											<div class="form-group calendar_box">
												<label>Expected Receive Date</label> <input type="text"
													id="receiveDate" onchange="dateChange()" autocomplete="off"
													class="form-control" onblur="removeValid(event)"
													th:attr="onkeyup=|formatDate('receiveDate','${session.DATEFORMAT_JS}')|"
													readonly> <i class="ti-calendar picker_calendar"
													id="receiveDateCalendar1"></i>
											</div>
										</div>
									</div>
								</div>


								<div class="col-md-6">
									<div class="form-group">
										<label>Purpose</label>
										<textarea class="form-control" id="desc"
											style="line-height: 22px !important;"></textarea>
										<input type="hidden" id="indentId" />
									</div>
								</div>

							</div>
							<div id="main_content">
								<div class="accordion-item mt-4" id="accordionExample">
									<h2 class="accordion-header" id="headingOne">
										<button class="accordion-button" type="button"
											data-bs-toggle="collapse" data-bs-target="#collapseOne"
											aria-expanded="false" aria-controls="collapseOne">
											Item Details</button>
									</h2>

									<div id="collapseOne" class="accordion-collapse collapse show"
										aria-labelledby="headingOne"
										data-bs-parent="#accordionExample">
										<div class="accordion-body">
											<div class="row">
												<div class="row">
													<div class="col-md-4 btn-hs1">
														<div class="font-design"></div>
													</div>
													<div class="col-md-8 butttonsec">
														<button class="btn1" id="addProduct" onclick="openNav()">NEW</button>
														<button class="btn3" id="dltProduct"
															onclick="deleteProduct()">DELETE</button>
													</div>
												</div>
												<div id="product" style="width: 100%; height: 200px;"
													class="ag-theme-alpine"></div>
											</div>
										</div>
									</div>

									<div id="mySidenav" class="sidenav">
										<div class="slidebox">
											<div class="row">
												<div class="chartbtnsec">
													<div align="right">
														<button class="cancel-btn" onclick="closeNav()">CANCEL</button>
														<button class="approve-btn" id="saveTableData"
															onclick="saveTableData()">SAVE</button>
														<input type="hidden" id="editProduct">
													</div>
												</div>

												<div class="col-lg-12 mrt_6">
													<div class="form-group">
														<button id="browseBtn" class="browse-btn">Browse</button>
													</div>
												</div>

												<div class="col-lg-12">
													<div class="form-group">
														<div class="autocomplete">
															<input type="hidden" id="itemId"> <label>Item
																Name</label> <input type="text" id="itemName"
																onblur="removeValid(event)" class="form-control"
																onkeyup='getItemQutotationList()'>
														</div>
														<div id="suggesstion-box_" class="sugg-cls"></div>
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>SKU</label> <input type="text"
															class="form-control transparenttxtbox" id="sku">
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<div class="autocomplete" style="width: auto">
															<label>HSN Code </label> <input type="text" id="hsnCode"
																onblur="removeValid(event)" class="form-control"
																onkeyup='getItemQutotationList()'>
														</div>
														<div id="suggesstion-boxx_" class="sugg-cls"></div>
													</div>
												</div>

												<!-- 	<div class="col-lg-12">
													<div class="form-group">
														<label>Location</label>
														<div class="select">
															<select id="locationId">
																<option th:each="c:${locationList}" th:value='${c.key}'
																	th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div> -->
												<div class="col-lg-6">
													<div class="form-group">
														<label>Model/Size</label> <input type="text"
															class="form-control transparenttxtbox" id="model">
													</div>
												</div>
												<!-- 	<div class="col-lg-12">
													<div class="form-group">
														<label>Department</label>
														<div class="select">
															<select id="deptId">
																<option th:each="c:${deptNameList}"
																	th:value='${c.key}' th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div> -->
												<div class="col-lg-6">
													<div class="form-group">
														<label>Quantity</label> <input type="text"
															class="form-control transparenttxtbox" id="quantity">
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>UNIT</label>
														<div class="select">
															<select id="unit">
																<option th:each="c:${unitList}" th:value='${c.key}'
																	th:text="${c.name}"></option>
															</select>
														</div>

													</div>
												</div>

												<div class="col-lg-6">
													<div class="form-group">
														<label>Stock</label> <input type="text"
															class="form-control transparenttxtbox" id="stock">
													</div>
												</div>

												<div class="col-lg-12">
													<div class="form-group">
														<label>Stock For Days</label> <input type="text"
															class="form-control transparenttxtbox" id="stockForDays">
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="row" id=gstCalS>
								<div class="col-lg-12">
									<!--accordion start-->
									<div class="accordion-item mt-4" id="accordionExample2">
										<div class="accordion-item" id="documentDetails">
											<h2 class="accordion-header" id="headingTwoo"
												onclick="closeNav()">

												<button class="accordion-button collapsed" type="button"
													data-bs-toggle="collapse" data-bs-target="#collapseTwoo"
													aria-expanded="false" aria-controls="collapseTwoo">
													Attach Files To Indent</button>

											</h2>
											<div id="collapseTwoo" class="accordion-collapse collapse"
												aria-labelledby="headingTwoo"
												data-bs-parent="#accordionExample">
												<div class="accordion-body">


													<div class="row">
														<div class="col-md-4 btn-hs1">
															<div class="font-design"></div>
														</div>
														<div class="col-md-8 butttonsec">
															<!--   <button class="download-btn" onclick="rfqCSV()">Download</button> -->
															<button class="new-btn" id="saveAttachmentBtn"
																onclick="checkEmpty();">Add Document</button>

														</div>
													</div>

													<table id="docTbl" cellspacing="7" cellpadding="7">
														<thead>
															<tr class="tr_clone">
																<!-- <th align="center"></th> -->

																<th width="620">Document Name</th>
																<th width="480">Attachment</th>


															</tr>
														</thead>
														<tbody id="doctbodyData">
															<tr>
																<td style="display: none" align="center" class="pdb-24"><input
																	class="checkCls" type="checkbox" id="check2"><label
																	for="check2"></label></td>
																<td style="display: none"><div class="form-group">


																		<select class="form-control documentclss" id="docid_0"
																			onblur="removeValid(event);">
																			<option value="">--Select--</option>
																			<option th:each="c,iter:${documentTypeList}"
																				th:value="${c.key}" th:text="${c.name}"></option>
																		</select>
																	</div></td>
																<td><div class="form-group">
																		<input type="text" value=""
																			class="form-control docNoclss"
																			onblur="checkForDuplicateEntry(event)" id="docnoid_">
																	</div></td>

																<td>
																	<div class="control-group position-r">
																		<label class="custom-file-upload" for="uploadDoc_0"
																			id="uploadFor_0"> <i id="clickImg_0"
																			class="ti-plus"></i>
																		</label>
																		<div class="controls">

																			<input type="file" class="document" id="uploadDoc_0"
																				name="userImage" accept="image/*"
																				onchange="saveMultiFile(event)" />

																		</div>
																	</div> <input type="hidden" id="uploadHidden_0"
																	class="uploadHidCls">
																	<div id="uploadedBillDiv_0" align="center"
																		class="uploadedBillCls"></div>
																	<div id="imageName_0" class="imageName"></div>
																	<div id="dltImage_0"></div>
																</td>

															</tr>


														</tbody>
													</table>

												</div>
											</div>
										</div>
									</div>
									<!--accordion end-->
								</div>


							</div>

						</div>
						<div class="modal fade" id="lineGraph">
							<div class="modal-dialog modal-lg">
								<div class="modal-content large-model">

									<div align="right">
										<button type="button" class="close" data-dismiss="modal">
											<i class="ti-close" style="font-size: 14px;"></i>
										</button>
									</div>
									<!-- Modal body -->
									<div class="modal-body">
										<div class="row" id="lineGraphDiv">
											<div class="col-md-12">
												<div id="chart" class="collapse show">
													<div style="width: 90%; height: 280px; margin: 0 auto;">
														<div id="container1" style="width: 100%; height: 280px;"></div>
													</div>
													<div style="width: 90%; height: auto; margin: 0 auto;">
														<div class="row">
															<div class="col-md-12">

																<div align="right" class="pdficonsec">
																	<i class="fa fa-file-pdf-o fa-2x pdf"
																		onclick="downloadChartPdf()"></i> <i
																		class="fa fa-file-excel-o fa-2x excel"
																		onclick="getExcelReport()"></i>
																</div>
																<table id="graphTable" class="newtbl">
																</table>
															</div>

														</div>
													</div>
												</div>
											</div>
										</div>

									</div>
									<!-- Modal footer -->



								</div>
							</div>
						</div>
						<!-- delete modal start -->
						<div id="delete" class="modal fade show" aria-modal="true">
							<div class="modal-dialog modal-confirm">
								<div class="modal-content">
									<div class="modal-header flex-column">
										<button type="button" class="close" data-dismiss="modal"
											aria-hidden="true" onclick="cancelModalBtn1()">
											<i class="ti-close modal-close"></i>
										</button>
									</div>
									<div class="modal-body">
										<p>Do you really want to delete these records? This
											process cannot be undone.</p>
									</div>
									<div class="modal-footer justify-content-center"
										style="margin-top: -30px;">

										<button type="button" class="cancel-btn" data-dismiss="modal"
											onclick="cancelModalBtn1();">Cancel</button>
										<button type="button" class="btn3" onclick="deleteOnclick()">Delete</button>
									</div>
								</div>
							</div>
						</div>

						<!-- delete product modal start -->
						<div id="deleteProduct" class="modal fade show" aria-modal="true">
							<div class="modal-dialog modal-confirm">
								<div class="modal-content">
									<div class="modal-header flex-column">
										<button type="button" class="close" data-dismiss="modal"
											aria-hidden="true" onclick="cancelModalProductBtn()">
											<i class="ti-close modal-close"></i>
										</button>
									</div>
									<div class="modal-body">
										<p>Do you really want to delete these records? This
											process cannot be undone.</p>
									</div>
									<div class="modal-footer justify-content-center"
										style="margin-top: -30px;">

										<button type="button" class="cancel-btn" data-dismiss="modal"
											onclick="cancelModalBtn();">Cancel</button>
										<button type="button" class="btn3"
											onclick="deleteProductOnclick()">Delete</button>
									</div>
								</div>
							</div>
						</div>


						<!-- delete product modal start -->
						<div id="deleteProductInd" class="modal fade show"
							aria-modal="true">
							<div class="modal-dialog modal-confirm">
								<div class="modal-content">
									<div class="modal-header flex-column">
										<button type="button" class="close" data-dismiss="modal"
											aria-hidden="true" onclick="cancelModalProductBtn()">
											<i class="ti-close modal-close"></i>
										</button>
									</div>
									<div class="modal-body">
										<p>Do you really want to delete these records? This
											process cannot be undone.</p>
									</div>
									<div class="modal-footer justify-content-center"
										style="margin-top: -30px;">

										<button type="button" class="btn1" data-dismiss="modal"
											onclick="cancelModalBtn();">Cancel</button>
										<button type="button" class="btn3"
											onclick="deleteProductInd()">Delete</button>
									</div>
								</div>
							</div>
						</div>

						<div id="approvePQtn" class="modal fade show" aria-modal="true">
							<div class="modal-dialog modal-confirm">
								<div class="modal-content">
									<div class="modal-header flex-column"></div>
									<div class="modal-body">
										<p>Do you want to approve</p>
									</div>
									<div class="modal-footer justify-content-center"
										style="margin-top: -30px;">
										<button type="button" class="cancel-btn" data-dismiss="modal"
											onclick="cancelApproveModalBtn();">No</button>
										<button type="button" class="approve-btn"
											onclick="approveOnclick()">Yes</button>
									</div>
								</div>
							</div>
						</div>


						<div class="modal fade" id="myModal">
							<div class="modal-dialog modal-lg" style="margin-top: 130px;">
								<div class="modal-content">

									<!-- Modal Header -->
									<div class="modal-header">
										<h4 class="modal-title md-color">Select Product</h4>
										<button type="button" class="close cp" onclick="cancelModal()">&times;</button>
									</div>

									<!-- Modal body -->
									<div class="modal-body modal-cat">
										<div class="row">

											<div class="col-md-6" df="0">
												<div style="height: 300px; overflow-y: scroll;"
													id="productCategoryCBDiv"></div>
											</div>
											<div class="col-md-6" id="productCategorySelectDiv" df="0"
												style="border-left: 1px solid #ccc;">
												<div style="height: 300px; overflow-y: scroll;">
													<div class="productlist">Select Product</div>
													<div id="select_product"></div>
													<input type="hidden" id="modelTemp" /> <input
														type="hidden" id="gstRateTemp" /> <input type="hidden"
														id="itemNameTemp" /> <input type="hidden" id="itemIdTemp" />
													<input type="hidden" id="brandNameTemp" /> <input
														type="hidden" id="brandIdTemp" /> <input type="hidden"
														id="unitTemp" /><input type="hidden" id="skuTemp" /><input
														type="hidden" id="hsnCodeTemp" /> <input type="hidden"
														id="prodCatIdTemp" /> <input type="hidden"
														id="prodCatNameTemp" />
												</div>
											</div>
										</div>
									</div>

									<!-- Modal footer -->
									<div class="modal-footer">
										<div class="chartbtnsec">
											<button class="btn1" onclick="selectProductVal()">SELECT</button>
											<button class="cancel-btn" onclick="cancelModal()">CANCEL</button>
										</div>
									</div>

								</div>
							</div>
						</div>


						<!-- alert modal start -->
						<div id="alert" class="modal fade show" aria-modal="true">
							<div class="modal-dialog modal-confirm">
								<div class="modal-content">
									<div class="modal-header flex-column">
										<button type="button" class="close" data-dismiss="modal"
											aria-hidden="true" onclick="cancelModalBtn()">
											<i class="ti-close modal-close"></i>
										</button>
									</div>
									<div class="modal-body">
										<p id="textId"></p>
									</div>
									<div class="modal-footer justify-content-center"
										style="margin-top: -30px;">

										<button type="button" class="btn1" data-dismiss="modal">SELECT</button>
										<!-- <button type="button" class="btn3" onclick="deleteOnclick()">Delete</button> -->
									</div>
								</div>
							</div>
						</div>

						<div id="deleteAttachment" class="modal fade show"
							aria-modal="true">
							<div class="modal-dialog modal-confirm">
								<div class="modal-content">
									<div class="modal-header flex-column">
										<button type="button" class="close" data-dismiss="modal"
											aria-hidden="true" onclick="closeDeleteConfirm()">
											<i class="ti-close modal-close"></i>
										</button>
									</div>
									<div class="modal-body">
										<p>Do you really want to delete these records? This
											process cannot be undone.</p>
										<input type="hidden" id="dltValue">
									</div>
									<div class="modal-footer justify-content-center">

										<button type="button" class="cancel-btn" data-dismiss="modal"
											onclick="closeDeleteConfirm()">Cancel</button>
										<button type="button" class="delete-btn"
											onclick="deletAttachmentRow()">Delete</button>
									</div>
								</div>
							</div>
						</div>


						<div class="modal fade" id="replyModal">
							<div class="modal-dialog modal-lg"
								style="margin-top: 130px; height: 900px; max-width: 600px">
								<div class="modal-content">

									<!-- 	Modal Header -->
									<div class="modal-header"></div>
									<!-- Modal body -->
									<div class="modal-body">

										<div class="col-md-12" id="shippingInfo">
											<div class="card-title">
												<h4>Add Feedback Here..</h4>
											</div>
											<div class="row">

												<div class="col-md-6">
													<div class="form-group">
														<label>Current</label> <input type="text"
															class="form-control" placeholder="" id="current"
															onblur="removeValid(event);">
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Previous</label> <input class="form-control"
															id="previous" onblur="removeValid(event);"></input>
													</div>
												</div>

											</div>

											<div class="row mt-4">
												<div class="form-group">

													<button class="delete-btn" id="cancel"
														onclick="cancelBtn2()">CANCEL</button>
													<button class="btn1" id="save" onclick="addReply()">SAVE</button>

												</div>
											</div>
										</div>



									</div>
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>

</body>
</html>