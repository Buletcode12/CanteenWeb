<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/master}">
<head>
<style type="text/css">
.highcharts-exporting-group {
	display: none;
}

.slidebox {
	padding: 14px;
	margin-top: 0px;
	margin: 0px 10px;
}

/* .form-group label {
	font-size: 12px;
	position: relative;
	top: 4px;
} */
.holdCls {
	background-color: rgb(0, 143, 0);
}

.bg_white {
	background: #ffffff !important;
}

.btn1 {
	margin-right: 7px;
}
</style>

<script type="text/javascript">

	$(document).ready(function() {
		var gridDiv = document.querySelector('#myGrid');
		new agGrid.Grid(gridDiv, gridOptions);

		var gridDiv = document.querySelector('#activity');
		new agGrid.Grid(gridDiv, activityOptions);
		var gridDiv = document.querySelector('#insuranceactivity');
		new agGrid.Grid(gridDiv, InsuranceOptions);
		$('.loader').show();
		agGrid.simpleHttpRequest({
			url : 'asset-code-view'
		}).then(function(data) {
			var jsonData = JSON.parse(data.body[0]);
			var allData=jsonData.Asset;
			var len = allData.length;
			$('#totalReq').find('span').html(len);
			gridOptions.api.setRowData(allData);
			$('.loader').hide();
		});
		activityOptions.api.setRowData();
		InsuranceOptions.api.setRowData();
		$('#reqDltBtn').attr('disabled', true);
		$('#assignBtn').attr('disabled', true);
		$('#reqScrapBtn').attr('disabled', true);
		$('#approveBtn').attr('disabled', true);
		$('#deleteChild').attr('disabled', true);
		$('#deleteInChild').attr('disabled', true);
		$("#emplist").hide();
    	$("#loclist").hide();
    	$("#assigndate").hide();
    	$("#assetimageview").hide();
    	$("#docTbl").show();
		$('.collapse').on('show.bs.collapse', function() {
			$(this).siblings('.panel-heading').addClass('active');
		});

		$('.collapse').on('hide.bs.collapse', function() {
			$(this).siblings('.panel-heading').removeClass('active');
		});
		$("#newBtn").click(function() {

		})

							$('#docTbl').on('click', '.rmv1', function() {
							openDeleteConfirm();
							var value = $(this).parent("div").attr("id");

							$("#dltValue").val(value);
						});
		
var dateFormat = localStorage.getItem("dateFormat");
$("#DateCalendarAssign").datetimepicker({
	format : dateFormat,
	closeOnDateSelect : true,
	timepicker : false,
}).on("change", function() {
	$('#asdate').val($(this).val());
})

$('#asdate').blur(function() {
	$("#DateCalendarAssign").val($(this).val());
})


var dateFormat = localStorage.getItem("dateFormat");
$("#DateCalendar1").datetimepicker({
	format : dateFormat,
	closeOnDateSelect : true,
	timepicker : false,
}).on("change", function() {
	$('#sdate').val($(this).val());
})

$('#sdate').blur(function() {
	$("#DateCalendar1").val($(this).val());
})

var dateFormat = localStorage.getItem("dateFormat");
		$("#DateCalendar2").datetimepicker({
			format : dateFormat,
			closeOnDateSelect : true,
			timepicker : false,
		}).on("change", function() {
			$('#edate').val($(this).val());
		})

		$('#edate').blur(function() {
			$("#DateCalendar2").val($(this).val());
		})
		
		var dateFormat = localStorage.getItem("dateFormat");
		$("#DateCalendar3").datetimepicker({
			format : dateFormat,
			closeOnDateSelect : true,
			timepicker : false,
		}).on("change", function() {
			$('#pdate').val($(this).val());
		})

		$('#pdate').blur(function() {
			$("#DateCalendar3").val($(this).val());
		})
		
var dateFormat = localStorage.getItem("dateFormat");
$("#DateCalendar4").datetimepicker({
	format : dateFormat,
	closeOnDateSelect : true,
	timepicker : false,
}).on("change", function() {
	$('#isdate').val($(this).val());
})

$('#isdate').blur(function() {
	$("#DateCalendar4").val($(this).val());
})

var dateFormat = localStorage.getItem("dateFormat");
		$("#DateCalendar5").datetimepicker({
			format : dateFormat,
			closeOnDateSelect : true,
			timepicker : false,
		}).on("change", function() {
			$('#iedate').val($(this).val());
		})

		$('#iedate').blur(function() {
			$("#DateCalendar5").val($(this).val());
		})

		
		
		  $('input[name="options"]').on('change', function() {
			    var selectedValue = $('input[name="options"]:checked').val();
			    if(selectedValue=="Employee"){
			    	$("#emplist").show();
			    	$("#loclist").hide();
			    	$("#assetlocation").val("");
			    	$("#assigndate").show();
			    }else if(selectedValue=="Location"){
			    	$("#emplist").hide();
			    	$("#loclist").show();
			    	$("#assetemployee").val("");
			    	$("#assigndate").show();
			    }
			  });

  
	});
	
	
	
	/* -------------------search bar for mygrid------------------------ */

	function onQuickFilterChanged() {
		gridOptions.api
				.setQuickFilter(document.getElementById('quickFilter').value);
	}

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";

		if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
			id.style.display = "none";
		}
	}
	var columnDefs = [
		{
			headerCheckboxSelection : false,
			headerCheckboxSelectionFilteredOnly : false,
			checkboxSelection : true,
			width : 10,
			sortable : false,
			filter : false,
			resizable : true,
			pinned : 'left',

		},
		{
			headerName : 'Asset Id',
			field : "assetId",
			pinned : 'left',
				cellRenderer : function(params) {
				return '<a id="assetId" onclick=editAsset("'
				+params.data.assetId
				+ '") href="javascript:void(0)">'
				+ params.data.assetId + '</a>';

			}

		}, {
			headerName : 'Asset Name',
			field : "assetname",
			
		}, {
			headerName : 'Asset Type',
			field : "assettype",
			
		}, {
			headerName : 'Asset Category',
			field : "assetcat",
			
		}, {
			headerName : 'Asset Sub-Category',
			field : "assetsubcat",
			
		}, {
			headerName : 'Purchase No',
			field : "purchaseno",
			
		}, {
			headerName : 'Lifespan',
			field : "lifespan",
			
		}, {
			headerName : 'Working Status',
			field : "workingstatus",
			cellStyle : {
				textAlign : 'center'
			},cellRenderer : function(params) {
				if(params.data.workingstatus==0){
					return '<div style="color:#0642f5">Working</div>';
				}else if(params.data.workingstatus==3){
					return '<div style="color:#D2042D">Scrapped</div>';
				}else{
					return '<div style="color:#a9a9a9">Not Working</div>';
				}
				

			}
		}, {
			headerName : 'Approve Status',
			field : "approvests",
			cellStyle : {
				textAlign : 'center'
			},cellRenderer : function(params) {
				if(params.data.approvests==1){
					return '<div style="color:#0642f5">Approved</div>';
				}else{
					return '<div style="color:#a9a9a9">Pending</div>';
				}
				

			}
		}, {
			headerName : 'Assign Status',
			field : "assignname",
			cellStyle : {
				textAlign : 'center'
			},
			cellRenderer : function(params) {
				if(params.data.assignname==1){
					return '<div style="color:#0642f5">Assigned</div>';
				}else{
					return '<div style="color:#a9a9a9">Not Assigned</div>';
				}
				

			}
		},
		{
			headerName : 'Log Book',
			field : "logbook",
			cellStyle : {
				textAlign : 'center'
			},
				cellRenderer : function(params) {
				return '<a id="id" onclick=viewAssignModal("'
				+ params.data.assetId + '") href="javascript:void(0)">'
				+ '<i class="bi bi-clock-history"> View Log</i>'
				+ '</a>';

			}

		}, {
			headerName : 'QR Code',
			field : "qrcode",
			cellStyle : {
				textAlign : 'center'
			},cellRenderer : function(params) {
				if (params.data.qr_code == "" || params.data.qr_code == null) {
					return '<div style="color:#ff8242">Not Available</div>';
					
				} else {
					return '<a id="id" onclick=viewQr("'
					+ params.data.qr_code + '") href="javascript:void(0)">'
					+ '<i class="bi bi-qr-code-scan"> View QR</i>'
					+ '</a>';
				}
			},
		}];

// let the grid know which columns and what data to use
var gridOptions = {
	columnDefs : columnDefs,
	rowSelection : 'single',
	groupSelectsChildren : true,
	suppressRowClickSelection : true,
	suppressAggFuncInHeader : true,
	defaultColDef : {
		sortable : true,
		filter : true,
		resizable : true,
		width : 150
	},
	onSelectionChanged : onSelectionChanged,
};

//function for row select parents
var id = "";
var apstatus = "";
var assetname = "";
var purchaseno = "";
var pdate = "";
var assettype = "";
var assignname = "";
var wstatus = "";
function onSelectionChanged() {
	var selectedNodes = gridOptions.api.getSelectedNodes();
	 var selectedData = selectedNodes.map(node => node.data);
	 id= selectedData.map(node => node.assetId);
	 apstatus=selectedData.map(node => node.approvests);
	 assetname=selectedData.map(node => node.assetname);
	 purchaseno=selectedData.map(node => node.purchaseno);
	 pdate=selectedData.map(node => node.pdate);
	 assettype=selectedData.map(node => node.assettype);
	 assignname =selectedData.map(node => node.assignname);
	 wstatus =selectedData.map(node => node.workingstatus);
	var selectedRows = gridOptions.api.getSelectedRows();
	var rowCount = 0;
	selectedRows.forEach(function(i) {
		rowCount = rowCount + 1;
	});
	if (rowCount > 0) {
		if(wstatus!=3){
			if(apstatus==1){
				if(assignname==1){
					$('#assignBtn').attr("disabled", true);
					$('#reqScrapBtn').attr("disabled", true);
				}else{
					$('#assignBtn').attr("disabled", false);
					$('#reqScrapBtn').attr("disabled", false);
				}
			$('#newBtn').attr('disabled', true);
			$('#reqDltBtn').attr("disabled", true);
			$('#approveBtn').attr("disabled", true);
			
			
		}else{
			$('#approveBtn').attr("disabled", false);
			$('#reqDltBtn').attr("disabled", false);
			$('#assignBtn').attr("disabled", true);
			$('#reqScrapBtn').attr("disabled", true);
			$('#newBtn').attr('disabled', true);
		}
		}else{
			$('#approveBtn').attr("disabled", true);
			$('#reqDltBtn').attr("disabled", true);
			$('#assignBtn').attr("disabled", true);
			$('#reqScrapBtn').attr("disabled", true);
			$('#newBtn').attr('disabled', true);
		}
	}else {
		$('#reqDltBtn').attr("disabled", true);
		$('#assignBtn').attr("disabled", true);
		$('#reqScrapBtn').attr("disabled", true);
		$('#approveBtn').attr("disabled", true);
		$('#newBtn').attr('disabled', false);
	}
}
// for activity table
var activityDefs = [
		{
			headerCheckboxSelection : true,
			headerCheckboxSelectionFilteredOnly : true,
			checkboxSelection : true,
			sortable : false,
			filter : false,
			resizable : true,
			width : 30,
			pinned : 'left'
		},
		{
			headerName : "Asset Id",
			field : "assetId",
			width : 240,
			hide : true,
		},{
			headerName : "documentFileBase",
			field : "documentFileBase",
			width : 240,
			hide : true,

		}, {
			headerName : "Warranty ID",
			field : "warrantyid",
			width : 240,
			cellStyle : {
				textAlign : 'center'
			},
		}, {
			headerName : "Service Provider",
			field : "serviceprovider",
			width : 240,
			cellStyle : {
				textAlign : 'center'
			},
			},{
				headerName : "Starts From",
				field : "sdate",
				width : 240,
				cellStyle : {
					textAlign : 'center'
				},
		},{
			headerName : "Ends on",
			field : "edate",
			width : 240,
			cellStyle : {
				textAlign : 'center'
			},
	},{
		headerName : "Remark",
		field : "remark",
		width : 240,
		cellStyle : {
			textAlign : 'center'
		},
},{
	headerName : 'Status',
	field : "status",
	cellStyle : {
		textAlign : 'center'
	},cellRenderer : function(params) {
		return checkWarranty(params.data.sdate, params.data.edate);
		
	},
},{
	headerName : 'Attachment',
	field : "fileName",
	cellStyle : {
		textAlign : 'center'
	},cellRenderer : function(params) {
		if(params.data.documentURL!=null){
			var filename= extractFilename(params.data.documentURL);
			var iurl="/document/userQrCode/"+filename;
			return '<a href="' + iurl+'" target="_blank">'
			+ params.data.fileName + '</a>';
		}else{
			return params.data.fileName;
		}
		
		
	},
}];


// let the grid know which columns and what data to use product table
var activityOptions = {
	columnDefs : activityDefs,
	rowSelection : 'multiple',
	groupSelectsChildren : true,
	suppressRowClickSelection : true,
	suppressAggFuncInHeader : true,
	defaultColDef : {
		sortable : true,
		filter : true,
		resizable : true,
		width : 200
	},
	onSelectionChanged : onSelectionChangeChild,

};
//function for row select parents
var childid = "";
function onSelectionChangeChild() {
	 var selectedNodes = activityOptions.api.getSelectedNodes();
	 var selectedData = selectedNodes.map(node => node.data);
	 childid= selectedData.map(node => node.slnoId);
	var selectedRows = activityOptions.api.getSelectedRows();
	var rowCount = 0;
	selectedRows.forEach(function(i) {
		rowCount = rowCount + 1;
	});
	if (rowCount > 0) {
		$('#newchild').attr('disabled', true);
		$('#deleteChild').attr('disabled', false);
		
	}else{
		$('#newchild').attr('disabled', false);
		$('#deleteChild').attr('disabled', true);
	}
}

function checkWarranty(startDateStr, endDateStr) {
    if (startDateStr && endDateStr) {
      var startDate = new Date(startDateStr.split("-").reverse().join("-"));
      var endDate = new Date(endDateStr.split("-").reverse().join("-"));
      var today = new Date();

      if (today >= startDate && today <= endDate) {
        return "Under Warranty";
      } else if (today > endDate) {
        return "Expired";
      } else {
        return "Upcoming";
      }
    }
    return "Invalid Dates";
  }


//for activity table
var InsuranceDefs = [
		{
			headerCheckboxSelection : true,
			headerCheckboxSelectionFilteredOnly : true,
			checkboxSelection : true,
			sortable : false,
			filter : false,
			resizable : true,
			width : 30,
			pinned : 'left'
		},
		{
			headerName : "Asset Id",
			field : "assetId",
			width : 240,
			hide : true,
			pinned : 'left',
			cellRenderer : function(params) {
				return '<a onclick=editRow("' + params.data.parameterId+'") href="javascript:void(0)">'
						+ params.data.parameterId + '</a>';
			}
		}, {
			headerName : "Insurance No",
			field : "insuranceno",
			width : 240,
			cellStyle : {
				textAlign : 'center'
			},
		},{
			headerName : "Insurance Name",
			field : "insurancename",
			width : 240,
			cellStyle : {
				textAlign : 'center'
			},
		},{
				headerName : "Starts From",
				field : "isdate",
				width : 240,
				cellStyle : {
					textAlign : 'center'
				},
		},{
			headerName : "Ends on",
			field : "iedate",
			width : 240,
			cellStyle : {
				textAlign : 'center'
			},
	},{
	headerName : 'Status',
	field : "status",
	cellStyle : {
		textAlign : 'center'
	},cellRenderer : function(params) {
		return checkWarranty(params.data.isdate, params.data.iedate);
		
	},
},{
	headerName : 'Attachment',
	field : "fileName",
	cellStyle : {
		textAlign : 'center'
	},cellRenderer : function(params) {
		if(params.data.documentURL!=null){
			var filename= extractFilename(params.data.documentURL);
			var iurl="/document/userQrCode/"+filename;
			return '<a href="' + iurl+'" target="_blank">'
			+ params.data.fileName + '</a>';
		}else{
			return params.data.fileName;
		}
		
		
	},
}];


// let the grid know which columns and what data to use product table
var InsuranceOptions = {
	columnDefs : InsuranceDefs,
	rowSelection : 'single',
	groupSelectsChildren : true,
	suppressRowClickSelection : true,
	suppressAggFuncInHeader : true,
	defaultColDef : {
		sortable : true,
		filter : true,
		resizable : true,
		width : 200
	},
	onSelectionChanged : onSelectionChangeChild1,
	
};
//function for row select parents
var childid = "";
function onSelectionChangeChild1() {
	 var selectedNodes = InsuranceOptions.api.getSelectedNodes();
	 var selectedData = selectedNodes.map(node => node.data);
	 childid= selectedData.map(node => node.slnoId);
	var selectedRows = activityOptions.api.getSelectedRows();
	var rowCount = 0;
	selectedRows.forEach(function(i) {
		rowCount = rowCount + 1;
	});
	if (rowCount > 0) {
		$('#newInchild').attr('disabled', true);
		$('#deleteInChild').attr('disabled', false);
		
	}else{
		$('#newInchild').attr('disabled', false);
		$('#deleteInChild').attr('disabled', true);
	}
}




//parents new plan
function newPlan() {
	$("#saveAttachmentBtn").show();
	$("#editAttachmentBtn").hide();
	$("#assetimageview").hide();
	$("#docTbl").show();
	var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
		+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
		+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_0"  onblur="checkForDuplicateEntry(event)"></div></td>'
		+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
		+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
		+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" class="dltImage"></div><input type="hidden" id="editId_0></td>'
		+ '</tr>';
$("#doctbodyData").html(tbl);
	$("#assetbox").prop('readonly', false);
	$("#assettype").prop('disabled', false);
	$("#assetcat").prop('disabled', false);
	$("#assetsubcat").prop('disabled', false);
	$("#assetId").prop('readonly', false);
	$("#assetbox").prop('readonly', false);
	$("#assetname").prop('readonly', false);
	$("#lifespan").prop('readonly', false);
	$("#purchaseno").prop('readonly', false);
	$("#pdate").prop('disabled', false);
	$("#DateCalendar3").show();
	$("#save").show();
	
	$("#myGrid").hide();
	$("#reqTable").hide();
	$(".btn-hs").show();
	$("#btndiv").hide();
	$("#listdiv").hide();
	$("#totalReq").hide();
	$("#searchRowDiv").hide();
	$("#ttbtn").hide();
	$("#demo").show();
	closeNav();
	closeInsuranceNav();
	$("#deleteChild").attr('disabled', true);
	$("#deleteInChild").attr('disabled', true);
	$("#newchild").attr('disabled', false);
	$("#newInchild").attr('disabled', false);
	activityOptions.api.setRowData();
	InsuranceOptions.api.setRowData();
}
//function for cancel
function cancel() {
	 $(".formValidation").remove();
		$("#totalReq").show();
		$("#searchRowDiv").show();
		$(".btn-hs").show();
		$("#myGrid").show();
		$("#demo").hide();
		$("#reqDltBtn").attr('disabled', true);
		$("#assignBtn").attr('disabled', true);
		$("#reqScrapBtn").attr('disabled', true);
		$("#newBtn").attr('disabled', false);
		agGrid.simpleHttpRequest({
			url : 'asset-code-view'
		}).then(function(data) {
			var jsonData = JSON.parse(data.body[0]);
			var allData=jsonData.Asset;
			var len = allData.length;
			$('#totalReq').find('span').html(len);
			gridOptions.api.setRowData(allData);
		});
		$("#assetbox").val("");
		$("#assettype").val("");
		$("#assetcat").val("");
		$("#assetsubcat").val("");
		$("#assetId").val("");
		$("#assetbox").val("");
		$("#assetname").val("");
		$("#lifespan").val("");
		$("#purchaseno").val("");
		$("#pdate").val("");
		closeNav();
	}
// function for openNav child	
function openNav() {
	$("#edate").val('');
	$("#sdate").val('');
	$("#remark").val('');
	$("#serviceprovider").val('');
	$("#warrantyid").val('');
	$("#rowEdit").val(null);
	$("#newchild").hide();
	//$("#deleteChild").hide();
	document.getElementById("mySidenav").style.cssText = "width: 25%; position: relative; right:-10px; height:330px; top:0px;";
	document.getElementById("main").style.width = "100%";
	var war=`								<div class="form-group">
		<label>Attach</label>
		<div class="control-group position-r">
						<label class="custom-file-upload" for="uploadWarDoc_0"
							style="margin-top: 18px;"> <i class="ti-plus"></i>
						</label>
						<div class="controls">
							<input type="file" class="wardocument"id="uploadWarDoc_0"
								accept=".jpeg, .jpg, .png, .pdf" name="userImage"
								 onchange="saveFile(event)">
						</div>
					</div>
					<input type="hidden" id="uploadHidden_0"
						class="uploadHidCls" >
					<div id="uploadedWarrDiv_0" align="center"
						class="uploadedWarrCls" style="margin-top: 10px;"></div>
					<div id="imageWarrName_0" class="imageName"
						style="margin-top: 10px;"></div>
	</div>`;
	$("#attachWar").html(war);
}
function openInsuranceNav() {
	$("#insurancename").val('');
	$("#insuranceno").val('');
	$("#iedate").val('');
	$("#isdate").val('');
	$("#rowEdit").val(null);
	$("#newInchild").hide();
	document.getElementById("mySidenav1").style.cssText = "width: 25%; position: relative; right:-10px; overflow: hidden; height:auto; top:0px;";
	document.getElementById("mainInsurance").style.width = "100%";
	var insu=`<div class="form-group">
		<label>Attach</label>
		<div class="control-group position-r">
						<label class="custom-file-upload" for="uploadWarDoc1_0"
							style="margin-top: 18px;"> <i class="ti-plus"></i>
						</label>
						<div class="controls">
							<input type="file" class="wardocument1"id="uploadWarDoc1_0"
								accept=".jpeg, .jpg, .png, .pdf" name="userImage"
								 onchange="saveFile1(event)">
						</div>
					</div>
					<input type="hidden" id="uploadHidden1_0"
						class="uploadHidCls1" >
					<div id="uploadedWarrDiv1_0" align="center"
						class="uploadedWarrCls1" style="margin-top: 10px;"></div>
					<div id="imageWarrName1_0" class="imageName"
						style="margin-top: 10px;"></div>
	</div>`;
	$("#attachIn").html(insu);
	
}
//function for closeNav child
function closeNav() {
	document.getElementById("mySidenav").style.width = "0%";
	document.getElementById("main").style.width = "100%";
	$("#edate").val('');
	$("#sdate").val('');
	$("#remark").val('');
	$("#serviceprovider").val('');
	$("#warrantyid").val('');
	$("#rowEdit").val(null);
	$("#newchild").show();
	$("#deleteChild").show();
}
function closeInsuranceNav() {
	document.getElementById("mySidenav1").style.width = "0%";
	document.getElementById("mainInsurance").style.width = "100%";
	$("#newInchild").show();
}
//master save data
function masterSaveData() {
	$(".formValidation").remove();
	var valid= true;
	var datas = [];
	var rowCount = activityOptions.api.getDisplayedRowCount();
	var rowCount1 = InsuranceOptions.api.getDisplayedRowCount();
	
	var uploadList = [];
	if (valid) {
		$("#doctbodyData > tr").each(
				function(i) {
					var uFile = $(this).find(".document")[0].files[0];
					var fileName = $(this).find(".document").val();
					var data = [];
					var x = [];
					if (fileName != '' && fileName != 'undefined'
							&& fileName != null ) {
						var lastIndex = fileName.lastIndexOf("\\");
						if (lastIndex >= 0) {
							fileName = fileName.substring(lastIndex + 1);
						}
						var reader = new FileReader();
						reader.readAsDataURL(uFile);

						reader.onload = function() {
							data = reader.result.split(",");
							x.push(data[1]);
						};
					}
					uploadData = {};
					uploadData['documnentName'] = $("#docnoid_" + i).val();
					uploadData['documentFile'] = x;
					uploadData['fileName'] = $(this).find('.imageName').text();
					uploadData['documentURL'] = $(this).find(".uploadHidCls").val();
					uploadData['imageNameEdit'] = $(this).find(
							".uploadHidCls").val();
					uploadList.push(uploadData);
				});

	}
	if(rowCount > 0 || rowCount1 > 0){
	activityOptions.api.forEachNode(function(rowNode, index) {
		var item = rowNode.data;
		item.assetId = $("#assetId").val();
		item.assettype = $("#assettype").val();
		item.assetcat = $("#assetcat").val();
		item.assetsubcat = $("#assetsubcat").val();
		item.assetname = $("#assetname").val();
		item.pdate = $("#pdate").val();
		item.purchaseno = $("#purchaseno").val();
		item.lifespan = $("#lifespan").val();
		item.documentList = uploadList;
		if ($('#wstatus').is(":checked"))
		{
			item.wstatus=0;
		}else{
			item.wstatus=1;
		}
		item.category = "warranty";
		if (item.purchaseno == null || item.purchaseno == "") {
			valid = validationUpdated("Purchase Number is Required", "purchaseno");
		 }
		if (item.assettype == null || item.assettype == "") {
			valid = validationUpdated("Asset Type is Required", "assettype");
		 }
		if (item.assetcat == null || item.assetcat == "") {
			valid = validationUpdated("Asset Category is Required", "assetcat");
		 }
		if (item.assetsubcat == null || item.assetsubcat == "") {
			valid = validationUpdated("Asset Sub Category is Required", "assetsubcat");
		 }
		if (item.assetname == null || item.assetname == "") {
			valid = validationUpdated("Asset Name is Required", "assetname");
		 }
		if (item.pdate == null || item.pdate == "") {
			valid = validationUpdated("Purchase Date is Required", "pdate");
		 }
		if (item.lifespan == null || item.lifespan == "") {
			valid = validationUpdated("Lifespan is Required", "lifespan");
		 }
		if (item.assettype == null || item.assettype == "") {
			valid = validationUpdated("Asset Type is Required", "assettype");
		 }
        if(valid){
        	datas.push(item);
         }
	});
	InsuranceOptions.api.forEachNode(function(rowNode, index) {
		var item = rowNode.data;
		item.assetId = $("#assetId").val();
		item.assettype = $("#assettype").val();
		item.assetcat = $("#assetcat").val();
		item.assetsubcat = $("#assetsubcat").val();
		item.assetname = $("#assetname").val();
		item.pdate = $("#pdate").val();
		item.purchaseno = $("#purchaseno").val();
		item.lifespan = $("#lifespan").val();
		item.documentList = uploadList;
		if ($('#wstatus').is(":checked"))
		{
			item.wstatus=0;
		}else{
			item.wstatus=1;
		}
		item.category = "insurance";
		if (item.purchaseno == null || item.purchaseno == "") {
			valid = validationUpdated("Purchase Number is Required", "purchaseno");
		 }
		if (item.assettype == null || item.assettype == "") {
			valid = validationUpdated("Asset Type is Required", "assettype");
		 }
		if (item.assetcat == null || item.assetcat == "") {
			valid = validationUpdated("Asset Category is Required", "assetcat");
		 }
		if (item.assetsubcat == null || item.assetsubcat == "") {
			valid = validationUpdated("Asset Sub Category is Required", "assetsubcat");
		 }
		if (item.assetname == null || item.assetname == "") {
			valid = validationUpdated("Asset Name is Required", "assetname");
		 }
		if (item.pdate == null || item.pdate == "") {
			valid = validationUpdated("Purchase Date is Required", "pdate");
		 }
		if (item.lifespan == null || item.lifespan == "") {
			valid = validationUpdated("Lifespan is Required", "lifespan");
		 }
		if (item.assettype == null || item.assettype == "") {
			valid = validationUpdated("Asset Type is Required", "assettype");
		 }
        if(valid){
        	datas.push(item);
         }
	});
	} else {
		var item = {};
		item.assetId = $("#assetId").val();
		item.assettype = $("#assettype").val();
		item.assetcat = $("#assetcat").val();
		item.assetsubcat = $("#assetsubcat").val();
		item.assetname = $("#assetname").val();
		item.pdate = $("#pdate").val();
		item.purchaseno = $("#purchaseno").val();
		item.lifespan = $("#lifespan").val();
		item.documentList = uploadList;
		if ($('#wstatus').is(":checked"))
		{
			item.wstatus=0;
		}else{
			item.wstatus=1;
		}
		item.category = "";
		if (item.purchaseno == null || item.purchaseno == "") {
			valid = validationUpdated("Purchase Number is Required", "purchaseno");
		 }
		if (item.assettype == null || item.assettype == "") {
			valid = validationUpdated("Asset Type is Required", "assettype");
		 }
		if (item.assetcat == null || item.assetcat == "") {
			valid = validationUpdated("Asset Category is Required", "assetcat");
		 }
		if (item.assetsubcat == null || item.assetsubcat == "") {
			valid = validationUpdated("Asset Sub Category is Required", "assetsubcat");
		 }
		if (item.assetname == null || item.assetname == "") {
			valid = validationUpdated("Asset Name is Required", "assetname");
		 }
		if (item.pdate == null || item.pdate == "") {
			valid = validationUpdated("Purchase Date is Required", "pdate");
		 }
		if (item.lifespan == null || item.lifespan == "") {
			valid = validationUpdated("Lifespan is Required", "lifespan");
		 }
		if (item.assettype == null || item.assettype == "") {
			valid = validationUpdated("Asset Type is Required", "assettype");
		 }
		datas.push(item);
/* 		$("#messageParagraph").text(
		"Please Add Atleast One Plan Details");
		$("#msgOkModal").removeClass("btn3");
		$("#msgOkModal").addClass("btn1");
		$("#msgModal").modal('show'); */
	}
	if (valid) {
	    savePlanDetails(datas);
		}
}

function savePlanDetails(datas) {
	$('.loader').show();
	setTimeout(function() {
	$.ajax({
		type : "POST",
		url : "asset-code-add",
		dataType : "json",
		contentType : "application/json",
		data : JSON.stringify(datas),
		success : function(response) {
			$('.loader').hide();
			var itemName = $("#itemname option:selected").text();
			if (response.code == "success") {
				cancel()
				$("#messageParagraph").text(response.message);
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
				agGrid.simpleHttpRequest({
					url : 'asset-code-view'
				}).then(function(data) {
					var jsonData = JSON.parse(data.body[0]);
					var allData=jsonData.Asset;
					var len = allData.length;
					$('#totalReq').find('span').html(len);
					gridOptions.api.setRowData(allData);
				});
				
			} else {
				$('.loader').hide();
				$("#messageParagraph").text("Test Parameter For "+itemName+" Already Exist.");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
				
				$("#itemid").val('');
				$("#itemname").val('');
				$("#description").val('');
				activityOptions.api.setRowData();
				InsuranceOptions.api.setRowData();
			}
		},
		error : function(data) {
			$('.loader').hide();
		}
	
	})
	}, 1000)

}

// save data in aggrid table sidenav save

function saveTableData() {
  var datas = [];
  var item = {};
  var valid = true;
  var rowEdit = $("#rowEdit").val();
  var found = false;

  activityOptions.api.forEachNode(function(rowNode, index) {
    var iid = rowNode.data.parameterId;
/*     if (rowEdit && iid == $("#assetId").val() && iid != rowEdit) {
      $("#messageParagraph").text("Item Is Already Selected");
      $("#msgOkModal").removeClass("btn3");
      $("#msgOkModal").addClass("btn1");
      $("#msgModal").modal("show");
      found = true;
      return;
    } */
    datas.push(rowNode.data);
  });

  	var uFile = $(".wardocument")[0].files[0];
	var fileName = $(".wardocument").val();
	var data = [];
	var x = [];
	if (fileName != '' && fileName != 'undefined'
			&& fileName != null) {
		var lastIndex = fileName.lastIndexOf("\\");
		if (lastIndex >= 0) {
			item.fileName = fileName.substring(lastIndex + 1);
		}
		var reader = new FileReader();
		reader.readAsDataURL(uFile);

		reader.onload = function() {
			data = reader.result.split(",");
			item.documentFileBase=data[1];
			item.documentURL=$(this).find(".uploadedWarrCls").val();
		};
	}
	
	
  if (!found) {
    item.assetId = $("#assetId").val();
    item.serviceprovider = $("#serviceprovider").val();
    item.warrantyid = $("#warrantyid").val();
    item.sdate = $("#sdate").val();
    item.edate = $("#edate").val();
    item.remark = $("#remark").val();

    if (item.serviceprovider == null || item.serviceprovider == "") {
		valid = validationUpdated("Service Provider is Required", "serviceprovider");
	 }
	if (item.warrantyid == null || item.warrantyid == "") {
		valid = validationUpdated("Warranty ID is Required", "warrantyid");
	 }
	if (item.sdate == null || item.sdate == "") {
		valid = validationUpdated("Start Date is Required", "sdate");
	 }
	if (item.edate == null || item.edate == "") {
		valid = validationUpdated("End Date is Required", "edate");
	 }
	if (item.remark == null || item.remark == "") {
		valid = validationUpdated("Remark is Required", "remark");
	 }
	
    if (valid) {
      if (rowEdit) {
        activityOptions.api.forEachNode(function(rowNode, index) {
          var iid = rowNode.data.parameterId;
          if (iid == rowEdit) {
            rowNode.setData(item);
            return;
          }
        });
        closeNav();
      } else {
        var rowCount = activityOptions.api.getDisplayedRowCount();
        if (rowCount > 0) {
          var foundId = false;
          /* datas.forEach(function(data) {
            if (data.parameterId == item.parameterId) {
              foundId = true;
              $("#messageParagraph").text("Item Is Already Selected");
              $("#msgOkModal").removeClass("btn3");
              $("#msgOkModal").addClass("btn1");
              $("#msgModal").modal("show");
            }
          }); */
          if (!foundId) {
            datas.push(item);
          }
        } else {
          datas = [item];
        }
        activityOptions.api.setRowData(datas);
        closeNav();
      }
    } else {
      $("#mySidenav").show();
    }
  }
}


function saveInsuranceData() {
	  var datas = [];
	  var item = {};
	  var valid = true;
	  var rowEdit = $("#rowEdit").val();
	  var found = false;

	  InsuranceOptions.api.forEachNode(function(rowNode, index) {
	    var iid = rowNode.data.parameterId;
	/*     if (rowEdit && iid == $("#assetId").val() && iid != rowEdit) {
	      $("#messageParagraph").text("Item Is Already Selected");
	      $("#msgOkModal").removeClass("btn3");
	      $("#msgOkModal").addClass("btn1");
	      $("#msgModal").modal("show");
	      found = true;
	      return;
	    } */
	    datas.push(rowNode.data);
	  });
	  
	  var uFile = $(".wardocument1")[0].files[0];
		var fileName = $(".wardocument1").val();
		var data = [];
		var x = [];
		if (fileName != '' && fileName != 'undefined'
				&& fileName != null) {
			var lastIndex = fileName.lastIndexOf("\\");
			if (lastIndex >= 0) {
				item.fileName = fileName.substring(lastIndex + 1);
			}
			var reader = new FileReader();
			reader.readAsDataURL(uFile);

			reader.onload = function() {
				data = reader.result.split(",");
				item.documentFileBase=data[1];
				item.documentURL=$(this).find(".uploadedWarrCls1").val();
			};
		}

	  if (!found) {
	    item.assetId = $("#assetId").val();
	    item.insurancename = $("#insurancename").val();
	    item.insuranceno = $("#insuranceno").val();
	    item.isdate = $("#isdate").val();
	    item.iedate = $("#iedate").val();

	    if (item.insurancename == null || item.insurancename == "") {
			valid = validationUpdated("Insurance Name is Required", "insurancename");
		 }
		if (item.insuranceno == null || item.insuranceno == "") {
			valid = validationUpdated("Insurance No is Required", "insuranceno");
		 }
		if (item.isdate == null || item.isdate == "") {
			valid = validationUpdated("Start Date is Required", "isdate");
		 }
		if (item.iedate == null || item.iedate == "") {
			valid = validationUpdated("End Date is Required", "iedate");
		 }

	    if (valid) {
	      if (rowEdit) {
	        activityOptions.api.forEachNode(function(rowNode, index) {
	          var iid = rowNode.data.parameterId;
	          if (iid == rowEdit) {
	            rowNode.setData(item);
	            return;
	          }
	        });
	        closeNav();
	      } else {
	        var rowCount = activityOptions.api.getDisplayedRowCount();
	        if (rowCount > 0) {
	          var foundId = false;
	          /* datas.forEach(function(data) {
	            if (data.parameterId == item.parameterId) {
	              foundId = true;
	              $("#messageParagraph").text("Item Is Already Selected");
	              $("#msgOkModal").removeClass("btn3");
	              $("#msgOkModal").addClass("btn1");
	              $("#msgModal").modal("show");
	            }
	          }); */
	          if (!foundId) {
	            datas.push(item);
	          }
	        } else {
	          datas = [item];
	        }
	        InsuranceOptions.api.setRowData(datas);
	        closeInsuranceNav();
	      }
	    } else {
	      $("#mySidenav").show();
	    }
	  }
	}
	
	
	// for editing child table of shift 
	function editRow(parameterId,parameterName,minRange,maxRange) {
		var rowNode = activityOptions.api.getRowNode(parameterId);
		openNav();
		$("#rowEdit").val(parameterId);
		$("#parameterId").val(rowNode.data.parameterId);
		$("#parameterName").val(rowNode.data.parameterId);
		$("#minRange").val(rowNode.data.minRange);
		$("#maxRange").val(rowNode.data.maxRange);
	}
	//editing the qc master parent table
	function editAsset(assetId) {
		$("#saveAttachmentBtn").hide();
		$("#editAttachmentBtn").show();
		$("#assetimageview").show();
		$("#docTbl").hide();
		var options="";
		var imagesdiv="";
		var scat="";
		var tbl="";
		$('.loader').show();
		agGrid.simpleHttpRequest(
				{
					url : 'asset-code-edit?id='+ assetId
				}).then(function(data) {
					$('.loader').hide();
					var jsonData = JSON.parse(data.body[0]);
					var allData=jsonData.Asset;
					if(allData[0].workingstatus==0){
						$('#wstatus').prop('checked', true);
					}else{
						$('#wstatus').prop('checked', false);
					}
					var allData3=jsonData.Warranty;
					var allData1=jsonData.AssetInsurance;
					var allData2=jsonData.AssetImages;
					activityOptions.api.setRowData(allData3);
					InsuranceOptions.api.setRowData(allData1);
					$("#myGrid").hide();
					$("#demo").show();
					$("#assetbox").val(allData[0].assetId);
					$("#assettype").val(allData[0].assettype);
					$("#assetcat").val(allData[0].assetcat);
					$("#assetsubcat").val(allData[0].assetsubcat);
		 			$("#assetId").val(assetId);
					$("#assetbox").text(assetId);
					$("#assetname").val(allData[0].assetname);
					$("#lifespan").val(allData[0].lifespan);
					$("#purchaseno").val(allData[0].purchaseno);
					$("#pdate").val(allData[0].pdate);
					scat=allData[0].assetsubcat;
					if(allData2!=null){
						$("#doctbodyData").empty();
					allData2.forEach(function(rowNode,index){
						var filename= extractFilename(rowNode.docurl);
						var iurl="/document/userQrCode/"+filename;
						imagesdiv += `<div class="col-lg-2 col-md-8 mb-4 mb-lg-0">
									  <div class="bg-image hover-overlay ripple shadow-1-strong rounded" data-ripple-color="light">
									  <img src=${iurl} class="w-100"  /> </div></div>`;
									  
									  
						tbl = '<tr>'
							+ '<td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
							+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option>  </select> </div></td>'
							+ '<td><div class="form-group"> <input type="text" value="'+rowNode.docname+'" class="form-control docNoclss" id="docnoid_'+index+'"> </div></td>'
							+ '<td><div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_'+index+'" id="uploadFor_'+index+'"> <i class="ti-pencil" id="clickImg_'+index+'"></i> </label>'
							+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_'
							+ index
							+ '"name="userImage" onchange="saveMultiFile(event)" value="'+rowNode.filename+'" /> </div>'
							+ '</div> <input type="hidden" id="uploadHidden_'+index+'" value="'+rowNode.docurl+'" class="uploadHidCls">'
							+ '<div id="uploadedBillDiv_'+index+'" align="center" class="uploadedBillCls"><div class="uploadicon position-l"><i class="bi bi-file-earmark"></i></div></div>'
							+ '<div id="imageName_'+index+'" class="imageName">'
							+ rowNode.filename
							+ '</div>'
							+ '<input type="hidden" id="editId_'+index+'" value="'+ rowNode.assetid+'">'
							+ '<div id="dltImage_'+index+'" class="custom-file-delete"><i class="ti-close position-l rmv1" onclick="openDeleteConfirm()"></i></div> </td>'
							+ '</tr>';
						$("#doctbodyData").append(tbl);
						
							  });
					
					}else{
						$("#doctbodyData").empty();
					}
					$("#assetimageenter").html(imagesdiv);
					
					agGrid.simpleHttpRequest(
							{
								url : 'asset-maintenance-subcategory?id='+ allData[0].assetcat
							}).then(function(data) {
								var jsonData = JSON.parse(data.body);
								var allData=jsonData.Asset;
								 allData.forEach(function(rowNode){
									options += '<option value="'+rowNode.subcatid+'">'+rowNode.subcatname+'</option>';
									  });
								 $('#assetsubcat').html(options).promise().done(function() {
									  $("#assetsubcat").val(scat);
									});	 
							});
	  
					
					
					
					if(allData[0].approvests==1){
						 $("#assetbox").prop('readonly', true);
							$("#assettype").prop('disabled', true);
							$("#assetcat").prop('disabled', true);
							$("#assetsubcat").prop('disabled', true);
				 			$("#assetId").prop('readonly', true);
							$("#assetbox").prop('readonly', true);
							$("#assetname").prop('readonly', true);
							$("#lifespan").prop('readonly', true);
							$("#purchaseno").prop('readonly', true);
							$("#pdate").prop('disabled', true);
							$("#DateCalendar3").hide();
							$("#save").hide();
							
					}else{
						$("#assetbox").prop('readonly', false);
						$("#assettype").prop('disabled', false);
						$("#assetcat").prop('disabled', false);
						$("#assetsubcat").prop('disabled', false);
			 			$("#assetId").prop('readonly', false);
						$("#assetbox").prop('readonly', false);
						$("#assetname").prop('readonly', false);
						$("#lifespan").prop('readonly', false);
						$("#purchaseno").prop('readonly', false);
						$("#pdate").prop('disabled', false);
						$("#DateCalendar3").show();
						$("#save").show();
					}
					$("#tdiv").hide();
					$("#searchRowDiv").hide();
					$("#totalReq").hide();
					$("#ttbtn").hide(); 
				});
		$('.loader').hide();
	}

	
	function extractFilename(url) {
        // Split the URL by '/'
        var urlParts = url.split('/');
        // Get the last part of the URL, which is the filename
        var filename = urlParts[urlParts.length - 1];
        return filename;
    }
// function for delete qc  
function deleteOnclick() {
		if (id) {
			$('.loader').show();
				$.ajax({
		type : "POST",
		url : "asset-code-delete?id="+ id,
		success : function(response) {
		 if (response.message == "Success") {
			 $('.loader').hide();
			 cancel();
				$("#messageParagraph").text("Plan deleted sucessfully");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
				$('#delete').modal('hide');
				agGrid.simpleHttpRequest({
					url : 'asset-code-view'
				}).then(function(data) {
					var jsonData = JSON.parse(data.body[0]);
					var allData=jsonData.Asset;
					var len = allData.length;
					$('#totalReq').find('span').html(len);
					gridOptions.api.setRowData(allData);
					onSelectionChanged();
				});
				
				} else {
					$('.loader').hide();
				$("#messageParagraph").text("Something went to wrong!");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
			}
		},
		error : function(data) {
			$('.loader').hide();}
	})
		} else {
			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
			$('.loader').hide();}

}


//function for scarp Asset
function scrapOnclick() {
		if (id) {
			$('.loader').show();
				$.ajax({
		type : "POST",
		url : "asset-code-scrap?id="+ id,
		success : function(response) {
		 if (response.message == "Success") {
			 $('.loader').hide();
			    cancelModalBtn();
				$("#messageParagraph").text("Asset Scrapped Sucessfully");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
				$('#scrap').modal('hide');
				agGrid.simpleHttpRequest({
					url : 'asset-code-view'
				}).then(function(data) {
					var jsonData = JSON.parse(data.body[0]);
					var allData=jsonData.Asset;
					var len = allData.length;
					$('#totalReq').find('span').html(len);
					gridOptions.api.setRowData(allData);
					onSelectionChanged();
				});
				
			} else {
				$('.loader').hide();
				$("#messageParagraph").text("Something went to wrong!");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
			}
		},
		error : function(data) {
			$('.loader').hide();}
	})
		} else {
			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
			$('.loader').hide();}

}

//function for approve asset  
function approveOnclick() {
		if (id) {
			$('.loader').show();
				$.ajax({
		type : "GET",
		url : "asset-code-approve?id="+ id+"&assetname="+assetname[0]+"&purchaseno="+purchaseno[0]+"&assettype="+assettype[0]+"&pdate="+pdate[0],
		success : function(response) {
		 if (response.message == "Success") {
			 $('.loader').hide();
				$("#messageParagraph").text("Asset Approved sucessfully");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
				$('#approveModal').modal('hide');
				agGrid.simpleHttpRequest({
					url : 'asset-code-view'
				}).then(function(data) {
					var jsonData = JSON.parse(data.body[0]);
					var allData=jsonData.Asset;
					var len = allData.length;
					$('#totalReq').find('span').html(len);
					gridOptions.api.setRowData(allData);
					onSelectionChanged();
				});
				
			} else {
				$('.loader').hide();
				$("#messageParagraph").text("Something went to wrong!");
				$("#msgOkModal").removeClass("btn3");
				$("#msgOkModal").addClass("btn1");
				$("#msgModal").modal('show');
			}
		},
		error : function(data) {
			$('.loader').hide();}
	})
		} else {
			$('.loader').hide();
			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
		}

}

	// delete selected record from child ag grid
	function deleteDetailsOnclick() {
		$('.modal').hide();
		var selectedRows = activityOptions.api.getSelectedRows();
		activityOptions.api.applyTransaction({
			remove : selectedRows
		});
		cancelModalProductBtn();
	}
	function deleteInsuranceOnclick() {
		$('.modal').hide();
		var selectedRows = InsuranceOptions.api.getSelectedRows();
		InsuranceOptions.api.applyTransaction({
			remove : selectedRows
		});
		cancelModalInProductBtn();
	}
	//for closeing modal box for dlt  product
	function cancelModalProductBtn() {
		$("#deleteModalBtn").removeAttr("disabled");
		$('#deleteDetails').modal('hide');
	}
	//for closeing modal box for dlt  insurance
	function cancelModalInProductBtn() {
		$("#deleteModalBtn").removeAttr("disabled");
		$('#deleteInDetails').modal('hide');
	}

	function deleteFun() {
		$('#delete').modal('show');
	}
	function scrapFun() {
		$('#scrap').modal('show');
	}
	function approveFun() {
		$('#approveModal').modal('show');
	}

	function deleteDetails() {
		$('#deleteDetails').modal('show');
		closeNav();
	}

	function deleteInDetails() {
		$('#deleteInDetails').modal('show');
		closeInsuranceNav();
	}

	function cancelModalBtn() {
		$("#deleteModalBtn").removeAttr("disabled");
		$("#assignsuccessModal").removeAttr("disabled");
	}
//function for download
function downloadDetails() { 
	var dataset = [];
	gridOptions.api.forEachNodeAfterFilterAndSort(function(rowNode, index) {
		dataset.push(rowNode.data);
	});
    gridOptions.api.exportDataAsCsv(dataset);
}


function getParameterId(){
	var parameterId= $("#parameterName").val();
	$("#parameterId").val(parameterId);
}

function getItemid(){
	var parameterId= $("#itemname").val();
	$("#itemid").val(parameterId);
}


var qrId="";
function viewQr(qr) {
	qrId = qr;
	var path = "/document/userQrCode/";
	var showPath = path + qr;

	$("#qr").attr("src", showPath);
	$('#myModal10').modal('show'); 
	
}



function dloadQr(){
	var x = '/document/userQrCode/';
	let url = x + qrId;
	let fileName = qrId; 
	qrDownload(url,fileName);
}

function qrDownload(url, fileName){
var xhr = new XMLHttpRequest();
xhr.open("GET", url, true);
xhr.responseType = "blob";
xhr.onload = function(){
    var urlCreator = window.URL || window.webkitURL;
    var imageUrl = urlCreator.createObjectURL(this.response);
    var tag = document.createElement('a');
    tag.href = imageUrl;
    tag.download = fileName;
    document.body.appendChild(tag);
    tag.click();
    document.body.removeChild(tag);
}
xhr.send();
}

function goTOAssignedAsset() {
		sessionStorage.setItem('activity', 'ACT0251');
		window.location.href = "/asset/asset-assign";
	
}
	
	// function for delete qc  
	function assignOnclick() {
	    var selectedValue = $('input[name="options"]:checked').val();
	    if(selectedValue=="Employee"){
	    	var assetemp=$("#assetemployee").val();
	    }else if(selectedValue=="Location"){
	    	var assetemp=$("#assetlocation").val();
	    }
		var assetcat=$('input[name="options"]:checked').val();
		var assigndate=$("#asdate").val();
			if (assetcat && assigndate) {
				$('.loader').show();
					$.ajax({
			type : "POST",
			url : "asset-code-assign?id="+ id+"&assetcat="+assetcat+"&assetemp="+assetemp+"&assigndate="+assigndate,
			success : function(response) {
			 if (response.message == "Success") {
				 $('.loader').hide();
				 cancel();
				 	$('#assignmodal').modal('hide');
					$("#assignsuccessModal").modal('show');
					$('#delete').modal('hide');
					agGrid.simpleHttpRequest({
						url : 'asset-code-view'
					}).then(function(data) {
						var jsonData = JSON.parse(data.body[0]);
						var allData=jsonData.Asset;
						var len = allData.length;
						$('#totalReq').find('span').html(len);
						gridOptions.api.setRowData(allData);
						onSelectionChanged();
					});
					
				} else {
					$('.loader').hide();
					$("#messageParagraph").text("Something went to wrong!");
					$("#msgOkModal").removeClass("btn3");
					$("#msgOkModal").addClass("btn1");
					$("#msgModal").modal('show');
				}
			},
			error : function(data) {
				$('.loader').hide();}
		})
			} else {
				$("#alert").modal('show');
				document.getElementById("textId").innerHTML = "Please Fill The Required Info !";
				$('.loader').hide();}

	}
	
	function viewAssignModal(id) {
		var div = '';
		 agGrid.simpleHttpRequest(
				{
					url : 'asset-code-history?id='+ id
				}).then(function(data) {
					var jsonData = JSON.parse(data.body[0]);
					var allData=jsonData.Asset;
					if(allData==null){
						$("#tracking").html('<div style="color:#D2042D">No Data Avaialable As Of Now</div>');
					}else{
						 allData.forEach(function(rowNode){
							  div = div + '<div class="tracking-item"><div class="tracking-icon status-intransit"></div>'+
								'<div class="tracking-content"><span>'+rowNode.assignedto+' : '+rowNode.assigneddate+  '  -  '+rowNode.dissociateddate+  ' ( '+rowNode.status+' )</span></div></div>';
						  });
						 $("#tracking").html(div);
					}

					
					
						});
		
		
		

		
		$("#myModal").modal('show');
	}
	function cancelModalBtn() {
		$('#myModal').modal('hide');

	}
	
	function getsubcategory(){
		var catid=$("#assetcat").val();
		var options='<option value="">Select</option>';
		agGrid.simpleHttpRequest(
				{
					url : 'asset-maintenance-subcategory?id='+ catid
				}).then(function(data) {
					var jsonData = JSON.parse(data.body);
					var allData=jsonData.Asset;
					 allData.forEach(function(rowNode){
						options += '<option value="'+rowNode.subcatid+'">'+rowNode.subcatname+'</option>';
						  });
					 $("#assetsubcat").html(options);
				});


	}

	function checkEmpty() {
		var infofileName = true;
		$(".formValidation").remove();
		$('.docNoclss').each(function() {
			if ($(this).val() == null || $(this).val() == "") {
				infofileName = false;
				validationModal("Document Name Required", $(this).attr('id'));
			}
		});

		var mulDocInfo = true;
		if (infofileName) {
			$('#doctbodyData > tr').each(function() {
				if ($(this).closest('tr').find('.imageName').text()) {
					mulDocInfo = true;
				} else {
					mulDocInfo = false;
					$("#messageParagraph").text("Please Choose a File ");
					$("#msgOkModal").removeClass("btn3");
					$("#msgOkModal").addClass("btn1");
					$("#msgModal").modal('show');
					return false;
				}

			});
		}
		if (infofileName && mulDocInfo) {
			addMore1()
		}
	}
	
	//addmore fun for document upload
	function addMore1() {
		var lengthOfTableRow = $("#doctbodyData").children('tr').length;
		var cloneHtml = $("#docTbl tbody tr:first").clone();

		$("#docTbl tbody").append($("#docTbl tbody tr:first").clone());
		$("#myTable tbody tr td:last").html("");
		//var addMore = '<button type="button" class="btn btn-primary tr_clone_add" name="add" onclick="addMore1();"><span class="ti-plus"></span></button>&nbsp;'

		$("#docTbl tbody tr:last").find(".documentclss").val("");
		$("#docTbl tbody tr:last").find(".docNoclss").val("");
		$("#docTbl tbody tr:last").find(".documentclssup").val("");
		$("#docTbl tbody tr:last").find(".uploadedBillCls").empty();
		$("#docTbl tbody tr:last").find(".uploadHidCls").empty();
		$("#docTbl tbody tr:last").find(".uploadHidCls").val('');
		$("#docTbl tbody tr:last").find(".imageName").empty();
		$("#docTbl tbody tr:last").find(".dltImage").empty();

		var j = 0;
		$("#docTbl > #doctbodyData > tr").each(function(i) {

			var selectInput = $(this).find('select');
			var textInput = $(this).find('input');
			var fileInput = $(this).find('file');
			var divInput = $(this).find('div');
			var label = $(this).find('label');
			var iInput = $(this).find('i');

			selectInput.eq(0).attr('id', "docid_" + i);
			textInput.eq(1).attr('id', "docnoid_" + i);
			label.eq(1).attr('for', "uploadDoc_" + i);
			iInput.eq(0).attr('id', "clickImg_" + i);
			textInput.eq(2).attr('id', "uploadDoc_" + i);
			textInput.eq(3).attr('id', "uploadHidden_" + i);
			divInput.eq(4).attr('id', "uploadedBillDiv_" + i);
			divInput.eq(5).attr('id', "imageName_" + i);
			divInput.eq(6).attr('id', "dltImage_" + i);

			j++;
		})
		$("#clickImg_" + (j - 1)).removeClass("ti-pencil");
		$("#clickImg_" + (j - 1)).addClass("ti-plus");

	}

	
	//Document upload section 

	function saveMultiFile(event) {
		var AssignItemQty = event.currentTarget.value;
		var currentFldId = event.currentTarget.getAttribute('id');
		var l = currentFldId.split("_");
		var counter = l[1];
		var currentFldId = "#" + currentFldId;

		var uFile = $(currentFldId)[0].files[0];
		var fileName = event.currentTarget.value;
		var lastIndex = fileName.lastIndexOf("\\");
		if (lastIndex >= 0) {
			fileName = fileName.substring(lastIndex + 1);
		}
		var extension = fileName.split(".").pop();

		var iURL = URL.createObjectURL(uFile);
		$("#uploadedBillDiv_" + counter).html("");

			if (extension == 'pdf' || extension == 'jpg' || extension == 'png'
					|| extension == 'xls' || extension == 'doc') {
				window.st = 1;
			} else {
				$("#messageParagraph").text("Pick A Valid Document File");
				$("#msgModal").modal('show');
				window.st = 0;

				var lengthOfTableRow1 = 0;
				$("#docTbl > #doctbodyData > tr").each(function() {
					lengthOfTableRow1 = lengthOfTableRow1 + 1;
				})
				var id = $("#dltValue").val();
				$("#" + id).closest('tr').remove();
				closeDeleteConfirm();
				if (lengthOfTableRow1 == 1) {
					var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
							+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0"  onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
							+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_0" onblur="checkForDuplicateEntry(event)"></div></td>'
							+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
							+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
							+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" class="dltImage"  ></div> </td>'
							+ '</tr>';
					$("#doctbodyData").append(tbl);
				}
			}

		
		if (extension != null && extension != "") {
			$("#uploadHidden_" + counter).val('');
		}
		if (extension == "jpg" || extension == "png" || extension == "jpeg") {
			var LightImg = "<span class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-picture-o'></i></a></span>";
		} else if (extension == "pdf") {
			var LightImg = "<span class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-pdf-o'></i> </a></span>";
		} else if (extension == "xls" || extension == "xlsx") {
			var LightImg = "<span class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-excel-o'></i></a></span>";
		} else if (extension == "doc" || extension == "dox"
				|| extension == "docx") {
			var LightImg = "<span class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-word-o'></i></a></span>";
		} else if (extension == "mp4" || extension == "MOV"
				|| extension == "MP4") {
			var LightImg = "<span class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-solid fa-video-camera'></i></a></span>";
		} else if (extension == "mp3" || extension == "MP3"
				|| extension == "WAV" || extension == "AAC") {
			var LightImg = "<span class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-solid fa-music'></i></a></span>";
		} else {
			var LightImg = "<span class='uploadicon position-l'> </div>";
		}
		var dltImg = "<i class='ti-close position-l rmv1' onclick='openDeleteConfirm()'></i>";
		$("#uploadedBillDiv_" + counter).html(LightImg);
		$("#imageName_" + counter).html(fileName);
		$("#dltImage_" + counter).html(dltImg);
		$("#dltImage_" + counter).addClass("custom-file-delete");

		$("#clickImg_" + counter).removeClass("ti-plus");
		$("#clickImg_" + counter).addClass("ti-pencil");

	}


	function openDeleteConfirm() {
		$("#dltValue").val("");
		$('#deleteAttachment').modal('show');
	}

	function deleteAttachmentRow() {
		
		var lengthOfTableRow1 = 0;
 		$("#docTbl > #doctbodyData > tr").each(function() {
			lengthOfTableRow1 = lengthOfTableRow1 + 1;
		})
		var id = $("#dltValue").val();
		$("#"+id).closest('tr').remove();
		closeDeleteConfirm();
		if (lengthOfTableRow1 == 1) {
			var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
					+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0"  onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
					+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_0" onblur="checkForDuplicateEntry(event)"></div></td>'
					+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
					+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
					+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" class="dltImage"  ></div> </td>'
					+ '</tr>';
			$("#doctbodyData").append(tbl);
		}
	}

	//for closing modal box for delete 

	function closeDeleteConfirm() {
		$("#dltValue").val("");
		$('#deleteAttachment').modal('hide');
	}
	
	function saveFile() {

		var uFile = $(uploadWarDoc_0)[0].files[0];
		var fileName = event.currentTarget.value;
		var lastIndex = fileName.lastIndexOf("\\");
		if (lastIndex >= 0) {
			fileName = fileName.substring(lastIndex + 1);
		}
		var extension = fileName.split(".");
		var iURL = URL.createObjectURL(uFile);
		$("#uploadedWarrDiv_0").html("");

		if (extension[1] == "jpg" || extension[1] == "png"|| extension[1] == "jpeg"|| extension[1] == "JPG") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-picture-o' style='color: blue'></i></a></div>";
		}else if (extension[1] == "pdf") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-pdf-o' style='color: red'></i></a></div>";
		} else {
			var LightImg = "<div class='uploadicon position-l'> </div>";
		}
		$("#uploadedWarrDiv_0").html(LightImg);
		$("#imageWarrName_0").html(fileName);
		var fileData = new FormData();
		fileData.append('file', uFile);
		fileData.append('path', 'none');
		
	}	

	function saveFile1() {

		var uFile = $(uploadWarDoc1_0)[0].files[0];
		var fileName = event.currentTarget.value;
		var lastIndex = fileName.lastIndexOf("\\");
		if (lastIndex >= 0) {
			fileName = fileName.substring(lastIndex + 1);
		}
		var extension = fileName.split(".");
		var iURL = URL.createObjectURL(uFile);
		$("#uploadedWarrDiv1_0").html("");

		if (extension[1] == "jpg" || extension[1] == "png"|| extension[1] == "jpeg"|| extension[1] == "JPG") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-picture-o' style='color: blue'></i></a></div>";
		}else if (extension[1] == "pdf") {
			var LightImg = "<div class='uploadicon position-l'><a class='example-image-link' href='" + iURL + "' title='" + fileName + "' target='_balnk'><i class='fa fa-file-pdf-o' style='color: red'></i></a></div>";
		} else {
			var LightImg = "<div class='uploadicon position-l'> </div>";
		}
		$("#uploadedWarrDiv1_0").html(LightImg);
		$("#imageWarrName1_0").html(fileName);
		var fileData = new FormData();
		fileData.append('file', uFile);
		fileData.append('path', 'none');
		
	}	


	function editImages(){
		var i=0;
		$("#saveAttachmentBtn").show();
		$("#editAttachmentBtn").hide();
		$("#assetimageview").hide();
		$("#docTbl").show();
/*  		var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
			+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
			+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_0"  onblur="checkForDuplicateEntry(event)"></div></td>'
			+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
			+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
			+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" class="dltImage"></div><input type="hidden" id="editId_0></td>'
			+ '</tr>';
	$("#doctbodyData").html(tbl); */
		$('.docNoclss').each(function() {
			i=i+1;
		});
	if(i==0){
		var tbl = '<tr> <td style="display:none" align="center" class="pdb-24"><input class="checkCls" type="checkbox" id="check2"><label for="check2"></label></td>'
			+ '<td style="display:none"><div class="form-group"> <select class="form-control documentclss" id="docid_0" onblur="removeValid(event);"> <option value="">Select</option> </select> </div></td>'
			+ '<td><div class="form-group"> <input type="text" value="" class="form-control docNoclss" id="docnoid_0"  onblur="checkForDuplicateEntry(event)"></div></td>'
			+ '<td> <div class="control-group position-r"> <label class="custom-file-upload" for="uploadDoc_0" id="uploadFor_0"> <i class="ti-plus" id="clickImg_0"></i> </label>'
			+ '<div class="controls"> <input type="file" class="document" id="uploadDoc_0" name="userImage" onchange="saveMultiFile(event)" /></div> </div> <input type="hidden" id="uploadHidden_0" class="uploadHidCls">'
			+ '<div id="uploadedBillDiv_0" align="center" class="uploadedBillCls"></div> <div id="imageName_0" class="imageName"></div><div id="dltImage_0" class="dltImage"></div><input type="hidden" id="editId_0></td>'
			+ '</tr>';
	$("#doctbodyData").html(tbl);
	}
	}
	
	function allocatePolicy() {
		$("#emplist").hide();
		$("#loclist").hide();
		$("#assigndate").hide();
		$("#assetemployee").val("");
		$("#asdate").val("");
		$('input:radio[name="options"]').prop('checked', false);
	}
</script>

</head>
<body>

	<div layout:fragment="content" class="maincontent">

		<div class="container-fluid">
			<div class="row">
				<div class="maincontentsec">
					<div class="content_padding">

						<div class="d-flex justify-content-between" id="tdiv">
							<div class="btn-hs">
								<div class="font-design" id="totalReq">
									Asset List(<span></span>)
								</div>
							</div>
							<div id="searchRowDiv">
								<div class="input-style">
									<input type="text" placeholder="Search.." name="search"
										class="searchboxinput" onkeyup="cancelBar()"
										oninput="onQuickFilterChanged()" id="quickFilter"
										autocomplete="off">
									<div class="searchicon">
										<a href="javascript:void(0)"><span
											style="display: none; border-right: 1px solid #ccc; padding-right: 5px;"
											id="closeKey"
											onclick="gridOptions.api.setQuickFilter(null);$('#quickFilter').val('');document.getElementById('closeKey').style.display='none';"
											class="close_i"><i class="ti-close srchicon"></i></span></a><a
											href="javascript:void(0)"><i class="ti-search srchicon"></i></a>
									</div>
								</div>
							</div>
							<div class="buttonsec btn-hs" id="ttbtn">
								<button class="download-btn" id="download"
									onclick="downloadDetails()">Download</button>
								<button class="cancel-btn" id="reqScrapBtn" onclick="scrapFun()">SCRAP</button>
								<button class="new-btn" id="approveBtn" onclick="approveFun()">APPROVE</button>
								<button class="delete-btn" id="reqDltBtn" onclick="deleteFun()">DELETE</button>
								<button class="new-btn" id="assignBtn" data-toggle="modal"
									data-target="#assignmodal" onclick="allocatePolicy()">ASSIGN</button>
								<button class="new-btn" id="newBtn" onclick="newPlan()">NEW</button>
							</div>
						</div>

						<input type="hidden" id="sessionId" th:value="${userId}" /> <input
							type="hidden" id="sessionName" th:value="${userName}" /> <input
							type="hidden" id="hrRole" th:value="${hrRole}" /> <input
							type="hidden" id="sessionRole" th:value="${userRole}" /> <input
							type="hidden" id="adRole" th:value="${adRole}" />
						<div id="myGrid" style="width: 100%; height: 500px;"
							class="ag-theme-alpine"></div>

						<div class="collapse" id="demo">
							<div class="innercontent">
								<div class="innerstickybg">
									<div class="row">

										<div class="col-md-6">
											Asset Id: <span id="assetbox"></span>
										</div>

										<div class="col-md-6" align="right">
											<button class="cancel-btn" id="cancelBtn" onclick="cancel()">Cancel</button>
											<button class="approve-btn" id="save"
												onclick="masterSaveData()">Save</button>
										</div>
									</div>

								</div>
								<div class="row innersticky_contentgap">
									<input type="hidden" id="AssetId">

									<div class="col-md-4">
										<div class="form-group">
											<label> Asset Type </label>
											<div class="select">
												<select id="assettype">
													<option value="">Select</option>
													<option value="Fixed">Fixed</option>
													<option value="Current">Current</option>
												</select> <span class="focus"></span>
											</div>
										</div>
									</div>
									<div class="col-md-4">
										<div class="form-group">
											<label> Asset Category </label>
											<div class="select">
												<select id="assetcat" onchange="getsubcategory()">
													<option value="">Select</option>
													<option th:each="c:${catLists}" th:value='${c.key}'
														th:text="${c.name}"></option>
												</select> <span class="focus"></span>
											</div>
										</div>
									</div>
									<div class="col-md-4">
										<div class="form-group">
											<label> Asset Sub Category </label>
											<div class="select">
												<select id="assetsubcat">

													<option th:each="c:${itemnameList}" th:value='${c.key}'
														th:text="${c.name}"></option>
												</select> <span class="focus"></span>
											</div>
										</div>
									</div>
									<div class="col-md-3">
										<div class="form-group">
											<label> Lifespan(Days) </label> <input type="number"
												class="form-control" id="lifespan">
										</div>
									</div>
									<div class="col-md-3">
										<div class="form-group">
											<label> Asset Name </label> <input type="text"
												class="form-control" id="assetname">
										</div>
									</div>
									<div class="col-md-3">
										<div class="form-group">
											<label> Purchase No </label> <input type="text"
												class="form-control" id="purchaseno">
										</div>
									</div>
									<div class="col-lg-3">
										<div class="form-group calendar_box">
											<label>Purchased On</label> <input type="text" id="pdate"
												class="form-control" onblur="removeValid(event)"
												th:attr="onkeyup=|formatDate('date','${session.DATEFORMAT_JS}')|"
												readonly> <i class="ti-calendar picker_calendar"
												id="DateCalendar3"></i>
										</div>
									</div>
									<div class="col-lg-3">
										<div class="form-group calendar_box">
											<label>Working Status</label> <input type="checkbox"
												id="wstatus" checked data-toggle="toggle">
										</div>
									</div>

								</div>
								<!-- 								<div id=documentSection class="mt-3 ">
									<div class="panel panel-default" style="width: 100%;">
										<div class="panel-heading rounded-0" role="tab" id="headingThree">
											<h4 class="panel-title">
												<a class="collapsed mainSecond" role="button"
													data-toggle="collapse" data-parent="#accordion"
													href="#collapseThree" aria-expanded="true"
													aria-controls="collapseThree"> Asset Images </a>
											</h4>
										</div>
										<div id="collapseThree" class="panel-collapse collapse show"
											role="tabpanel" aria-labelledby="headingThree">
											<div class="row">
												<div class="col-md-12 btn-hs1 padding-7" align="right">
													<button class="btn1" id="saveAttachmentBtn"
														onclick="checkEmpty();">New</button>
												</div>
											</div>
											<table id="docTbl" cellspacing="7" cellpadding="7">
												<thead>
													<tr class="tr_clone">
														<th align="center"></th>

														<th width="320">Document Name</th>
														<th width="380">Attachment</th>
													</tr>
												</thead>
												<tbody id="doctbodyData">
												</tbody>
											</table>
										</div>
									</div>
								</div>
								
 -->

								<div id="main3" class="mt-4">
									<div class="accordion-item">
										<h2 class="accordion-header" id="headingOne">
											<button class="accordion-button" type="button"
												data-bs-toggle="collapse" data-bs-target="#collapseOne"
												aria-expanded="false" aria-controls="collapseOne">
												Asset Images</button>
										</h2>

										<div id="collapseOne" class="accordion-collapse collapse show"
											aria-labelledby="headingOne"
											data-bs-parent="#accordionExample">
											<div class="accordion-body">

												<div id="collapseThree" class="panel-collapse collapse show"
													role="tabpanel" aria-labelledby="headingThree">
													<div class="row">
														<div class="col-md-12 btn-hs1 padding-7" align="right">
															<button class="btn1" id="saveAttachmentBtn"
																onclick="checkEmpty();">New</button>
															<button class="btn2" id="editAttachmentBtn"
																onclick="editImages()">Edit</button>
														</div>
													</div>
													<table id="docTbl" cellspacing="7" cellpadding="7">
														<thead id="docthead">
															<tr class="tr_clone">
																<!-- <th align="center"></th> -->

																<th width="320">Document Name</th>
																<th width="380">Attachment</th>
															</tr>
														</thead>
														<tbody id="doctbodyData">
															<!-- Modal gallery -->
														</tbody>
													</table>

													<!-- Modal gallery -->
													<section  id="assetimageview">
														<div class="row" id="assetimageenter">

														</div>
													</section>


												</div>




											</div>
										</div>
									</div>
								</div>






								<div id="main" class="mt-4">
									<div class="accordion-item">
										<h2 class="accordion-header" id="headingOne">
											<button class="accordion-button" type="button"
												data-bs-toggle="collapse" data-bs-target="#collapseOne1"
												aria-expanded="false" aria-controls="collapseOne1">
												Warranty Details</button>
										</h2>

										<div id="collapseOne1" class="accordion-collapse collapse show"
											aria-labelledby="headingOne"
											data-bs-parent="#accordionExample">
											<div class="accordion-body">

												<div id="mySidenav" class="sidenav">
													<div class="slidebox">
														<div class="row">
															<!-- <div class="col-md-10 edit">Warranty Details</div>
															<div class="col-md-2">
																<div class="arrow">
																	<a href="javascript:void(0)" class="closebtn"
																		onclick="closeNav()"><i class="ti-arrow-right"></i></a>
																</div>
															</div> -->
														</div>
														<div style="clear: both;"></div>
														<div class="chartbtnsec">
															<div align="right">
																<button class="cancel-btn" onclick="closeNav()">CANCEL</button>
																<button class="approve-btn" id="save1"
																	onclick="saveTableData()">SAVE</button>
															</div>

														</div>
														<div class="clearfix"></div>
														<div class="row">
															<div class="col-lg-12">
																<div class="form-group">
																	<input type="hidden" class="form-control" id="rowEdit">
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group">
																	<label>Service Provider</label> <input type="text"
																		class="form-control transparenttxtbox"
																		id="serviceprovider" onblur="removeValid(event)">
																</div>
															</div>

															<div class="col-lg-12">
																<div class="form-group">
																	<label>Warranty ID</label> <input type="text"
																		class="form-control transparenttxtbox" id="warrantyid"
																		onblur="removeValid(event)">
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group">
																	<label>Remarks</label> <input type="text"
																		class="form-control transparenttxtbox" id="remark"
																		onblur="removeValid(event)">
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group calendar_box">
																	<label>Starts From</label> <input type="text"
																		id="sdate" class="form-control"
																		onblur="removeValid(event)"
																		th:attr="onkeyup=|formatDate('date','${session.DATEFORMAT_JS}')|"
																		readonly> <i
																		class="ti-calendar picker_calendar" id="DateCalendar1"></i>
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group calendar_box">
																	<label>Ends On</label> <input type="text" id="edate"
																		class="form-control" onblur="removeValid(event)"
																		th:attr="onkeyup=|formatDate('date','${session.DATEFORMAT_JS}')|"
																		readonly> <i
																		class="ti-calendar picker_calendar" id="DateCalendar2"></i>
																</div>
															</div>
															
																						<div class="col-lg-12" id="attachWar">
								<div class="form-group">
									<label>Attach</label>
									<div class="control-group position-r">
													<label class="custom-file-upload" for="uploadWarDoc_0"
														style="margin-top: 18px;"> <i class="ti-plus"></i>
													</label>
													<div class="controls">
														<input type="file" class="wardocument"id="uploadWarDoc_0"
															accept=".jpeg, .jpg, .png, .pdf" name="userImage"
															 onchange="saveFile(event)">
													</div>
												</div>
												<input type="hidden" id="uploadHidden_0"
													class="uploadHidCls" >
												<div id="uploadedWarrDiv_0" align="center"
													class="uploadedWarrCls" style="margin-top: 10px;"></div>
												<div id="imageWarrName_0" class="imageName"
													style="margin-top: 10px;"></div>
								</div>
							</div>

														</div>
													</div>
												</div>


												<div class="row">
													<div class="col-md-12 buttonsec btn-hs">
														<button class="delete-btn" id="deleteChild"
															onclick="deleteDetails()">DELETE</button>
														<button class="new-btn" id="newchild" onclick="openNav()">NEW</button>
													</div>
													<div id="activity" style="width: 100%; height: 300px;"
														class="ag-theme-alpine"></div>
												</div>
											</div>
										</div>
									</div>
								</div>





								<div id="mainInsurance" class="mt-4">
									<div class="accordion-item">
										<h2 class="accordion-header" id="headingOne">
											<button class="accordion-button" type="button"
												data-bs-toggle="collapse" data-bs-target="#collapseOne2"
												aria-expanded="false" aria-controls="collapseOne2">
												Insurance Details</button>
										</h2>

										<div id="collapseOne2" class="accordion-collapse collapse show"
											aria-labelledby="headingOne"
											data-bs-parent="#accordionExample">
											<div class="accordion-body">

												<div id="mySidenav1" class="sidenav">
													<div class="slidebox">
														<div class="row">
															<!-- <div class="col-md-10 edit">Insurance Details</div>
															<div class="col-md-2">
																<div class="arrow">
																	<a href="javascript:void(0)" class="closebtn"
																		onclick="closeInsuranceNav()"><i
																		class="ti-arrow-right"></i></a>
																</div>
															</div> -->
														</div>
														<div style="clear: both;"></div>
														<div class="chartbtnsec">
															<div align="right">
																<button class="cancel-btn" onclick="closeInsuranceNav()">CANCEL</button>
																<button class="approve-btn" id="save2"
																	onclick="saveInsuranceData()">SAVE</button>
															</div>

														</div>
														<div class="clearfix"></div>
														<div class="row">
															<div class="col-lg-12">
																<div class="form-group">
																	<input type="hidden" class="form-control" id="rowEdit">
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group">
																	<label>Insurance No</label> <input type="text"
																		class="form-control transparenttxtbox"
																		id="insuranceno" onblur="removeValid(event)">
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group">
																	<label>Insurance Name</label> <input type="text"
																		class="form-control transparenttxtbox"
																		id="insurancename" onblur="removeValid(event)">
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group calendar_box">
																	<label>Starts From</label> <input type="text"
																		id="isdate" class="form-control"
																		onblur="removeValid(event)"
																		th:attr="onkeyup=|formatDate('date','${session.DATEFORMAT_JS}')|"
																		readonly> <i
																		class="ti-calendar picker_calendar" id="DateCalendar4"></i>
																</div>
															</div>
															<div class="col-lg-12">
																<div class="form-group calendar_box">
																	<label>Ends On</label> <input type="text" id="iedate"
																		class="form-control" onblur="removeValid(event)"
																		th:attr="onkeyup=|formatDate('date','${session.DATEFORMAT_JS}')|"
																		readonly> <i
																		class="ti-calendar picker_calendar" id="DateCalendar5"></i>
																</div>
															</div>
															
															<div class="col-lg-12" id="attachIn">
								<div class="form-group">
									<label>Attach</label>
									<div class="control-group position-r">
													<label class="custom-file-upload" for="uploadWarDoc1_0"
														style="margin-top: 18px;"> <i class="ti-plus"></i>
													</label>
													<div class="controls">
														<input type="file" class="wardocument1"id="uploadWarDoc1_0"
															accept=".jpeg, .jpg, .png, .pdf" name="userImage"
															 onchange="saveFile1(event)">
													</div>
												</div>
												<input type="hidden" id="uploadHidden1_0"
													class="uploadHidCls1" >
												<div id="uploadedWarrDiv1_0" align="center"
													class="uploadedWarrCls1" style="margin-top: 10px;"></div>
												<div id="imageWarrName1_0" class="imageName"
													style="margin-top: 10px;"></div>
								</div>
							</div>

														</div>
													</div>
												</div>


												<div class="row">
													<div class="col-md-12 buttonsec btn-hs">
														<button class="delete-btn" id="deleteInChild"
															onclick="deleteInDetails()">DELETE</button>
														<button class="new-btn" id="newInchild"
															onclick="openInsuranceNav()">NEW</button>
													</div>
													<div id="insuranceactivity"
														style="width: 100%; height: 320px;"
														class="ag-theme-alpine"></div>
												</div>
											</div>
										</div>
									</div>
								</div>



							</div>

						</div>
					</div>
				</div>


				<!-- delete modal start -->
				<div id="delete" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column"></div>
							<div class="modal-body">
								<p>Do you really want to delete these records? This process
									cannot be undone.</p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: 0px;">

								<button type="button" class="cancel-btn" data-bs-dismiss="modal"
									onclick="cancelModalBtn();">Cancel</button>
								<button type="button" class="delete-btn"
									onclick="deleteOnclick()">Delete</button>
							</div>
						</div>
					</div>
				</div>
				
				
				<div id="scrap" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column"></div>
							<div class="modal-body">
								<p>Do you really want to scarp this asset? This process
									cannot be undone.</p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: 0px;">

								<button type="button" class="cancel-btn" data-bs-dismiss="modal"
									onclick="cancelModalBtn();">Cancel</button>
								<button type="button" class="delete-btn"
									onclick="scrapOnclick()">Scrap</button>
							</div>
						</div>
					</div>
				</div>


				<!-- approve modal start -->
				<div id="approveModal" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column"></div>
							<div class="modal-body">
								<p>Do you want to approve this asset? Once done you will not
									be able to make further change.</p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: 0px;">

								<button type="button" class="cancel-btn" data-bs-dismiss="modal"
									onclick="cancelModalBtn();">Cancel</button>
								<button type="button" class="new-btn" onclick="approveOnclick()">Approve</button>
							</div>
						</div>
					</div>
				</div>



				<!-- assign success modal start -->
				<div id="assignsuccessModal" class="modal fade show"
					aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column"></div>
							<div class="modal-body">
								<p>Asset Successfully Assigned</p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: 0px;">

								<button type="button" class="cancel-btn" data-bs-dismiss="modal"
									onclick="cancelModalBtn();">Close</button>
								<button type="button" class="new-btn"
									onclick="goTOAssignedAsset()">View</button>
							</div>
						</div>
					</div>
				</div>

				<!-- delete product modal start -->
				<div id="deleteDetails" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column"></div>
							<div class="modal-body">
								<p>Do you really want to delete these records? This process
									cannot be undone.</p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: -30px;">

								<button type="button" class="cancel-btn" data-bs-dismiss="modal"
									onclick="cancelModalBtn();">Cancel</button>
								<button type="button" class="delete-btn"
									onclick="deleteDetailsOnclick()">Delete</button>
							</div>
						</div>
					</div>
				</div>
				<!-- delete product modal start -->
				<div id="deleteInDetails" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column"></div>
							<div class="modal-body">
								<p>Do you really want to delete these records? This process
									cannot be undone.</p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: -30px;">

								<button type="button" class="cancel-btn" data-bs-dismiss="modal"
									onclick="cancelModalBtn();">Cancel</button>
								<button type="button" class="delete-btn"
									onclick="deleteInsuranceOnclick()">Delete</button>
							</div>
						</div>
					</div>
				</div>
				<!-- alert modal start -->
				<div id="alert" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column">
								<button type="button" class="close" data-bs-dismiss="modal"
									aria-hidden="true" onclick="cancelModalBtn()">
									<i class="ti-close modal-close"></i>
								</button>
							</div>
							<div class="modal-body">
								<p id="textId"></p>
							</div>
							<div class="modal-footer justify-content-center"
								style="margin-top: 0px;">

								<button type="button" class="btn1" data-bs-dismiss="modal">OKAY</button>

							</div>
						</div>
					</div>
				</div>

				<div class="modal fade" id="myModal10">
					<div class="modal-dialog modal-lg" style="max-width: 600px">
						<div class="modal-content" style="width: 100%">
							<!-- Modal Header -->
							<div class="modal-header">
								<h4 class="modal-title" style="font-size: 16px" id="entry">
									<b>Quick Response Code: <span></span></b>
								</h4>
								<div class="col-md-6" align="right" style="margin-left: 48px">
									<button class="btn btn-success" id="dloadBtn"
										onclick="dloadQr()">
										<i class="bi bi-download"></i>
									</button>
								</div>

								<button id="close" type="button" class="btn btn-danger"
									data-bs-dismiss="modal">
									<i class="bi bi-x-lg"></i>
								</button>
							</div>
							<!-- Modal body -->
							<div class="modal-body"
								style="height: 300px; overflow-y: scroll;">
								<div class="vertical-line">
									<div class="row">
										<div style="text-align: center">
											<img id="qr" alt="QR" width="50%" height="250px">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>


				<!-- Modal -->
				<div class="modal fade" id="assignmodal" tabindex="-1" role="dialog"
					aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="exampleModalLongTitle">Asset
									Assign</h5>
								<button type="button" class="close" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
							<div class="modal-body">




								<!-- form radio buttons example -->
								<label>Assigning To</label>
								<form class="form">
									<div class="btn-group btn-toggle">
										<label class="btn btn-light "> <input name="options"
											value="Employee" type="radio"> Employee
										</label> <label class="btn btn-light"> <input name="options"
											value="Location" type="radio"> Location
										</label>
									</div>
								</form>
								<br>

								<div class="col-md-12 d-flex">
									<div class="col-md-8" id="emplist">
										<div class="form-group">
											<label> Employee List </label>
											<div class="select">
												<select id="assetemployee">
													<option value="">Select</option>
													<option th:each="c:${empLists}" th:value='${c.key}'
														th:text="${c.name}"></option>
												</select> <span class="focus"></span>
											</div>
										</div>
									</div>

									<div class="col-md-8" id="loclist">
										<div class="form-group">
											<label> Location List </label>
											<div class="select">
												<select id="assetlocation">
													<option value="">Select</option>
													<option th:each="c:${locLists}" th:value='${c.key}'
														th:text="${c.name}"></option>
												</select> <span class="focus"></span>
											</div>
										</div>
									</div>
									<div class="col-lg-4" id="assigndate">
										<div class="form-group calendar_box">
											<label>Assigning From</label> <input type="text" id="asdate"
												class="form-control" onblur="removeValid(event)"
												th:attr="onkeyup=|formatDate('date','${session.DATEFORMAT_JS}')|"
												readonly> <i class="ti-calendar picker_calendar"
												id="DateCalendarAssign"></i>
										</div>
									</div>
								</div>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn download-btn"
									data-dismiss="modal">Close</button>
								<button type="button" class="new-btn" data-dismiss="modal"
									onclick="assignOnclick();">Assign</button>
							</div>
						</div>
					</div>
				</div>

				<!-- delete attachment modal for Document Upload -->
				<div id="deleteAttachment" class="modal fade show" aria-modal="true">
					<div class="modal-dialog modal-confirm">
						<div class="modal-content">
							<div class="modal-header flex-column">
								<button type="button" class="close" data-dismiss="modal"
									aria-hidden="true" onclick="closeDeleteConfirm()">
									<i class="ti-close modal-close"></i>
								</button>
							</div>
							<div class="modal-body">
								<p>Do you really want to delete these records? This process
									cannot be undone.</p>
								<input type="hidden" id="dltValue">
							</div>
							<div class="modal-footer justify-content-center">

								<button type="button" class="btn4" data-dismiss="modal"
									onclick="closeDeleteConfirm();">Cancel</button>
								<button type="button" class="btn3"
									onclick="deleteAttachmentRow();">Delete</button>
							</div>
						</div>
					</div>
				</div>


				<div class="modal fade" id="myModal">
					<div class="modal-dialog modal-lg" style="margin-top: 130px;">
						<div class="modal-content">

							<!-- Modal Header -->
							<div class="modal-header">
								<h4 class="modal-title md-color">Asset Assign History</h4>
								<button type="button" class="close cp" data-dismiss="modal"
									onclick="cancelModalBtn()">&times;</button>
							</div>

							<!-- Modal body -->
							<div class="modal-body modal-cat">
								<div id="tracking"></div>
							</div>

							<!-- Modal footer -->
							<div class="modal-footer">
								<div class="chartbtnsec">
									<button class="btn4" data-dismiss="modal"
										onclick="cancelModalBtn()">CLOSE</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

</body>
</html>